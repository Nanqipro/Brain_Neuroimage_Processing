2025-05-02 20:25:23,333 - cluster - INFO - 日志文件创建于: D:\GitHub_local\Brain_Neuroimage_Processing\Visualization\logs\processed_EMtrace\cluster_20250502-202523.log
2025-05-02 20:25:23,334 - cluster - INFO - 开始钙爆发聚类分析任务
2025-05-02 20:25:23,334 - cluster - INFO - 输出目录设置为: ../results/processed_EMtrace
2025-05-02 20:25:23,334 - cluster - INFO - 开始加载数据文件: ../results/processed_EMtrace/all_neurons_transients.xlsx
2025-05-02 20:25:23,334 - cluster - INFO - 正在从../results/processed_EMtrace/all_neurons_transients.xlsx加载数据...
2025-05-02 20:25:23,621 - cluster - INFO - 成功加载数据，共269行
2025-05-02 20:25:23,621 - cluster - INFO - 使用权重设置进行聚类分析
2025-05-02 20:25:23,622 - cluster - INFO - 使用的特征权重: {'amplitude': 1.5, 'duration': 1.5, 'rise_time': 0.6, 'decay_time': 0.6, 'snr': 1.0, 'fwhm': 1.0, 'auc': 1.0}
2025-05-02 20:25:23,628 - cluster - INFO - OUTPUT: 应用特征权重: amplitude:1.50, duration:1.50, fwhm:1.00, rise_time:0.60, decay_time:0.60, auc:1.00, snr:1.00, is_complex:1.00, subpeaks_count:1.00
2025-05-02 20:25:23,628 - cluster - INFO - OUTPUT: 预处理完成，保留269个有效样本，使用特征: amplitude, duration, fwhm, rise_time, decay_time, auc, snr, is_complex, subpeaks_count
2025-05-02 20:25:23,628 - cluster - INFO - 提取的特征名称: ['amplitude', 'duration', 'fwhm', 'rise_time', 'decay_time', 'auc', 'snr', 'is_complex', 'subpeaks_count']
2025-05-02 20:25:23,628 - cluster - INFO - 使用指定的聚类数: K=4
2025-05-02 20:25:23,628 - cluster - INFO - OUTPUT: 使用K均值聚类算法，聚类数=4...
2025-05-02 20:25:23,821 - cluster - INFO - OUTPUT: 使用PCA降维可视化...
2025-05-02 20:25:24,334 - cluster - INFO - OUTPUT: 使用t-SNE降维可视化...
2025-05-02 20:25:25,043 - cluster - INFO - OUTPUT: 可视化各个簇的特征分布...
2025-05-02 20:25:26,530 - cluster - INFO - OUTPUT: 分析各个簇的特征统计信息...
2025-05-02 20:25:26,538 - cluster - INFO - OUTPUT: 聚类统计信息已保存到 '../results/processed_EMtrace/cluster_statistics.csv'
2025-05-02 20:25:26,539 - cluster - INFO - OUTPUT: 使用雷达图可视化各簇的特征...
2025-05-02 20:25:26,992 - cluster - INFO - OUTPUT: 可视化不同神经元的聚类分布...
2025-05-02 20:25:27,540 - cluster - INFO - OUTPUT: 神经元聚类分布图已保存到: ../results/processed_EMtrace/neuron_cluster_distribution.png
2025-05-02 20:25:27,540 - cluster - INFO - OUTPUT: 可视化不同波形类型在各聚类中的分布...
2025-05-02 20:25:27,964 - cluster - INFO - OUTPUT: 波形类型分布图已保存到: ../results/processed_EMtrace/wave_type_distribution.png
2025-05-02 20:25:27,965 - cluster - INFO - OUTPUT: 分析各聚类中的子峰特征...
2025-05-02 20:25:28,284 - cluster - INFO - OUTPUT: 子峰统计信息已保存到 ../results/processed_EMtrace/subpeaks_statistics.csv
2025-05-02 20:25:28,284 - cluster - INFO - 开始生成神经元钙波活动时间线图...
2025-05-02 20:25:29,139 - cluster - INFO - 神经元钙波活动时间线图已保存到 ../results/processed_EMtrace/neuron_timeline.png
2025-05-02 20:25:29,139 - cluster - INFO - 开始可视化各聚类的平均钙爆发波形...
2025-05-02 20:25:29,139 - cluster - INFO - OUTPUT: 正在可视化不同聚类类别的平均钙爆发波形...
2025-05-02 20:25:29,140 - cluster - INFO - OUTPUT: 检测到源文件路径信息，将优先使用这些信息加载原始数据
2025-05-02 20:25:29,140 - cluster - INFO - OUTPUT: 从事件数据中检测到 1 个不同的源文件
2025-05-02 20:25:29,140 - cluster - INFO - OUTPUT: 使用项目根目录: D:\GitHub_local\Brain_Neuroimage_Processing\Visualization
2025-05-02 20:25:29,141 - cluster - INFO - OUTPUT:   源文件不存在: D:\GitHub_local\Brain_Neuroimage_Processing\Visualization\..\datasets\processed_EMtrace.xlsx
2025-05-02 20:25:29,142 - cluster - INFO - OUTPUT: 尝试加载默认原始数据从: ../datasets/processed_EMtrace.xlsx
2025-05-02 20:25:30,012 - cluster - INFO - OUTPUT: 成功加载原始数据，形状: (2999, 45)
2025-05-02 20:25:30,012 - cluster - INFO - OUTPUT: 原始数据中的神经元列：
2025-05-02 20:25:30,013 - cluster - INFO - OUTPUT:   数据集 processed_EMtrace: 43 个神经元列 - ['n1', 'n2', 'n3', 'n4', 'n5']...
2025-05-02 20:25:30,013 - cluster - INFO - OUTPUT: 钙爆发数据中的神经元: 42 个 - ['n1' 'n2' 'n3' 'n4' 'n5']...
2025-05-02 20:25:30,014 - cluster - INFO - OUTPUT: 创建了 42 个神经元名称映射
2025-05-02 20:25:30,070 - cluster - INFO - OUTPUT: 聚类 1: 使用从起始点开始的固定长度400处理波形...
2025-05-02 20:25:30,071 - cluster - INFO - OUTPUT: 聚类 1: 使用源文件信息匹配原始数据
2025-05-02 20:25:30,091 - cluster - INFO - OUTPUT: 聚类 2: 使用从起始点开始的固定长度400处理波形...
2025-05-02 20:25:30,091 - cluster - INFO - OUTPUT: 聚类 2: 使用源文件信息匹配原始数据
2025-05-02 20:25:30,093 - cluster - INFO - OUTPUT: 聚类 3: 使用从起始点开始的固定长度400处理波形...
2025-05-02 20:25:30,094 - cluster - INFO - OUTPUT: 聚类 3: 使用源文件信息匹配原始数据
2025-05-02 20:25:30,104 - cluster - INFO - OUTPUT: 聚类 4: 使用从起始点开始的固定长度400处理波形...
2025-05-02 20:25:30,104 - cluster - INFO - OUTPUT: 聚类 4: 使用源文件信息匹配原始数据
2025-05-02 20:25:30,906 - cluster - INFO - 平均钙爆发波形可视化已保存到 ../results/processed_EMtrace/cluster_average_waveforms.png
2025-05-02 20:25:30,906 - cluster - INFO - 波形数据已保存到 ../results/processed_EMtrace/cluster_average_waveforms.csv
2025-05-02 20:25:30,907 - cluster - INFO - OUTPUT: 将聚类标签添加到原始数据...
2025-05-02 20:25:31,091 - cluster - INFO - OUTPUT: 聚类结果已保存到 ../results/processed_EMtrace/all_neurons_transients_clustered_k4.xlsx
2025-05-02 20:25:31,092 - cluster - INFO - 聚类分析完成!
