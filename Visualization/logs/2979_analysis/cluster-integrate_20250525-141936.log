2025-05-25 14:19:36,157 - cluster-integrate - INFO - 日志文件创建于: D:\GitHub_local\Brain_Neuroimage_Processing\Visualization\logs\2979_analysis\cluster-integrate_20250525-141936.log
2025-05-25 14:19:36,157 - cluster-integrate - INFO - 开始钙爆发聚类分析，输出目录: ../results/processed_2979_all_datasets_analysis
2025-05-25 14:19:36,157 - cluster-integrate - INFO - 使用输入文件: ../results/processed_2979_all_datasets_analysis/all_datasets_transients.xlsx
2025-05-25 14:19:36,158 - cluster-integrate - INFO - OUTPUT: 正在从../results/processed_2979_all_datasets_analysis/all_datasets_transients.xlsx加载数据...
2025-05-25 14:19:38,886 - cluster-integrate - INFO - OUTPUT: 成功加载数据，共11716行
2025-05-25 14:19:38,887 - cluster-integrate - INFO - OUTPUT: 输出目录设置为: ../results/processed_2979_all_datasets_analysis
2025-05-25 14:19:38,887 - cluster-integrate - INFO - OUTPUT: 使用权重设置进行聚类分析
2025-05-25 14:19:38,899 - cluster-integrate - INFO - OUTPUT: 应用特征权重: amplitude:2.00, duration:2.00, fwhm:0.50, rise_time:1.50, decay_time:1.50, auc:0.50, snr:0.50, is_complex:1.00, subpeaks_count:1.00
2025-05-25 14:19:38,900 - cluster-integrate - INFO - OUTPUT: 预处理完成，保留11716个有效样本，使用特征: amplitude, duration, fwhm, rise_time, decay_time, auc, snr, is_complex, subpeaks_count
2025-05-25 14:19:38,900 - cluster-integrate - INFO - OUTPUT: 使用指定的聚类数: K=4
2025-05-25 14:19:38,900 - cluster-integrate - INFO - OUTPUT: 使用K均值聚类算法，聚类数=4...
2025-05-25 14:19:39,128 - cluster-integrate - INFO - OUTPUT: 正在生成学术风格的钙爆发特征可视化...
2025-05-25 14:19:39,319 - cluster-integrate - INFO - OUTPUT: 计算Gap Statistic...
2025-05-25 14:20:07,248 - cluster-integrate - ERROR - OUTPUT: D:\GitHub_local\Brain_Neuroimage_Processing\Visualization\src\cluster-integrate.py:1880: UserWarning: color is redundantly defined by the 'color' keyword argument and the fmt string "ro" (-> color='r'). The keyword argument will take precedence.
2025-05-25 14:20:07,248 - cluster-integrate - ERROR - OUTPUT:   axes[0, 0].plot(max_gap_idx + 1, gap_values[max_gap_idx], 'ro', markersize=8, color=academic_red)
2025-05-25 14:20:07,249 - cluster-integrate - INFO - OUTPUT: Gap Statistic建议的最佳聚类数: K = 10
2025-05-25 14:20:07,363 - cluster-integrate - INFO - OUTPUT: 计算了 11656 个钙爆发间隔，其中 11656 个在显示范围内
2025-05-25 14:20:07,416 - cluster-integrate - INFO - OUTPUT: 计算了 60 个神经元的钙爆发频率
2025-05-25 14:20:08,279 - cluster-integrate - INFO - OUTPUT: 学术风格钙爆发特征图已保存到: ../results/processed_2979_all_datasets_analysis/burst_attributes_academic_style.png
2025-05-25 14:20:08,280 - cluster-integrate - INFO - OUTPUT: 使用PCA降维可视化...
2025-05-25 14:20:08,724 - cluster-integrate - INFO - OUTPUT: 使用t-SNE降维可视化...
2025-05-25 14:20:30,059 - cluster-integrate - INFO - OUTPUT: 可视化各个簇的特征分布...
2025-05-25 14:20:31,714 - cluster-integrate - INFO - OUTPUT: 学术风格特征分布图已保存到: ../results/processed_2979_all_datasets_analysis/cluster_feature_distribution_academic.png
2025-05-25 14:20:31,714 - cluster-integrate - INFO - OUTPUT: 分析各个簇的特征统计信息...
2025-05-25 14:20:31,721 - cluster-integrate - INFO - OUTPUT: 聚类统计信息已保存到 '../results/processed_2979_all_datasets_analysis/cluster_statistics.csv'
2025-05-25 14:20:31,722 - cluster-integrate - INFO - OUTPUT: 使用雷达图可视化各簇的特征...
2025-05-25 14:20:32,148 - cluster-integrate - INFO - OUTPUT: 可视化不同神经元的聚类分布...
2025-05-25 14:20:32,763 - cluster-integrate - INFO - OUTPUT: 神经元聚类分布图已保存到: ../results/processed_2979_all_datasets_analysis/neuron_cluster_distribution.png
2025-05-25 14:20:32,764 - cluster-integrate - INFO - OUTPUT: 可视化不同波形类型在各聚类中的分布...
2025-05-25 14:20:33,155 - cluster-integrate - INFO - OUTPUT: 波形类型分布图已保存到: ../results/processed_2979_all_datasets_analysis/wave_type_distribution.png
2025-05-25 14:20:33,156 - cluster-integrate - INFO - OUTPUT: 分析各聚类中的子峰特征...
2025-05-25 14:20:33,431 - cluster-integrate - INFO - OUTPUT: 子峰统计信息已保存到 ../results/processed_2979_all_datasets_analysis/subpeaks_statistics.csv
2025-05-25 14:20:33,432 - cluster-integrate - INFO - OUTPUT: 正在可视化不同聚类类别的平均钙爆发波形...
2025-05-25 14:20:33,433 - cluster-integrate - INFO - OUTPUT: 检测到源文件路径信息，将优先使用这些信息加载原始数据
2025-05-25 14:20:33,435 - cluster-integrate - INFO - OUTPUT: 从事件数据中检测到 25 个不同的源文件
2025-05-25 14:20:33,435 - cluster-integrate - INFO - OUTPUT: 使用项目根目录: D:\GitHub_local\Brain_Neuroimage_Processing
2025-05-25 14:20:33,435 - cluster-integrate - INFO - OUTPUT: 加载源文件: D:\GitHub_local\Brain_Neuroimage_Processing\Visualization\datasets\2979数据\csdsday3\processed_DAY3EMtrace.xlsx
2025-05-25 14:20:34,055 - cluster-integrate - INFO - OUTPUT:   成功加载数据集: processed_DAY3EMtrace, 形状: (2999, 37)
2025-05-25 14:20:34,056 - cluster-integrate - INFO - OUTPUT: 加载源文件: D:\GitHub_local\Brain_Neuroimage_Processing\Visualization\datasets\2979数据\csdsday3\processed_DAY3Openfieldtrace.xlsx
2025-05-25 14:20:34,165 - cluster-integrate - INFO - OUTPUT:   成功加载数据集: processed_DAY3Openfieldtrace, 形状: (388, 49)
2025-05-25 14:20:34,165 - cluster-integrate - INFO - OUTPUT: 加载源文件: D:\GitHub_local\Brain_Neuroimage_Processing\Visualization\datasets\2979数据\csdsday6\processed_Day6EMtrace.xlsx
2025-05-25 14:20:34,824 - cluster-integrate - INFO - OUTPUT:   成功加载数据集: processed_Day6EMtrace, 形状: (2999, 35)
2025-05-25 14:20:34,825 - cluster-integrate - INFO - OUTPUT: 加载源文件: D:\GitHub_local\Brain_Neuroimage_Processing\Visualization\datasets\2979数据\csdsday6\processed_Day6openfieldtrace.xlsx
2025-05-25 14:20:35,754 - cluster-integrate - INFO - OUTPUT:   成功加载数据集: processed_Day6openfieldtrace, 形状: (2999, 50)
2025-05-25 14:20:35,754 - cluster-integrate - INFO - OUTPUT: 加载源文件: D:\GitHub_local\Brain_Neuroimage_Processing\Visualization\datasets\2979数据\csdsday8\processed_Day8EMtrace.xlsx
2025-05-25 14:20:36,579 - cluster-integrate - INFO - OUTPUT:   成功加载数据集: processed_Day8EMtrace, 形状: (2999, 48)
2025-05-25 14:20:36,580 - cluster-integrate - INFO - OUTPUT: 加载源文件: D:\GitHub_local\Brain_Neuroimage_Processing\Visualization\datasets\2979数据\csdsday8\processed_Day8homecagetrace.xlsx
2025-05-25 14:20:37,649 - cluster-integrate - INFO - OUTPUT:   成功加载数据集: processed_Day8homecagetrace, 形状: (4265, 42)
2025-05-25 14:20:37,649 - cluster-integrate - INFO - OUTPUT: 加载源文件: D:\GitHub_local\Brain_Neuroimage_Processing\Visualization\datasets\2979数据\csdsday9\processed_Day9homecagetrace01.xlsx
2025-05-25 14:20:37,681 - cluster-integrate - INFO - OUTPUT:   成功加载数据集: processed_Day9homecagetrace01, 形状: (169, 26)
2025-05-25 14:20:37,681 - cluster-integrate - INFO - OUTPUT: 加载源文件: D:\GitHub_local\Brain_Neuroimage_Processing\Visualization\datasets\2979数据\csdsday9\processed_Day9homecagetrace02.xlsx
2025-05-25 14:20:38,438 - cluster-integrate - INFO - OUTPUT:   成功加载数据集: processed_Day9homecagetrace02, 形状: (3531, 35)
2025-05-25 14:20:38,439 - cluster-integrate - INFO - OUTPUT: 加载源文件: D:\GitHub_local\Brain_Neuroimage_Processing\Visualization\datasets\2979数据\csdsday9\processed_Day9xuanweitrace.xlsx
2025-05-25 14:20:38,958 - cluster-integrate - INFO - OUTPUT:   成功加载数据集: processed_Day9xuanweitrace, 形状: (2005, 46)
2025-05-25 14:20:38,958 - cluster-integrate - INFO - OUTPUT: 加载源文件: D:\GitHub_local\Brain_Neuroimage_Processing\Visualization\datasets\2979数据\csdsday9\processed_Day9ymazetrace.xlsx
2025-05-25 14:20:39,753 - cluster-integrate - INFO - OUTPUT:   成功加载数据集: processed_Day9ymazetrace, 形状: (2999, 44)
2025-05-25 14:20:39,754 - cluster-integrate - INFO - OUTPUT: 加载源文件: D:\GitHub_local\Brain_Neuroimage_Processing\Visualization\datasets\2979数据\processed_csdsday3trace.xlsx
2025-05-25 14:20:39,917 - cluster-integrate - INFO - OUTPUT:   成功加载数据集: processed_csdsday3trace, 形状: (1026, 28)
2025-05-25 14:20:39,917 - cluster-integrate - INFO - OUTPUT: 加载源文件: D:\GitHub_local\Brain_Neuroimage_Processing\Visualization\datasets\2979数据\processed_EMtrace01.xlsx
2025-05-25 14:20:40,726 - cluster-integrate - INFO - OUTPUT:   成功加载数据集: processed_EMtrace01, 形状: (2999, 44)
2025-05-25 14:20:40,726 - cluster-integrate - INFO - OUTPUT: 加载源文件: D:\GitHub_local\Brain_Neuroimage_Processing\Visualization\datasets\2979数据\processed_EMtrace02.xlsx
2025-05-25 14:20:40,992 - cluster-integrate - INFO - OUTPUT:   成功加载数据集: processed_EMtrace02, 形状: (1184, 39)
2025-05-25 14:20:40,993 - cluster-integrate - INFO - OUTPUT: 加载源文件: D:\GitHub_local\Brain_Neuroimage_Processing\Visualization\datasets\2979数据\processed_homecagefamilarmicetrace.xlsx
2025-05-25 14:20:41,447 - cluster-integrate - INFO - OUTPUT:   成功加载数据集: processed_homecagefamilarmicetrace, 形状: (1999, 41)
2025-05-25 14:20:41,448 - cluster-integrate - INFO - OUTPUT: 加载源文件: D:\GitHub_local\Brain_Neuroimage_Processing\Visualization\datasets\2979数据\processed_homecagetrace.xlsx
2025-05-25 14:20:42,308 - cluster-integrate - INFO - OUTPUT:   成功加载数据集: processed_homecagetrace, 形状: (4266, 34)
2025-05-25 14:20:42,308 - cluster-integrate - INFO - OUTPUT: 加载源文件: D:\GitHub_local\Brain_Neuroimage_Processing\Visualization\datasets\2979数据\processed_NORhabititutetrace.xlsx
2025-05-25 14:20:42,928 - cluster-integrate - INFO - OUTPUT:   成功加载数据集: processed_NORhabititutetrace, 形状: (1828, 61)
2025-05-25 14:20:42,929 - cluster-integrate - INFO - OUTPUT: 加载源文件: D:\GitHub_local\Brain_Neuroimage_Processing\Visualization\datasets\2979数据\processed_NORtesttrace.xlsx
2025-05-25 14:20:43,429 - cluster-integrate - INFO - OUTPUT:   成功加载数据集: processed_NORtesttrace, 形状: (1599, 53)
2025-05-25 14:20:43,430 - cluster-integrate - INFO - OUTPUT: 加载源文件: D:\GitHub_local\Brain_Neuroimage_Processing\Visualization\datasets\2979数据\processed_openfieldtrace.xlsx
2025-05-25 14:20:44,077 - cluster-integrate - INFO - OUTPUT:   成功加载数据集: processed_openfieldtrace, 形状: (2999, 39)
2025-05-25 14:20:44,078 - cluster-integrate - INFO - OUTPUT: 加载源文件: D:\GitHub_local\Brain_Neuroimage_Processing\Visualization\datasets\2979数据\processed_socialtrace01.xlsx
2025-05-25 14:20:44,738 - cluster-integrate - INFO - OUTPUT:   成功加载数据集: processed_socialtrace01, 形状: (2999, 37)
2025-05-25 14:20:44,739 - cluster-integrate - INFO - OUTPUT: 加载源文件: D:\GitHub_local\Brain_Neuroimage_Processing\Visualization\datasets\2979数据\processed_socialtrace02.xlsx
2025-05-25 14:20:45,340 - cluster-integrate - INFO - OUTPUT:   成功加载数据集: processed_socialtrace02, 形状: (2999, 36)
2025-05-25 14:20:45,341 - cluster-integrate - INFO - OUTPUT: 加载源文件: D:\GitHub_local\Brain_Neuroimage_Processing\Visualization\datasets\2979数据\processed_tangsuitiewangtrace.xlsx
2025-05-25 14:20:46,262 - cluster-integrate - INFO - OUTPUT:   成功加载数据集: processed_tangsuitiewangtrace, 形状: (2999, 52)
2025-05-25 14:20:46,262 - cluster-integrate - INFO - OUTPUT: 加载源文件: D:\GitHub_local\Brain_Neuroimage_Processing\Visualization\datasets\2979数据\processed_tangsuitrace.xlsx
2025-05-25 14:20:47,123 - cluster-integrate - INFO - OUTPUT:   成功加载数据集: processed_tangsuitrace, 形状: (2650, 54)
2025-05-25 14:20:47,123 - cluster-integrate - INFO - OUTPUT: 加载源文件: D:\GitHub_local\Brain_Neuroimage_Processing\Visualization\datasets\2979数据\processed_tstrace.xlsx
2025-05-25 14:20:47,995 - cluster-integrate - INFO - OUTPUT:   成功加载数据集: processed_tstrace, 形状: (2999, 52)
2025-05-25 14:20:47,995 - cluster-integrate - INFO - OUTPUT: 加载源文件: D:\GitHub_local\Brain_Neuroimage_Processing\Visualization\datasets\2979数据\processed_xuanweitrace.xlsx
2025-05-25 14:20:48,449 - cluster-integrate - INFO - OUTPUT:   成功加载数据集: processed_xuanweitrace, 形状: (1599, 45)
2025-05-25 14:20:48,449 - cluster-integrate - INFO - OUTPUT: 加载源文件: D:\GitHub_local\Brain_Neuroimage_Processing\Visualization\datasets\2979数据\processed_ymazetrace.xlsx
2025-05-25 14:20:49,143 - cluster-integrate - INFO - OUTPUT:   成功加载数据集: processed_ymazetrace, 形状: (2999, 41)
2025-05-25 14:20:49,143 - cluster-integrate - INFO - OUTPUT: 原始数据中的神经元列：
2025-05-25 14:20:49,143 - cluster-integrate - INFO - OUTPUT:   数据集 processed_DAY3EMtrace: 36 个神经元列 - ['n1', 'n2', 'n3', 'n4', 'n5']...
2025-05-25 14:20:49,144 - cluster-integrate - INFO - OUTPUT:   数据集 processed_DAY3Openfieldtrace: 48 个神经元列 - ['n1', 'n2', 'n3', 'n4', 'n5']...
2025-05-25 14:20:49,144 - cluster-integrate - INFO - OUTPUT:   数据集 processed_Day6EMtrace: 34 个神经元列 - ['n1', 'n2', 'n3', 'n4', 'n5']...
2025-05-25 14:20:49,144 - cluster-integrate - INFO - OUTPUT:   数据集 processed_Day6openfieldtrace: 49 个神经元列 - ['n1', 'n2', 'n3', 'n4', 'n5']...
2025-05-25 14:20:49,144 - cluster-integrate - INFO - OUTPUT:   数据集 processed_Day8EMtrace: 47 个神经元列 - ['n1', 'n2', 'n3', 'n4', 'n5']...
2025-05-25 14:20:49,145 - cluster-integrate - INFO - OUTPUT:   数据集 processed_Day8homecagetrace: 41 个神经元列 - ['n1', 'n2', 'n3', 'n4', 'n5']...
2025-05-25 14:20:49,145 - cluster-integrate - INFO - OUTPUT:   数据集 processed_Day9homecagetrace01: 25 个神经元列 - ['n1', 'n2', 'n3', 'n4', 'n5']...
2025-05-25 14:20:49,145 - cluster-integrate - INFO - OUTPUT:   数据集 processed_Day9homecagetrace02: 34 个神经元列 - ['n1', 'n2', 'n3', 'n4', 'n5']...
2025-05-25 14:20:49,145 - cluster-integrate - INFO - OUTPUT:   数据集 processed_Day9xuanweitrace: 45 个神经元列 - ['n1', 'n2', 'n3', 'n4', 'n5']...
2025-05-25 14:20:49,146 - cluster-integrate - INFO - OUTPUT:   数据集 processed_Day9ymazetrace: 43 个神经元列 - ['n1', 'n2', 'n3', 'n4', 'n5']...
2025-05-25 14:20:49,146 - cluster-integrate - INFO - OUTPUT:   数据集 processed_csdsday3trace: 27 个神经元列 - ['n1', 'n2', 'n3', 'n4', 'n5']...
2025-05-25 14:20:49,146 - cluster-integrate - INFO - OUTPUT:   数据集 processed_EMtrace01: 43 个神经元列 - ['n1', 'n2', 'n3', 'n4', 'n5']...
2025-05-25 14:20:49,147 - cluster-integrate - INFO - OUTPUT:   数据集 processed_EMtrace02: 38 个神经元列 - ['n1', 'n2', 'n3', 'n4', 'n5']...
2025-05-25 14:20:49,147 - cluster-integrate - INFO - OUTPUT:   数据集 processed_homecagefamilarmicetrace: 40 个神经元列 - ['n1', 'n2', 'n3', 'n4', 'n5']...
2025-05-25 14:20:49,147 - cluster-integrate - INFO - OUTPUT:   数据集 processed_homecagetrace: 33 个神经元列 - ['n1', 'n2', 'n3', 'n4', 'n5']...
2025-05-25 14:20:49,147 - cluster-integrate - INFO - OUTPUT:   数据集 processed_NORhabititutetrace: 60 个神经元列 - ['n1', 'n2', 'n3', 'n4', 'n5']...
2025-05-25 14:20:49,148 - cluster-integrate - INFO - OUTPUT:   数据集 processed_NORtesttrace: 52 个神经元列 - ['n1', 'n2', 'n3', 'n4', 'n5']...
2025-05-25 14:20:49,148 - cluster-integrate - INFO - OUTPUT:   数据集 processed_openfieldtrace: 38 个神经元列 - ['n1', 'n3', 'n4', 'n5', 'n6']...
2025-05-25 14:20:49,148 - cluster-integrate - INFO - OUTPUT:   数据集 processed_socialtrace01: 36 个神经元列 - ['n1', 'n2', 'n3', 'n4', 'n5']...
2025-05-25 14:20:49,148 - cluster-integrate - INFO - OUTPUT:   数据集 processed_socialtrace02: 35 个神经元列 - ['n1', 'n2', 'n3', 'n4', 'n5']...
2025-05-25 14:20:49,149 - cluster-integrate - INFO - OUTPUT:   数据集 processed_tangsuitiewangtrace: 51 个神经元列 - ['n1', 'n2', 'n3', 'n4', 'n5']...
2025-05-25 14:20:49,149 - cluster-integrate - INFO - OUTPUT:   数据集 processed_tangsuitrace: 53 个神经元列 - ['n1', 'n2', 'n3', 'n4', 'n5']...
2025-05-25 14:20:49,149 - cluster-integrate - INFO - OUTPUT:   数据集 processed_tstrace: 51 个神经元列 - ['n1', 'n2', 'n3', 'n4', 'n5']...
2025-05-25 14:20:49,149 - cluster-integrate - INFO - OUTPUT:   数据集 processed_xuanweitrace: 44 个神经元列 - ['n1', 'n2', 'n3', 'n4', 'n5']...
2025-05-25 14:20:49,150 - cluster-integrate - INFO - OUTPUT:   数据集 processed_ymazetrace: 40 个神经元列 - ['n1', 'n2', 'n3', 'n4', 'n5']...
2025-05-25 14:20:49,150 - cluster-integrate - INFO - OUTPUT: 钙爆发数据中的神经元: 60 个 - ['n1' 'n2' 'n3' 'n4' 'n5']...
2025-05-25 14:20:49,151 - cluster-integrate - INFO - OUTPUT: 创建了 60 个神经元名称映射
2025-05-25 14:20:49,205 - cluster-integrate - INFO - OUTPUT: 聚类 1: 使用从起始点开始的固定长度400处理波形...
2025-05-25 14:20:49,208 - cluster-integrate - INFO - OUTPUT: 聚类 1: 使用源文件信息匹配原始数据
2025-05-25 14:20:49,673 - cluster-integrate - INFO - OUTPUT: 聚类 2: 使用从起始点开始的固定长度400处理波形...
2025-05-25 14:20:49,675 - cluster-integrate - INFO - OUTPUT: 聚类 2: 使用源文件信息匹配原始数据
2025-05-25 14:20:49,727 - cluster-integrate - INFO - OUTPUT: 聚类 3: 使用从起始点开始的固定长度400处理波形...
2025-05-25 14:20:49,728 - cluster-integrate - INFO - OUTPUT: 聚类 3: 使用源文件信息匹配原始数据
2025-05-25 14:20:49,948 - cluster-integrate - INFO - OUTPUT: 聚类 4: 使用从起始点开始的固定长度400处理波形...
2025-05-25 14:20:49,949 - cluster-integrate - INFO - OUTPUT: 聚类 4: 使用源文件信息匹配原始数据
2025-05-25 14:20:50,466 - cluster-integrate - INFO - OUTPUT: 平均钙爆发波形可视化已保存到 ../results/processed_2979_all_datasets_analysis/cluster_average_waveforms.png
2025-05-25 14:20:50,466 - cluster-integrate - INFO - OUTPUT: 波形数据已保存到 ../results/processed_2979_all_datasets_analysis/cluster_average_waveforms.csv
2025-05-25 14:20:50,471 - cluster-integrate - INFO - OUTPUT: 开始生成整合神经元钙波活动时间线图...
2025-05-25 14:20:50,472 - cluster-integrate - INFO - OUTPUT: 错误: 未指定神经元对应表路径，且未找到默认位置的对应表
2025-05-25 14:20:50,473 - cluster-integrate - INFO - OUTPUT: 将聚类标签添加到原始数据...
2025-05-25 14:20:58,171 - cluster-integrate - INFO - OUTPUT: 聚类结果已保存到 ../results/processed_2979_all_datasets_analysis/transients_clustered_k4.xlsx
2025-05-25 14:20:58,172 - cluster-integrate - INFO - OUTPUT: 聚类结果已保存到: ../results/processed_2979_all_datasets_analysis/transients_clustered_k4.xlsx
2025-05-25 14:20:58,172 - cluster-integrate - INFO - OUTPUT: 聚类分析完成!
