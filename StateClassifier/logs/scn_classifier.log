2025-05-23 18:48:34,060 - __main__ - INFO - ============================================================
2025-05-23 18:48:34,060 - __main__ - INFO - 开始数据处理流程
2025-05-23 18:48:34,060 - __main__ - INFO - ============================================================
2025-05-23 18:48:35,205 - scn_phase_space_process - INFO - ============================================================
2025-05-23 18:48:35,205 - scn_phase_space_process - INFO - 3D SCN数据处理流程 - Python版本
2025-05-23 18:48:35,206 - scn_phase_space_process - INFO - 增强版本：支持Excel和MAT格式
2025-05-23 18:48:35,206 - scn_phase_space_process - INFO - ============================================================
2025-05-23 18:48:35,455 - scn_phase_space_process - INFO - 输出目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets
2025-05-23 18:48:35,456 - scn_phase_space_process - INFO - 
步骤1: 智能数据加载
2025-05-23 18:48:35,456 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 18:48:35,531 - scn_phase_space_process - INFO - 正在检测和加载数据文件: datasets/EMtrace01.xlsx
2025-05-23 18:48:35,532 - scn_phase_space_process - INFO - 检测到文件格式: excel
2025-05-23 18:48:35,532 - scn_phase_space_process - INFO - 使用Excel数据处理器加载钙离子数据...
2025-05-23 18:48:35,532 - excel_data_processor - INFO - 正在加载Excel数据文件: datasets\EMtrace01.xlsx
2025-05-23 18:48:36,505 - excel_data_processor - INFO - ✓ 成功加载数据: 2999 个时间点, 43 个神经元
2025-05-23 18:48:36,505 - excel_data_processor - INFO - 神经元列: ['n1', 'n2', 'n3', 'n4', 'n5', 'n6', 'n7', 'n8', 'n9', 'n10']...
2025-05-23 18:48:36,505 - excel_data_processor - INFO - 开始预处理钙离子数据...
2025-05-23 18:48:36,512 - excel_data_processor - WARNING - 检测并处理了 247 个异常值
2025-05-23 18:48:36,512 - excel_data_processor - INFO - 执行Z-score标准化...
2025-05-23 18:48:36,516 - excel_data_processor - INFO - ✓ 数据预处理完成: (2999, 43) -> (2999, 43)
2025-05-23 18:48:36,516 - excel_data_processor - INFO - 转换数据为SCN处理格式...
2025-05-23 18:48:36,516 - excel_data_processor - INFO - 分段参数: 段长度=340, 步长=170
2025-05-23 18:48:36,517 - excel_data_processor - INFO - ✓ 转换完成: 10 个神经元, 平均每个神经元 10.0 个时间段
2025-05-23 18:48:36,519 - scn_phase_space_process - INFO - 数据加载信息:
2025-05-23 18:48:36,519 - scn_phase_space_process - INFO -   文件路径: datasets\EMtrace01.xlsx
2025-05-23 18:48:36,520 - scn_phase_space_process - INFO -   时间点数量: 2999
2025-05-23 18:48:36,520 - scn_phase_space_process - INFO -   神经元数量: 43
2025-05-23 18:48:36,521 - scn_phase_space_process - INFO -   数据形状: (2999, 43)
2025-05-23 18:48:36,521 - scn_phase_space_process - INFO -   时间戳范围: 1 - 2999
2025-05-23 18:48:36,521 - scn_phase_space_process - INFO -   神经元ID: ['n1', 'n2', 'n3', 'n4', 'n5', '...']
2025-05-23 18:48:36,522 - scn_phase_space_process - INFO -   缺失值数量: 0
2025-05-23 18:48:36,522 - scn_phase_space_process - INFO -   数据范围: -1.358 - 4.895
2025-05-23 18:48:36,523 - scn_phase_space_process - INFO -   数据均值: -0.000
2025-05-23 18:48:36,523 - scn_phase_space_process - INFO -   数据标准差: 0.578
2025-05-23 18:48:36,523 - scn_phase_space_process - INFO -   数据格式: Excel
2025-05-23 18:48:36,524 - scn_phase_space_process - INFO -   处理器: ExcelCalciumDataProcessor
2025-05-23 18:48:36,524 - scn_phase_space_process - INFO - 
步骤2: 相空间重构
2025-05-23 18:48:36,524 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 18:48:36,525 - scn_phase_space_process - INFO - 数据维度: 10 个细胞, 10 个时间线
2025-05-23 18:48:36,525 - scn_phase_space_process - INFO - 开始处理钙信号数据...
2025-05-23 18:48:41,277 - scn_phase_space_process - INFO - ✓ 相空间重构完成
2025-05-23 18:48:41,277 - scn_phase_space_process - INFO - 
步骤3: 数据裁剪
2025-05-23 18:48:41,278 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 18:48:41,278 - scn_phase_space_process - INFO - 开始裁剪数据到统一长度: 170
2025-05-23 18:48:41,278 - scn_phase_space_process - INFO - ✓ 数据裁剪完成
2025-05-23 18:48:41,278 - scn_phase_space_process - INFO - 
步骤4: 构建图数据集
2025-05-23 18:48:41,279 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 18:48:41,279 - scn_phase_space_process - INFO - 有效样本数量: 100
2025-05-23 18:48:41,279 - scn_phase_space_process - INFO - 生成 nodes.csv 文件...
2025-05-23 18:48:41,280 - scn_phase_space_process - INFO - 转换节点特征格式...
2025-05-23 18:48:41,352 - scn_phase_space_process - INFO - ✓ nodes.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\nodes.csv
2025-05-23 18:48:41,353 - scn_phase_space_process - INFO - 生成 edges.csv 文件...
2025-05-23 18:48:41,365 - scn_phase_space_process - INFO - ✓ edges.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\edges.csv
2025-05-23 18:48:41,365 - scn_phase_space_process - INFO - 生成 graphs.csv 文件...
2025-05-23 18:48:41,366 - scn_phase_space_process - INFO - 标签分布: {np.int64(0): np.int64(14), np.int64(1): np.int64(15), np.int64(2): np.int64(18), np.int64(3): np.int64(20), np.int64(4): np.int64(17), np.int64(5): np.int64(16)}
2025-05-23 18:48:41,367 - scn_phase_space_process - INFO - ✓ graphs.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\graphs.csv
2025-05-23 18:48:41,368 - scn_phase_space_process - INFO - 
============================================================
2025-05-23 18:48:41,368 - scn_phase_space_process - INFO - 数据处理流程全部完成!
2025-05-23 18:48:41,368 - scn_phase_space_process - INFO - ============================================================
2025-05-23 18:48:41,369 - scn_phase_space_process - INFO - 数据源信息:
2025-05-23 18:48:41,369 - scn_phase_space_process - INFO -   - 文件: datasets/EMtrace01.xlsx
2025-05-23 18:48:41,369 - scn_phase_space_process - INFO -   - 格式: Excel
2025-05-23 18:48:41,370 - scn_phase_space_process - INFO -   - 处理器: ExcelCalciumDataProcessor
2025-05-23 18:48:41,370 - scn_phase_space_process - INFO - 
生成的文件:
2025-05-23 18:48:41,370 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/nodes.csv
2025-05-23 18:48:41,371 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/edges.csv
2025-05-23 18:48:41,371 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/graphs.csv
2025-05-23 18:48:41,371 - scn_phase_space_process - INFO - 
处理结果:
2025-05-23 18:48:41,372 - scn_phase_space_process - INFO -   - 总样本数量: 100
2025-05-23 18:48:41,372 - scn_phase_space_process - INFO -   - 轨迹长度: 170
2025-05-23 18:48:41,372 - scn_phase_space_process - INFO -   - 嵌入维度: 3
2025-05-23 18:48:41,373 - scn_phase_space_process - INFO - 
下一步操作:
2025-05-23 18:48:41,373 - scn_phase_space_process - INFO -   1. 检查生成的CSV文件质量
2025-05-23 18:48:41,374 - scn_phase_space_process - INFO -   2. 运行训练: python main.py 或 python run.py --train
2025-05-23 18:48:41,374 - scn_phase_space_process - INFO -   3. 查看训练结果: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results
2025-05-23 18:48:41,375 - __main__ - INFO - ✓ 数据处理完成
2025-05-23 18:48:41,375 - __main__ - INFO - 操作成功完成
2025-05-23 18:49:02,272 - __main__ - INFO - ============================================================
2025-05-23 18:49:02,273 - __main__ - INFO - 开始模型训练流程
2025-05-23 18:49:02,273 - __main__ - INFO - ============================================================
2025-05-23 18:49:15,904 - main - INFO - ============================================================
2025-05-23 18:49:15,904 - main - INFO - 脑网络状态分类器训练程序启动
2025-05-23 18:49:15,905 - main - INFO - ============================================================
2025-05-23 18:49:15,907 - main - INFO - ✓ 随机种子设置完成
2025-05-23 18:49:15,913 - main - INFO - ✓ 使用GPU: NVIDIA GeForce RTX 4060
2025-05-23 18:49:15,914 - main - INFO - 加载数据集...
2025-05-23 18:49:15,971 - main - INFO - ✓ 数据集加载成功
2025-05-23 18:49:15,972 - main - INFO -   - 训练集批次数: 240
2025-05-23 18:49:15,972 - main - INFO -   - 验证集批次数: 20
2025-05-23 18:49:15,972 - main - INFO -   - 测试集批次数: 19
2025-05-23 18:49:16,185 - main - INFO - ✓ 模型创建成功
2025-05-23 18:49:16,185 - main - INFO - 模型架构:
MultiLayerGCN(
  (conv0): GCNConv(3, 32)
  (conv1): GCNConv(32, 32)
  (conv2): GCNConv(32, 32)
  (pool): GlobalPooling(
    (max_pool): AdaptiveMaxPool1d(output_size=1)
    (avg_pool): AdaptiveAvgPool1d(output_size=1)
  )
  (classifier): Sequential(
    (fc0): Linear(in_features=192, out_features=16, bias=False)
    (relu0): LeakyReLU(negative_slope=0.2)
    (drop0): Dropout(p=0.5, inplace=False)
    (fc2): Linear(in_features=16, out_features=6, bias=True)
  )
)
2025-05-23 18:49:16,186 - main - INFO - 模型参数总数: 5,414
2025-05-23 18:49:16,186 - main - INFO - 可训练参数: 5,414
2025-05-23 18:49:16,186 - main - INFO - 
开始模型训练...
2025-05-23 18:49:16,187 - main - INFO - 开始训练，总共 160 个epoch
2025-05-23 18:49:18,238 - main - INFO - Epoch 1 平均损失: 1.8034
2025-05-23 18:49:18,314 - main - INFO - Epoch 1/160 - 训练损失: 1.8034, 验证准确率: 0.3500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:49:19,469 - main - INFO - Epoch 2 平均损失: 1.7931
2025-05-23 18:49:19,532 - main - INFO - Epoch 2/160 - 训练损失: 1.7931, 验证准确率: 0.3000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:49:20,739 - main - INFO - Epoch 3 平均损失: 1.8045
2025-05-23 18:49:20,798 - main - INFO - Epoch 3/160 - 训练损失: 1.8045, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:49:22,026 - main - INFO - Epoch 4 平均损失: 1.7776
2025-05-23 18:49:22,085 - main - INFO - Epoch 4/160 - 训练损失: 1.7776, 验证准确率: 0.3000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:49:23,205 - main - INFO - Epoch 5 平均损失: 1.7617
2025-05-23 18:49:23,269 - main - INFO - Epoch 5/160 - 训练损失: 1.7617, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:49:24,398 - main - INFO - Epoch 6 平均损失: 1.7692
2025-05-23 18:49:24,463 - main - INFO - Epoch 6/160 - 训练损失: 1.7692, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:49:25,721 - main - INFO - Epoch 7 平均损失: 1.7601
2025-05-23 18:49:25,791 - main - INFO - Epoch 7/160 - 训练损失: 1.7601, 验证准确率: 0.3000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:49:27,092 - main - INFO - Epoch 8 平均损失: 1.7369
2025-05-23 18:49:27,158 - main - INFO - Epoch 8/160 - 训练损失: 1.7369, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:49:28,319 - main - INFO - Epoch 9 平均损失: 1.7436
2025-05-23 18:49:28,390 - main - INFO - Epoch 9/160 - 训练损失: 1.7436, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:49:29,594 - main - INFO - Epoch 10 平均损失: 1.7220
2025-05-23 18:49:29,659 - main - INFO - Epoch 10/160 - 训练损失: 1.7220, 验证准确率: 0.0000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:49:30,888 - main - INFO - Epoch 11 平均损失: 1.7015
2025-05-23 18:49:30,962 - main - INFO - Epoch 11/160 - 训练损失: 1.7015, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:49:32,214 - main - INFO - Epoch 12 平均损失: 1.7111
2025-05-23 18:49:32,277 - main - INFO - Epoch 12/160 - 训练损失: 1.7111, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:49:33,533 - main - INFO - Epoch 13 平均损失: 1.7085
2025-05-23 18:49:33,611 - main - INFO - Epoch 13/160 - 训练损失: 1.7085, 验证准确率: 0.0000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:49:34,871 - main - INFO - Epoch 14 平均损失: 1.7022
2025-05-23 18:49:34,940 - main - INFO - Epoch 14/160 - 训练损失: 1.7022, 验证准确率: 0.0500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:49:36,192 - main - INFO - Epoch 15 平均损失: 1.6723
2025-05-23 18:49:36,270 - main - INFO - Epoch 15/160 - 训练损失: 1.6723, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:49:37,498 - main - INFO - Epoch 16 平均损失: 1.6644
2025-05-23 18:49:37,567 - main - INFO - Epoch 16/160 - 训练损失: 1.6644, 验证准确率: 0.0500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:49:38,797 - main - INFO - Epoch 17 平均损失: 1.6432
2025-05-23 18:49:38,865 - main - INFO - Epoch 17/160 - 训练损失: 1.6432, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:49:40,029 - main - INFO - Epoch 18 平均损失: 1.6602
2025-05-23 18:49:40,097 - main - INFO - Epoch 18/160 - 训练损失: 1.6602, 验证准确率: 0.0500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:49:41,320 - main - INFO - Epoch 19 平均损失: 1.6385
2025-05-23 18:49:41,384 - main - INFO - Epoch 19/160 - 训练损失: 1.6385, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:49:42,658 - main - INFO - Epoch 20 平均损失: 1.6472
2025-05-23 18:49:42,734 - main - INFO - Epoch 20/160 - 训练损失: 1.6472, 验证准确率: 0.2500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:49:42,735 - main - INFO - 学习率衰减至: 0.000750
2025-05-23 18:49:44,021 - main - INFO - Epoch 21 平均损失: 1.5749
2025-05-23 18:49:44,099 - main - INFO - Epoch 21/160 - 训练损失: 1.5749, 验证准确率: 0.2500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:49:45,373 - main - INFO - Epoch 22 平均损失: 1.5450
2025-05-23 18:49:45,457 - main - INFO - Epoch 22/160 - 训练损失: 1.5450, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:49:46,737 - main - INFO - Epoch 23 平均损失: 1.5803
2025-05-23 18:49:46,807 - main - INFO - Epoch 23/160 - 训练损失: 1.5803, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:49:48,008 - main - INFO - Epoch 24 平均损失: 1.5770
2025-05-23 18:49:48,074 - main - INFO - Epoch 24/160 - 训练损失: 1.5770, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:49:49,432 - main - INFO - Epoch 25 平均损失: 1.5521
2025-05-23 18:49:49,504 - main - INFO - Epoch 25/160 - 训练损失: 1.5521, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:49:50,861 - main - INFO - Epoch 26 平均损失: 1.5211
2025-05-23 18:49:50,935 - main - INFO - Epoch 26/160 - 训练损失: 1.5211, 验证准确率: 0.0000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:49:52,161 - main - INFO - Epoch 27 平均损失: 1.5190
2025-05-23 18:49:52,231 - main - INFO - Epoch 27/160 - 训练损失: 1.5190, 验证准确率: 0.0000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:49:53,443 - main - INFO - Epoch 28 平均损失: 1.5106
2025-05-23 18:49:53,517 - main - INFO - Epoch 28/160 - 训练损失: 1.5106, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:49:54,714 - main - INFO - Epoch 29 平均损失: 1.4798
2025-05-23 18:49:54,779 - main - INFO - Epoch 29/160 - 训练损失: 1.4798, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:49:56,069 - main - INFO - Epoch 30 平均损失: 1.5262
2025-05-23 18:49:56,147 - main - INFO - Epoch 30/160 - 训练损失: 1.5262, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:49:57,460 - main - INFO - Epoch 31 平均损失: 1.5349
2025-05-23 18:49:57,533 - main - INFO - Epoch 31/160 - 训练损失: 1.5349, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:49:58,779 - main - INFO - Epoch 32 平均损失: 1.4814
2025-05-23 18:49:58,855 - main - INFO - Epoch 32/160 - 训练损失: 1.4814, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:00,023 - main - INFO - Epoch 33 平均损失: 1.4738
2025-05-23 18:50:00,088 - main - INFO - Epoch 33/160 - 训练损失: 1.4738, 验证准确率: 0.0000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:01,177 - main - INFO - Epoch 34 平均损失: 1.4991
2025-05-23 18:50:01,248 - main - INFO - Epoch 34/160 - 训练损失: 1.4991, 验证准确率: 0.0500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:02,351 - main - INFO - Epoch 35 平均损失: 1.4406
2025-05-23 18:50:02,428 - main - INFO - Epoch 35/160 - 训练损失: 1.4406, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:03,615 - main - INFO - Epoch 36 平均损失: 1.4653
2025-05-23 18:50:03,684 - main - INFO - Epoch 36/160 - 训练损失: 1.4653, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:04,858 - main - INFO - Epoch 37 平均损失: 1.4520
2025-05-23 18:50:04,942 - main - INFO - Epoch 37/160 - 训练损失: 1.4520, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:06,185 - main - INFO - Epoch 38 平均损失: 1.4825
2025-05-23 18:50:06,263 - main - INFO - Epoch 38/160 - 训练损失: 1.4825, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:07,572 - main - INFO - Epoch 39 平均损失: 1.4040
2025-05-23 18:50:07,671 - main - INFO - Epoch 39/160 - 训练损失: 1.4040, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:08,967 - main - INFO - Epoch 40 平均损失: 1.4054
2025-05-23 18:50:09,069 - main - INFO - Epoch 40/160 - 训练损失: 1.4054, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:09,070 - main - INFO - 学习率衰减至: 0.000563
2025-05-23 18:50:10,246 - main - INFO - Epoch 41 平均损失: 1.3852
2025-05-23 18:50:10,311 - main - INFO - Epoch 41/160 - 训练损失: 1.3852, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:11,569 - main - INFO - Epoch 42 平均损失: 1.4006
2025-05-23 18:50:11,649 - main - INFO - Epoch 42/160 - 训练损失: 1.4006, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:12,915 - main - INFO - Epoch 43 平均损失: 1.4127
2025-05-23 18:50:12,978 - main - INFO - Epoch 43/160 - 训练损失: 1.4127, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:14,182 - main - INFO - Epoch 44 平均损失: 1.3745
2025-05-23 18:50:14,249 - main - INFO - Epoch 44/160 - 训练损失: 1.3745, 验证准确率: 0.2500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:15,409 - main - INFO - Epoch 45 平均损失: 1.3693
2025-05-23 18:50:15,469 - main - INFO - Epoch 45/160 - 训练损失: 1.3693, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:16,622 - main - INFO - Epoch 46 平均损失: 1.4087
2025-05-23 18:50:16,681 - main - INFO - Epoch 46/160 - 训练损失: 1.4087, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:17,869 - main - INFO - Epoch 47 平均损失: 1.4172
2025-05-23 18:50:17,945 - main - INFO - Epoch 47/160 - 训练损失: 1.4172, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:19,191 - main - INFO - Epoch 48 平均损失: 1.3352
2025-05-23 18:50:19,266 - main - INFO - Epoch 48/160 - 训练损失: 1.3352, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:20,403 - main - INFO - Epoch 49 平均损失: 1.3579
2025-05-23 18:50:20,472 - main - INFO - Epoch 49/160 - 训练损失: 1.3579, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:21,542 - main - INFO - Epoch 50 平均损失: 1.3309
2025-05-23 18:50:21,609 - main - INFO - Epoch 50/160 - 训练损失: 1.3309, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:22,638 - main - INFO - Epoch 51 平均损失: 1.3321
2025-05-23 18:50:22,700 - main - INFO - Epoch 51/160 - 训练损失: 1.3321, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:23,739 - main - INFO - Epoch 52 平均损失: 1.2944
2025-05-23 18:50:23,835 - main - INFO - Epoch 52/160 - 训练损失: 1.2944, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:24,977 - main - INFO - Epoch 53 平均损失: 1.3670
2025-05-23 18:50:25,049 - main - INFO - Epoch 53/160 - 训练损失: 1.3670, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:26,179 - main - INFO - Epoch 54 平均损失: 1.3107
2025-05-23 18:50:26,248 - main - INFO - Epoch 54/160 - 训练损失: 1.3107, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:27,302 - main - INFO - Epoch 55 平均损失: 1.2471
2025-05-23 18:50:27,364 - main - INFO - Epoch 55/160 - 训练损失: 1.2471, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:28,468 - main - INFO - Epoch 56 平均损失: 1.3113
2025-05-23 18:50:28,532 - main - INFO - Epoch 56/160 - 训练损失: 1.3113, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:29,687 - main - INFO - Epoch 57 平均损失: 1.2900
2025-05-23 18:50:29,747 - main - INFO - Epoch 57/160 - 训练损失: 1.2900, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:30,869 - main - INFO - Epoch 58 平均损失: 1.2758
2025-05-23 18:50:30,942 - main - INFO - Epoch 58/160 - 训练损失: 1.2758, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:32,131 - main - INFO - Epoch 59 平均损失: 1.1780
2025-05-23 18:50:32,201 - main - INFO - Epoch 59/160 - 训练损失: 1.1780, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:33,382 - main - INFO - Epoch 60 平均损失: 1.2639
2025-05-23 18:50:33,444 - main - INFO - Epoch 60/160 - 训练损失: 1.2639, 验证准确率: 0.2500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:33,445 - main - INFO - 学习率衰减至: 0.000422
2025-05-23 18:50:34,622 - main - INFO - Epoch 61 平均损失: 1.2248
2025-05-23 18:50:34,680 - main - INFO - Epoch 61/160 - 训练损失: 1.2248, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:35,872 - main - INFO - Epoch 62 平均损失: 1.2091
2025-05-23 18:50:35,940 - main - INFO - Epoch 62/160 - 训练损失: 1.2091, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:36,988 - main - INFO - Epoch 63 平均损失: 1.2514
2025-05-23 18:50:37,051 - main - INFO - Epoch 63/160 - 训练损失: 1.2514, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:38,015 - main - INFO - Epoch 64 平均损失: 1.2273
2025-05-23 18:50:38,075 - main - INFO - Epoch 64/160 - 训练损失: 1.2273, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:39,030 - main - INFO - Epoch 65 平均损失: 1.2247
2025-05-23 18:50:39,082 - main - INFO - Epoch 65/160 - 训练损失: 1.2247, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:40,069 - main - INFO - Epoch 66 平均损失: 1.2269
2025-05-23 18:50:40,125 - main - INFO - Epoch 66/160 - 训练损失: 1.2269, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:41,086 - main - INFO - Epoch 67 平均损失: 1.2338
2025-05-23 18:50:41,147 - main - INFO - Epoch 67/160 - 训练损失: 1.2338, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:42,291 - main - INFO - Epoch 68 平均损失: 1.2124
2025-05-23 18:50:42,381 - main - INFO - Epoch 68/160 - 训练损失: 1.2124, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:43,514 - main - INFO - Epoch 69 平均损失: 1.1821
2025-05-23 18:50:43,570 - main - INFO - Epoch 69/160 - 训练损失: 1.1821, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:44,631 - main - INFO - Epoch 70 平均损失: 1.2045
2025-05-23 18:50:44,687 - main - INFO - Epoch 70/160 - 训练损失: 1.2045, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:45,775 - main - INFO - Epoch 71 平均损失: 1.1820
2025-05-23 18:50:45,835 - main - INFO - Epoch 71/160 - 训练损失: 1.1820, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:47,152 - main - INFO - Epoch 72 平均损失: 1.2004
2025-05-23 18:50:47,220 - main - INFO - Epoch 72/160 - 训练损失: 1.2004, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:48,509 - main - INFO - Epoch 73 平均损失: 1.1673
2025-05-23 18:50:48,573 - main - INFO - Epoch 73/160 - 训练损失: 1.1673, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:49,747 - main - INFO - Epoch 74 平均损失: 1.2613
2025-05-23 18:50:49,813 - main - INFO - Epoch 74/160 - 训练损失: 1.2613, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:50,886 - main - INFO - Epoch 75 平均损失: 1.1926
2025-05-23 18:50:50,945 - main - INFO - Epoch 75/160 - 训练损失: 1.1926, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:52,021 - main - INFO - Epoch 76 平均损失: 1.1630
2025-05-23 18:50:52,093 - main - INFO - Epoch 76/160 - 训练损失: 1.1630, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:53,202 - main - INFO - Epoch 77 平均损失: 1.1438
2025-05-23 18:50:53,278 - main - INFO - Epoch 77/160 - 训练损失: 1.1438, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:54,378 - main - INFO - Epoch 78 平均损失: 1.2688
2025-05-23 18:50:54,449 - main - INFO - Epoch 78/160 - 训练损失: 1.2688, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:55,485 - main - INFO - Epoch 79 平均损失: 1.1317
2025-05-23 18:50:55,542 - main - INFO - Epoch 79/160 - 训练损失: 1.1317, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:56,711 - main - INFO - Epoch 80 平均损失: 1.2151
2025-05-23 18:50:56,774 - main - INFO - Epoch 80/160 - 训练损失: 1.2151, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:56,775 - main - INFO - 学习率衰减至: 0.000316
2025-05-23 18:50:57,932 - main - INFO - Epoch 81 平均损失: 1.1034
2025-05-23 18:50:57,993 - main - INFO - Epoch 81/160 - 训练损失: 1.1034, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:50:59,109 - main - INFO - Epoch 82 平均损失: 1.1475
2025-05-23 18:50:59,180 - main - INFO - Epoch 82/160 - 训练损失: 1.1475, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:00,301 - main - INFO - Epoch 83 平均损失: 1.1624
2025-05-23 18:51:00,360 - main - INFO - Epoch 83/160 - 训练损失: 1.1624, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:01,523 - main - INFO - Epoch 84 平均损失: 1.1842
2025-05-23 18:51:01,604 - main - INFO - Epoch 84/160 - 训练损失: 1.1842, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:02,776 - main - INFO - Epoch 85 平均损失: 1.0591
2025-05-23 18:51:02,837 - main - INFO - Epoch 85/160 - 训练损失: 1.0591, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:03,959 - main - INFO - Epoch 86 平均损失: 1.1574
2025-05-23 18:51:04,024 - main - INFO - Epoch 86/160 - 训练损失: 1.1574, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:05,225 - main - INFO - Epoch 87 平均损失: 1.1424
2025-05-23 18:51:05,287 - main - INFO - Epoch 87/160 - 训练损失: 1.1424, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:06,387 - main - INFO - Epoch 88 平均损失: 1.1157
2025-05-23 18:51:06,455 - main - INFO - Epoch 88/160 - 训练损失: 1.1157, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:07,762 - main - INFO - Epoch 89 平均损失: 1.1394
2025-05-23 18:51:07,830 - main - INFO - Epoch 89/160 - 训练损失: 1.1394, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:08,910 - main - INFO - Epoch 90 平均损失: 1.0103
2025-05-23 18:51:08,974 - main - INFO - Epoch 90/160 - 训练损失: 1.0103, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:10,042 - main - INFO - Epoch 91 平均损失: 1.0807
2025-05-23 18:51:10,109 - main - INFO - Epoch 91/160 - 训练损失: 1.0807, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:11,225 - main - INFO - Epoch 92 平均损失: 1.0970
2025-05-23 18:51:11,292 - main - INFO - Epoch 92/160 - 训练损失: 1.0970, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:12,324 - main - INFO - Epoch 93 平均损失: 1.0840
2025-05-23 18:51:12,386 - main - INFO - Epoch 93/160 - 训练损失: 1.0840, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:13,410 - main - INFO - Epoch 94 平均损失: 1.0643
2025-05-23 18:51:13,472 - main - INFO - Epoch 94/160 - 训练损失: 1.0643, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:14,515 - main - INFO - Epoch 95 平均损失: 1.1565
2025-05-23 18:51:14,575 - main - INFO - Epoch 95/160 - 训练损失: 1.1565, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:15,645 - main - INFO - Epoch 96 平均损失: 1.0366
2025-05-23 18:51:15,703 - main - INFO - Epoch 96/160 - 训练损失: 1.0366, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:16,743 - main - INFO - Epoch 97 平均损失: 1.0637
2025-05-23 18:51:16,804 - main - INFO - Epoch 97/160 - 训练损失: 1.0637, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:17,962 - main - INFO - Epoch 98 平均损失: 1.1032
2025-05-23 18:51:18,031 - main - INFO - Epoch 98/160 - 训练损失: 1.1032, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:19,110 - main - INFO - Epoch 99 平均损失: 1.1143
2025-05-23 18:51:19,178 - main - INFO - Epoch 99/160 - 训练损失: 1.1143, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:20,267 - main - INFO - Epoch 100 平均损失: 1.0359
2025-05-23 18:51:20,329 - main - INFO - Epoch 100/160 - 训练损失: 1.0359, 验证准确率: 0.2500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:20,329 - main - INFO - 学习率衰减至: 0.000237
2025-05-23 18:51:21,520 - main - INFO - Epoch 101 平均损失: 1.1156
2025-05-23 18:51:21,581 - main - INFO - Epoch 101/160 - 训练损失: 1.1156, 验证准确率: 0.2500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:22,780 - main - INFO - Epoch 102 平均损失: 1.0918
2025-05-23 18:51:22,846 - main - INFO - Epoch 102/160 - 训练损失: 1.0918, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:24,110 - main - INFO - Epoch 103 平均损失: 0.9760
2025-05-23 18:51:24,187 - main - INFO - Epoch 103/160 - 训练损失: 0.9760, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:25,341 - main - INFO - Epoch 104 平均损失: 1.0187
2025-05-23 18:51:25,409 - main - INFO - Epoch 104/160 - 训练损失: 1.0187, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:26,569 - main - INFO - Epoch 105 平均损失: 1.0202
2025-05-23 18:51:26,637 - main - INFO - Epoch 105/160 - 训练损失: 1.0202, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:27,800 - main - INFO - Epoch 106 平均损失: 0.9963
2025-05-23 18:51:27,859 - main - INFO - Epoch 106/160 - 训练损失: 0.9963, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:28,872 - main - INFO - Epoch 107 平均损失: 1.0362
2025-05-23 18:51:28,937 - main - INFO - Epoch 107/160 - 训练损失: 1.0362, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:29,921 - main - INFO - Epoch 108 平均损失: 1.0410
2025-05-23 18:51:29,982 - main - INFO - Epoch 108/160 - 训练损失: 1.0410, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:30,969 - main - INFO - Epoch 109 平均损失: 1.1046
2025-05-23 18:51:31,030 - main - INFO - Epoch 109/160 - 训练损失: 1.1046, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:32,108 - main - INFO - Epoch 110 平均损失: 0.9900
2025-05-23 18:51:32,181 - main - INFO - Epoch 110/160 - 训练损失: 0.9900, 验证准确率: 0.2500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:33,195 - main - INFO - Epoch 111 平均损失: 0.9942
2025-05-23 18:51:33,257 - main - INFO - Epoch 111/160 - 训练损失: 0.9942, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:34,258 - main - INFO - Epoch 112 平均损失: 0.9369
2025-05-23 18:51:34,314 - main - INFO - Epoch 112/160 - 训练损失: 0.9369, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:35,346 - main - INFO - Epoch 113 平均损失: 0.9537
2025-05-23 18:51:35,409 - main - INFO - Epoch 113/160 - 训练损失: 0.9537, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:36,452 - main - INFO - Epoch 114 平均损失: 1.0122
2025-05-23 18:51:36,509 - main - INFO - Epoch 114/160 - 训练损失: 1.0122, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:37,526 - main - INFO - Epoch 115 平均损失: 1.0334
2025-05-23 18:51:37,588 - main - INFO - Epoch 115/160 - 训练损失: 1.0334, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:38,554 - main - INFO - Epoch 116 平均损失: 1.0505
2025-05-23 18:51:38,608 - main - INFO - Epoch 116/160 - 训练损失: 1.0505, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:39,606 - main - INFO - Epoch 117 平均损失: 1.0103
2025-05-23 18:51:39,661 - main - INFO - Epoch 117/160 - 训练损失: 1.0103, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:40,719 - main - INFO - Epoch 118 平均损失: 1.0209
2025-05-23 18:51:40,769 - main - INFO - Epoch 118/160 - 训练损失: 1.0209, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:41,760 - main - INFO - Epoch 119 平均损失: 1.0406
2025-05-23 18:51:41,853 - main - INFO - Epoch 119/160 - 训练损失: 1.0406, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:42,810 - main - INFO - Epoch 120 平均损失: 0.9964
2025-05-23 18:51:42,866 - main - INFO - Epoch 120/160 - 训练损失: 0.9964, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:42,867 - main - INFO - 学习率衰减至: 0.000178
2025-05-23 18:51:43,876 - main - INFO - Epoch 121 平均损失: 1.0618
2025-05-23 18:51:43,937 - main - INFO - Epoch 121/160 - 训练损失: 1.0618, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:44,905 - main - INFO - Epoch 122 平均损失: 0.9856
2025-05-23 18:51:44,963 - main - INFO - Epoch 122/160 - 训练损失: 0.9856, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:45,971 - main - INFO - Epoch 123 平均损失: 0.9762
2025-05-23 18:51:46,024 - main - INFO - Epoch 123/160 - 训练损失: 0.9762, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:47,105 - main - INFO - Epoch 124 平均损失: 1.0236
2025-05-23 18:51:47,181 - main - INFO - Epoch 124/160 - 训练损失: 1.0236, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:48,351 - main - INFO - Epoch 125 平均损失: 0.9117
2025-05-23 18:51:48,418 - main - INFO - Epoch 125/160 - 训练损失: 0.9117, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:49,537 - main - INFO - Epoch 126 平均损失: 0.8997
2025-05-23 18:51:49,600 - main - INFO - Epoch 126/160 - 训练损失: 0.8997, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:50,696 - main - INFO - Epoch 127 平均损失: 0.9892
2025-05-23 18:51:50,754 - main - INFO - Epoch 127/160 - 训练损失: 0.9892, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:51,868 - main - INFO - Epoch 128 平均损失: 0.8992
2025-05-23 18:51:51,932 - main - INFO - Epoch 128/160 - 训练损失: 0.8992, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:53,021 - main - INFO - Epoch 129 平均损失: 1.0091
2025-05-23 18:51:53,085 - main - INFO - Epoch 129/160 - 训练损失: 1.0091, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:54,104 - main - INFO - Epoch 130 平均损失: 0.9402
2025-05-23 18:51:54,170 - main - INFO - Epoch 130/160 - 训练损失: 0.9402, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:55,179 - main - INFO - Epoch 131 平均损失: 0.9928
2025-05-23 18:51:55,230 - main - INFO - Epoch 131/160 - 训练损失: 0.9928, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:56,210 - main - INFO - Epoch 132 平均损失: 0.9682
2025-05-23 18:51:56,263 - main - INFO - Epoch 132/160 - 训练损失: 0.9682, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:57,240 - main - INFO - Epoch 133 平均损失: 0.8633
2025-05-23 18:51:57,298 - main - INFO - Epoch 133/160 - 训练损失: 0.8633, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:58,314 - main - INFO - Epoch 134 平均损失: 1.0251
2025-05-23 18:51:58,366 - main - INFO - Epoch 134/160 - 训练损失: 1.0251, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:51:59,332 - main - INFO - Epoch 135 平均损失: 0.9267
2025-05-23 18:51:59,392 - main - INFO - Epoch 135/160 - 训练损失: 0.9267, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:52:00,495 - main - INFO - Epoch 136 平均损失: 0.9357
2025-05-23 18:52:00,552 - main - INFO - Epoch 136/160 - 训练损失: 0.9357, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:52:01,591 - main - INFO - Epoch 137 平均损失: 1.0202
2025-05-23 18:52:01,660 - main - INFO - Epoch 137/160 - 训练损失: 1.0202, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:52:02,718 - main - INFO - Epoch 138 平均损失: 0.9573
2025-05-23 18:52:02,775 - main - INFO - Epoch 138/160 - 训练损失: 0.9573, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:52:03,840 - main - INFO - Epoch 139 平均损失: 0.9282
2025-05-23 18:52:03,902 - main - INFO - Epoch 139/160 - 训练损失: 0.9282, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:52:04,980 - main - INFO - Epoch 140 平均损失: 0.9294
2025-05-23 18:52:05,036 - main - INFO - Epoch 140/160 - 训练损失: 0.9294, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:52:05,036 - main - INFO - 学习率衰减至: 0.000133
2025-05-23 18:52:06,060 - main - INFO - Epoch 141 平均损失: 0.9189
2025-05-23 18:52:06,122 - main - INFO - Epoch 141/160 - 训练损失: 0.9189, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:52:07,077 - main - INFO - Epoch 142 平均损失: 0.8633
2025-05-23 18:52:07,134 - main - INFO - Epoch 142/160 - 训练损失: 0.8633, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:52:08,102 - main - INFO - Epoch 143 平均损失: 0.8860
2025-05-23 18:52:08,174 - main - INFO - Epoch 143/160 - 训练损失: 0.8860, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:52:09,226 - main - INFO - Epoch 144 平均损失: 0.8845
2025-05-23 18:52:09,284 - main - INFO - Epoch 144/160 - 训练损失: 0.8845, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:52:10,286 - main - INFO - Epoch 145 平均损失: 0.9325
2025-05-23 18:52:10,339 - main - INFO - Epoch 145/160 - 训练损失: 0.9325, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:52:11,325 - main - INFO - Epoch 146 平均损失: 0.9390
2025-05-23 18:52:11,375 - main - INFO - Epoch 146/160 - 训练损失: 0.9390, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:52:12,347 - main - INFO - Epoch 147 平均损失: 0.9629
2025-05-23 18:52:12,405 - main - INFO - Epoch 147/160 - 训练损失: 0.9629, 验证准确率: 0.2500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:52:13,468 - main - INFO - Epoch 148 平均损失: 1.0508
2025-05-23 18:52:13,518 - main - INFO - Epoch 148/160 - 训练损失: 1.0508, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:52:14,607 - main - INFO - Epoch 149 平均损失: 0.9636
2025-05-23 18:52:14,660 - main - INFO - Epoch 149/160 - 训练损失: 0.9636, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:52:15,726 - main - INFO - Epoch 150 平均损失: 0.9503
2025-05-23 18:52:15,783 - main - INFO - Epoch 150/160 - 训练损失: 0.9503, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:52:16,843 - main - INFO - Epoch 151 平均损失: 0.9215
2025-05-23 18:52:16,911 - main - INFO - Epoch 151/160 - 训练损失: 0.9215, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:52:18,090 - main - INFO - Epoch 152 平均损失: 0.8905
2025-05-23 18:52:18,157 - main - INFO - Epoch 152/160 - 训练损失: 0.8905, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:52:19,254 - main - INFO - Epoch 153 平均损失: 0.9123
2025-05-23 18:52:19,308 - main - INFO - Epoch 153/160 - 训练损失: 0.9123, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:52:20,467 - main - INFO - Epoch 154 平均损失: 0.8817
2025-05-23 18:52:20,525 - main - INFO - Epoch 154/160 - 训练损失: 0.8817, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:52:21,659 - main - INFO - Epoch 155 平均损失: 0.8855
2025-05-23 18:52:21,713 - main - INFO - Epoch 155/160 - 训练损失: 0.8855, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:52:22,846 - main - INFO - Epoch 156 平均损失: 0.8182
2025-05-23 18:52:22,904 - main - INFO - Epoch 156/160 - 训练损失: 0.8182, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:52:23,983 - main - INFO - Epoch 157 平均损失: 0.9173
2025-05-23 18:52:24,038 - main - INFO - Epoch 157/160 - 训练损失: 0.9173, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:52:25,132 - main - INFO - Epoch 158 平均损失: 0.8557
2025-05-23 18:52:25,190 - main - INFO - Epoch 158/160 - 训练损失: 0.8557, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:52:26,436 - main - INFO - Epoch 159 平均损失: 0.9427
2025-05-23 18:52:26,509 - main - INFO - Epoch 159/160 - 训练损失: 0.9427, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:52:27,814 - main - INFO - Epoch 160 平均损失: 0.8808
2025-05-23 18:52:27,872 - main - INFO - Epoch 160/160 - 训练损失: 0.8808, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 18:52:27,879 - main - INFO - 最佳模型已保存至: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results\best_scn.pt
2025-05-23 18:52:27,880 - main - INFO - 
在测试集上评估最终性能...
2025-05-23 18:52:27,941 - main - INFO - ============================================================
2025-05-23 18:52:27,941 - main - INFO - 最终测试结果:
2025-05-23 18:52:27,942 - main - INFO -   测试损失: 3.4513
2025-05-23 18:52:27,942 - main - INFO -   测试准确率: 0.1053
2025-05-23 18:52:27,943 - main - INFO -   平均类别准确率: 0.2083
2025-05-23 18:52:27,943 - main - INFO - ============================================================
2025-05-23 18:52:27,943 - __main__ - INFO - ✓ 模型训练完成
2025-05-23 18:52:27,944 - __main__ - INFO - 最终测试准确率: 0.1053
2025-05-23 18:52:27,944 - __main__ - INFO - 平均类别准确率: 0.2083
2025-05-23 18:52:27,944 - __main__ - INFO - 操作成功完成
2025-05-23 20:08:02,898 - __main__ - INFO - ============================================================
2025-05-23 20:08:02,898 - __main__ - INFO - 开始数据处理流程
2025-05-23 20:08:02,898 - __main__ - INFO - ============================================================
2025-05-23 20:08:06,439 - scn_phase_space_process - INFO - ============================================================
2025-05-23 20:08:06,439 - scn_phase_space_process - INFO - 3D SCN数据处理流程 - Python版本
2025-05-23 20:08:06,439 - scn_phase_space_process - INFO - 增强版本：支持Excel和MAT格式
2025-05-23 20:08:06,439 - scn_phase_space_process - INFO - ============================================================
2025-05-23 20:08:06,440 - scn_phase_space_process - INFO - 输出目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets
2025-05-23 20:08:06,440 - scn_phase_space_process - INFO - 
步骤1: 智能数据加载
2025-05-23 20:08:06,440 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 20:08:06,441 - scn_phase_space_process - INFO - 正在检测和加载数据文件: datasets/EMtrace01.xlsx
2025-05-23 20:08:06,441 - scn_phase_space_process - INFO - 检测到文件格式: excel
2025-05-23 20:08:06,441 - scn_phase_space_process - INFO - 使用Excel数据处理器加载钙离子数据...
2025-05-23 20:08:06,441 - excel_data_processor - INFO - 正在加载Excel数据文件: datasets\EMtrace01.xlsx
2025-05-23 20:08:07,443 - excel_data_processor - INFO - ✓ 成功加载数据: 2999 个时间点, 43 个神经元
2025-05-23 20:08:07,444 - excel_data_processor - INFO - 神经元列: ['n1', 'n2', 'n3', 'n4', 'n5', 'n6', 'n7', 'n8', 'n9', 'n10']...
2025-05-23 20:08:07,444 - excel_data_processor - INFO - 开始预处理钙离子数据...
2025-05-23 20:08:07,450 - excel_data_processor - WARNING - 检测并处理了 247 个异常值
2025-05-23 20:08:07,450 - excel_data_processor - INFO - 执行Z-score标准化...
2025-05-23 20:08:07,453 - excel_data_processor - INFO - ✓ 数据预处理完成: (2999, 43) -> (2999, 43)
2025-05-23 20:08:07,453 - excel_data_processor - INFO - 转换数据为SCN处理格式...
2025-05-23 20:08:07,453 - excel_data_processor - INFO - 分段参数: 段长度=340, 步长=170
2025-05-23 20:08:07,454 - excel_data_processor - INFO - ✓ 转换完成: 10 个神经元, 平均每个神经元 10.0 个时间段
2025-05-23 20:08:07,456 - scn_phase_space_process - INFO - 数据加载信息:
2025-05-23 20:08:07,456 - scn_phase_space_process - INFO -   文件路径: datasets\EMtrace01.xlsx
2025-05-23 20:08:07,457 - scn_phase_space_process - INFO -   时间点数量: 2999
2025-05-23 20:08:07,457 - scn_phase_space_process - INFO -   神经元数量: 43
2025-05-23 20:08:07,457 - scn_phase_space_process - INFO -   数据形状: (2999, 43)
2025-05-23 20:08:07,458 - scn_phase_space_process - INFO -   时间戳范围: 1 - 2999
2025-05-23 20:08:07,458 - scn_phase_space_process - INFO -   神经元ID: ['n1', 'n2', 'n3', 'n4', 'n5', '...']
2025-05-23 20:08:07,459 - scn_phase_space_process - INFO -   缺失值数量: 0
2025-05-23 20:08:07,459 - scn_phase_space_process - INFO -   数据范围: -1.358 - 4.895
2025-05-23 20:08:07,459 - scn_phase_space_process - INFO -   数据均值: -0.000
2025-05-23 20:08:07,460 - scn_phase_space_process - INFO -   数据标准差: 0.578
2025-05-23 20:08:07,460 - scn_phase_space_process - INFO -   数据格式: Excel
2025-05-23 20:08:07,460 - scn_phase_space_process - INFO -   处理器: ExcelCalciumDataProcessor
2025-05-23 20:08:07,461 - scn_phase_space_process - INFO - 
步骤2: 相空间重构
2025-05-23 20:08:07,461 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 20:08:07,461 - scn_phase_space_process - INFO - 数据维度: 10 个细胞, 10 个时间线
2025-05-23 20:08:07,462 - scn_phase_space_process - INFO - 开始处理钙信号数据...
2025-05-23 20:08:12,065 - scn_phase_space_process - INFO - ✓ 相空间重构完成
2025-05-23 20:08:12,066 - scn_phase_space_process - INFO - 
步骤3: 数据裁剪
2025-05-23 20:08:12,066 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 20:08:12,066 - scn_phase_space_process - INFO - 开始裁剪数据到统一长度: 170
2025-05-23 20:08:12,066 - scn_phase_space_process - INFO - ✓ 数据裁剪完成
2025-05-23 20:08:12,066 - scn_phase_space_process - INFO - 
步骤4: 构建图数据集
2025-05-23 20:08:12,067 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 20:08:12,067 - scn_phase_space_process - INFO - 有效样本数量: 100
2025-05-23 20:08:12,067 - scn_phase_space_process - INFO - 生成 nodes.csv 文件...
2025-05-23 20:08:12,068 - scn_phase_space_process - INFO - 转换节点特征格式...
2025-05-23 20:08:12,144 - scn_phase_space_process - INFO - ✓ nodes.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\nodes.csv
2025-05-23 20:08:12,145 - scn_phase_space_process - INFO - 生成 edges.csv 文件...
2025-05-23 20:08:12,156 - scn_phase_space_process - INFO - ✓ edges.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\edges.csv
2025-05-23 20:08:12,156 - scn_phase_space_process - INFO - 生成 graphs.csv 文件...
2025-05-23 20:08:12,158 - scn_phase_space_process - INFO - 标签分布: {np.int64(0): np.int64(14), np.int64(1): np.int64(15), np.int64(2): np.int64(18), np.int64(3): np.int64(20), np.int64(4): np.int64(17), np.int64(5): np.int64(16)}
2025-05-23 20:08:12,160 - scn_phase_space_process - INFO - ✓ graphs.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\graphs.csv
2025-05-23 20:08:12,160 - scn_phase_space_process - INFO - 
============================================================
2025-05-23 20:08:12,160 - scn_phase_space_process - INFO - 数据处理流程全部完成!
2025-05-23 20:08:12,160 - scn_phase_space_process - INFO - ============================================================
2025-05-23 20:08:12,160 - scn_phase_space_process - INFO - 数据源信息:
2025-05-23 20:08:12,161 - scn_phase_space_process - INFO -   - 文件: datasets/EMtrace01.xlsx
2025-05-23 20:08:12,161 - scn_phase_space_process - INFO -   - 格式: Excel
2025-05-23 20:08:12,161 - scn_phase_space_process - INFO -   - 处理器: ExcelCalciumDataProcessor
2025-05-23 20:08:12,162 - scn_phase_space_process - INFO - 
生成的文件:
2025-05-23 20:08:12,162 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/nodes.csv
2025-05-23 20:08:12,162 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/edges.csv
2025-05-23 20:08:12,162 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/graphs.csv
2025-05-23 20:08:12,163 - scn_phase_space_process - INFO - 
处理结果:
2025-05-23 20:08:12,163 - scn_phase_space_process - INFO -   - 总样本数量: 100
2025-05-23 20:08:12,163 - scn_phase_space_process - INFO -   - 轨迹长度: 170
2025-05-23 20:08:12,163 - scn_phase_space_process - INFO -   - 嵌入维度: 3
2025-05-23 20:08:12,163 - scn_phase_space_process - INFO - 
下一步操作:
2025-05-23 20:08:12,164 - scn_phase_space_process - INFO -   1. 检查生成的CSV文件质量
2025-05-23 20:08:12,164 - scn_phase_space_process - INFO -   2. 运行训练: python main.py 或 python run.py --train
2025-05-23 20:08:12,165 - scn_phase_space_process - INFO -   3. 查看训练结果: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results
2025-05-23 20:08:12,166 - __main__ - INFO - ✓ 数据处理完成
2025-05-23 20:08:12,166 - __main__ - INFO - 操作成功完成
2025-05-23 20:11:21,528 - __main__ - INFO - ============================================================
2025-05-23 20:11:21,528 - __main__ - INFO - 开始模型训练流程
2025-05-23 20:11:21,528 - __main__ - INFO - ============================================================
2025-05-23 20:11:34,467 - main - INFO - ============================================================
2025-05-23 20:11:34,467 - main - INFO - 脑网络状态分类器训练程序启动
2025-05-23 20:11:34,467 - main - INFO - ============================================================
2025-05-23 20:11:34,469 - main - INFO - ✓ 随机种子设置完成
2025-05-23 20:11:34,472 - main - INFO - ✓ 使用GPU: NVIDIA GeForce RTX 4060
2025-05-23 20:11:34,472 - main - INFO - 加载数据集...
2025-05-23 20:11:34,526 - main - INFO - ✓ 数据集加载成功
2025-05-23 20:11:34,527 - main - INFO -   - 训练集批次数: 240
2025-05-23 20:11:34,527 - main - INFO -   - 验证集批次数: 20
2025-05-23 20:11:34,527 - main - INFO -   - 测试集批次数: 19
2025-05-23 20:11:34,648 - main - INFO - ✓ 模型创建成功
2025-05-23 20:11:34,649 - main - INFO - 模型架构:
MultiLayerGCN(
  (conv0): GCNConv(3, 32)
  (conv1): GCNConv(32, 32)
  (conv2): GCNConv(32, 32)
  (pool): GlobalPooling(
    (max_pool): AdaptiveMaxPool1d(output_size=1)
    (avg_pool): AdaptiveAvgPool1d(output_size=1)
  )
  (classifier): Sequential(
    (fc0): Linear(in_features=192, out_features=16, bias=False)
    (relu0): LeakyReLU(negative_slope=0.2)
    (drop0): Dropout(p=0.5, inplace=False)
    (fc2): Linear(in_features=16, out_features=6, bias=True)
  )
)
2025-05-23 20:11:34,650 - main - INFO - 模型参数总数: 5,414
2025-05-23 20:11:34,650 - main - INFO - 可训练参数: 5,414
2025-05-23 20:11:34,650 - main - INFO - 
开始模型训练...
2025-05-23 20:11:34,651 - main - INFO - 开始训练，总共 160 个epoch
2025-05-23 20:11:36,300 - main - INFO - Epoch 1 平均损失: 1.8034
2025-05-23 20:11:36,370 - main - INFO - Epoch 1/160 - 训练损失: 1.8034, 验证准确率: 0.3500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:11:37,498 - main - INFO - Epoch 2 平均损失: 1.7931
2025-05-23 20:11:37,554 - main - INFO - Epoch 2/160 - 训练损失: 1.7931, 验证准确率: 0.3000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:11:38,711 - main - INFO - Epoch 3 平均损失: 1.8045
2025-05-23 20:11:38,765 - main - INFO - Epoch 3/160 - 训练损失: 1.8045, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:11:39,966 - main - INFO - Epoch 4 平均损失: 1.7776
2025-05-23 20:11:40,022 - main - INFO - Epoch 4/160 - 训练损失: 1.7776, 验证准确率: 0.3000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:11:41,126 - main - INFO - Epoch 5 平均损失: 1.7617
2025-05-23 20:11:41,180 - main - INFO - Epoch 5/160 - 训练损失: 1.7617, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:11:42,376 - main - INFO - Epoch 6 平均损失: 1.7692
2025-05-23 20:11:42,434 - main - INFO - Epoch 6/160 - 训练损失: 1.7692, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:11:43,514 - main - INFO - Epoch 7 平均损失: 1.7601
2025-05-23 20:11:43,571 - main - INFO - Epoch 7/160 - 训练损失: 1.7601, 验证准确率: 0.3000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:11:44,513 - main - INFO - Epoch 8 平均损失: 1.7369
2025-05-23 20:11:44,568 - main - INFO - Epoch 8/160 - 训练损失: 1.7369, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:11:45,570 - main - INFO - Epoch 9 平均损失: 1.7436
2025-05-23 20:11:45,635 - main - INFO - Epoch 9/160 - 训练损失: 1.7436, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:11:46,753 - main - INFO - Epoch 10 平均损失: 1.7220
2025-05-23 20:11:46,817 - main - INFO - Epoch 10/160 - 训练损失: 1.7220, 验证准确率: 0.0000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:11:48,244 - main - INFO - Epoch 11 平均损失: 1.7015
2025-05-23 20:11:48,314 - main - INFO - Epoch 11/160 - 训练损失: 1.7015, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:11:49,527 - main - INFO - Epoch 12 平均损失: 1.7111
2025-05-23 20:11:49,575 - main - INFO - Epoch 12/160 - 训练损失: 1.7111, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:11:50,595 - main - INFO - Epoch 13 平均损失: 1.7085
2025-05-23 20:11:50,649 - main - INFO - Epoch 13/160 - 训练损失: 1.7085, 验证准确率: 0.0000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:11:51,763 - main - INFO - Epoch 14 平均损失: 1.7022
2025-05-23 20:11:51,829 - main - INFO - Epoch 14/160 - 训练损失: 1.7022, 验证准确率: 0.0500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:11:52,964 - main - INFO - Epoch 15 平均损失: 1.6723
2025-05-23 20:11:53,030 - main - INFO - Epoch 15/160 - 训练损失: 1.6723, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:11:54,127 - main - INFO - Epoch 16 平均损失: 1.6644
2025-05-23 20:11:54,200 - main - INFO - Epoch 16/160 - 训练损失: 1.6644, 验证准确率: 0.0500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:11:55,265 - main - INFO - Epoch 17 平均损失: 1.6432
2025-05-23 20:11:55,323 - main - INFO - Epoch 17/160 - 训练损失: 1.6432, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:11:56,553 - main - INFO - Epoch 18 平均损失: 1.6602
2025-05-23 20:11:56,623 - main - INFO - Epoch 18/160 - 训练损失: 1.6602, 验证准确率: 0.0500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:11:58,042 - main - INFO - Epoch 19 平均损失: 1.6385
2025-05-23 20:11:58,124 - main - INFO - Epoch 19/160 - 训练损失: 1.6385, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:11:59,611 - main - INFO - Epoch 20 平均损失: 1.6472
2025-05-23 20:11:59,700 - main - INFO - Epoch 20/160 - 训练损失: 1.6472, 验证准确率: 0.2500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:11:59,701 - main - INFO - 学习率衰减至: 0.000750
2025-05-23 20:12:01,553 - main - INFO - Epoch 21 平均损失: 1.5749
2025-05-23 20:12:01,616 - main - INFO - Epoch 21/160 - 训练损失: 1.5749, 验证准确率: 0.2500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:02,952 - main - INFO - Epoch 22 平均损失: 1.5450
2025-05-23 20:12:03,076 - main - INFO - Epoch 22/160 - 训练损失: 1.5450, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:04,156 - main - INFO - Epoch 23 平均损失: 1.5803
2025-05-23 20:12:04,215 - main - INFO - Epoch 23/160 - 训练损失: 1.5803, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:05,431 - main - INFO - Epoch 24 平均损失: 1.5770
2025-05-23 20:12:05,483 - main - INFO - Epoch 24/160 - 训练损失: 1.5770, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:06,640 - main - INFO - Epoch 25 平均损失: 1.5521
2025-05-23 20:12:06,722 - main - INFO - Epoch 25/160 - 训练损失: 1.5521, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:07,922 - main - INFO - Epoch 26 平均损失: 1.5211
2025-05-23 20:12:07,984 - main - INFO - Epoch 26/160 - 训练损失: 1.5211, 验证准确率: 0.0000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:09,118 - main - INFO - Epoch 27 平均损失: 1.5190
2025-05-23 20:12:09,190 - main - INFO - Epoch 27/160 - 训练损失: 1.5190, 验证准确率: 0.0000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:10,403 - main - INFO - Epoch 28 平均损失: 1.5106
2025-05-23 20:12:10,461 - main - INFO - Epoch 28/160 - 训练损失: 1.5106, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:11,693 - main - INFO - Epoch 29 平均损失: 1.4798
2025-05-23 20:12:11,760 - main - INFO - Epoch 29/160 - 训练损失: 1.4798, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:12,902 - main - INFO - Epoch 30 平均损失: 1.5262
2025-05-23 20:12:12,973 - main - INFO - Epoch 30/160 - 训练损失: 1.5262, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:14,026 - main - INFO - Epoch 31 平均损失: 1.5349
2025-05-23 20:12:14,086 - main - INFO - Epoch 31/160 - 训练损失: 1.5349, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:15,178 - main - INFO - Epoch 32 平均损失: 1.4814
2025-05-23 20:12:15,247 - main - INFO - Epoch 32/160 - 训练损失: 1.4814, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:16,338 - main - INFO - Epoch 33 平均损失: 1.4738
2025-05-23 20:12:16,403 - main - INFO - Epoch 33/160 - 训练损失: 1.4738, 验证准确率: 0.0000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:17,593 - main - INFO - Epoch 34 平均损失: 1.4991
2025-05-23 20:12:17,652 - main - INFO - Epoch 34/160 - 训练损失: 1.4991, 验证准确率: 0.0500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:18,827 - main - INFO - Epoch 35 平均损失: 1.4406
2025-05-23 20:12:18,901 - main - INFO - Epoch 35/160 - 训练损失: 1.4406, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:20,240 - main - INFO - Epoch 36 平均损失: 1.4653
2025-05-23 20:12:20,297 - main - INFO - Epoch 36/160 - 训练损失: 1.4653, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:21,422 - main - INFO - Epoch 37 平均损失: 1.4520
2025-05-23 20:12:21,484 - main - INFO - Epoch 37/160 - 训练损失: 1.4520, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:22,555 - main - INFO - Epoch 38 平均损失: 1.4825
2025-05-23 20:12:22,625 - main - INFO - Epoch 38/160 - 训练损失: 1.4825, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:23,782 - main - INFO - Epoch 39 平均损失: 1.4040
2025-05-23 20:12:23,863 - main - INFO - Epoch 39/160 - 训练损失: 1.4040, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:25,044 - main - INFO - Epoch 40 平均损失: 1.4054
2025-05-23 20:12:25,111 - main - INFO - Epoch 40/160 - 训练损失: 1.4054, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:25,111 - main - INFO - 学习率衰减至: 0.000563
2025-05-23 20:12:26,320 - main - INFO - Epoch 41 平均损失: 1.3852
2025-05-23 20:12:26,382 - main - INFO - Epoch 41/160 - 训练损失: 1.3852, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:27,535 - main - INFO - Epoch 42 平均损失: 1.4006
2025-05-23 20:12:27,600 - main - INFO - Epoch 42/160 - 训练损失: 1.4006, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:28,816 - main - INFO - Epoch 43 平均损失: 1.4127
2025-05-23 20:12:28,876 - main - INFO - Epoch 43/160 - 训练损失: 1.4127, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:30,210 - main - INFO - Epoch 44 平均损失: 1.3745
2025-05-23 20:12:30,303 - main - INFO - Epoch 44/160 - 训练损失: 1.3745, 验证准确率: 0.2500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:31,381 - main - INFO - Epoch 45 平均损失: 1.3693
2025-05-23 20:12:31,445 - main - INFO - Epoch 45/160 - 训练损失: 1.3693, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:32,558 - main - INFO - Epoch 46 平均损失: 1.4087
2025-05-23 20:12:32,624 - main - INFO - Epoch 46/160 - 训练损失: 1.4087, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:33,651 - main - INFO - Epoch 47 平均损失: 1.4172
2025-05-23 20:12:33,734 - main - INFO - Epoch 47/160 - 训练损失: 1.4172, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:34,846 - main - INFO - Epoch 48 平均损失: 1.3352
2025-05-23 20:12:34,906 - main - INFO - Epoch 48/160 - 训练损失: 1.3352, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:36,004 - main - INFO - Epoch 49 平均损失: 1.3579
2025-05-23 20:12:36,065 - main - INFO - Epoch 49/160 - 训练损失: 1.3579, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:37,131 - main - INFO - Epoch 50 平均损失: 1.3309
2025-05-23 20:12:37,196 - main - INFO - Epoch 50/160 - 训练损失: 1.3309, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:38,381 - main - INFO - Epoch 51 平均损失: 1.3321
2025-05-23 20:12:38,440 - main - INFO - Epoch 51/160 - 训练损失: 1.3321, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:39,587 - main - INFO - Epoch 52 平均损失: 1.2944
2025-05-23 20:12:39,653 - main - INFO - Epoch 52/160 - 训练损失: 1.2944, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:40,812 - main - INFO - Epoch 53 平均损失: 1.3670
2025-05-23 20:12:40,888 - main - INFO - Epoch 53/160 - 训练损失: 1.3670, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:41,950 - main - INFO - Epoch 54 平均损失: 1.3107
2025-05-23 20:12:42,010 - main - INFO - Epoch 54/160 - 训练损失: 1.3107, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:43,072 - main - INFO - Epoch 55 平均损失: 1.2471
2025-05-23 20:12:43,136 - main - INFO - Epoch 55/160 - 训练损失: 1.2471, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:44,175 - main - INFO - Epoch 56 平均损失: 1.3113
2025-05-23 20:12:44,232 - main - INFO - Epoch 56/160 - 训练损失: 1.3113, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:45,250 - main - INFO - Epoch 57 平均损失: 1.2900
2025-05-23 20:12:45,312 - main - INFO - Epoch 57/160 - 训练损失: 1.2900, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:46,478 - main - INFO - Epoch 58 平均损失: 1.2758
2025-05-23 20:12:46,541 - main - INFO - Epoch 58/160 - 训练损失: 1.2758, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:47,700 - main - INFO - Epoch 59 平均损失: 1.1780
2025-05-23 20:12:47,765 - main - INFO - Epoch 59/160 - 训练损失: 1.1780, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:48,910 - main - INFO - Epoch 60 平均损失: 1.2639
2025-05-23 20:12:48,994 - main - INFO - Epoch 60/160 - 训练损失: 1.2639, 验证准确率: 0.2500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:48,994 - main - INFO - 学习率衰减至: 0.000422
2025-05-23 20:12:50,376 - main - INFO - Epoch 61 平均损失: 1.2248
2025-05-23 20:12:50,454 - main - INFO - Epoch 61/160 - 训练损失: 1.2248, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:51,796 - main - INFO - Epoch 62 平均损失: 1.2091
2025-05-23 20:12:51,860 - main - INFO - Epoch 62/160 - 训练损失: 1.2091, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:53,074 - main - INFO - Epoch 63 平均损失: 1.2514
2025-05-23 20:12:53,146 - main - INFO - Epoch 63/160 - 训练损失: 1.2514, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:54,318 - main - INFO - Epoch 64 平均损失: 1.2273
2025-05-23 20:12:54,392 - main - INFO - Epoch 64/160 - 训练损失: 1.2273, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:55,702 - main - INFO - Epoch 65 平均损失: 1.2247
2025-05-23 20:12:55,769 - main - INFO - Epoch 65/160 - 训练损失: 1.2247, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:56,927 - main - INFO - Epoch 66 平均损失: 1.2269
2025-05-23 20:12:56,993 - main - INFO - Epoch 66/160 - 训练损失: 1.2269, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:58,071 - main - INFO - Epoch 67 平均损失: 1.2338
2025-05-23 20:12:58,144 - main - INFO - Epoch 67/160 - 训练损失: 1.2338, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:12:59,351 - main - INFO - Epoch 68 平均损失: 1.2124
2025-05-23 20:12:59,420 - main - INFO - Epoch 68/160 - 训练损失: 1.2124, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:00,609 - main - INFO - Epoch 69 平均损失: 1.1821
2025-05-23 20:13:00,689 - main - INFO - Epoch 69/160 - 训练损失: 1.1821, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:01,788 - main - INFO - Epoch 70 平均损失: 1.2045
2025-05-23 20:13:01,858 - main - INFO - Epoch 70/160 - 训练损失: 1.2045, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:03,010 - main - INFO - Epoch 71 平均损失: 1.1820
2025-05-23 20:13:03,082 - main - INFO - Epoch 71/160 - 训练损失: 1.1820, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:04,363 - main - INFO - Epoch 72 平均损失: 1.2004
2025-05-23 20:13:04,427 - main - INFO - Epoch 72/160 - 训练损失: 1.2004, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:05,589 - main - INFO - Epoch 73 平均损失: 1.1673
2025-05-23 20:13:05,653 - main - INFO - Epoch 73/160 - 训练损失: 1.1673, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:06,734 - main - INFO - Epoch 74 平均损失: 1.2613
2025-05-23 20:13:06,793 - main - INFO - Epoch 74/160 - 训练损失: 1.2613, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:07,899 - main - INFO - Epoch 75 平均损失: 1.1926
2025-05-23 20:13:07,963 - main - INFO - Epoch 75/160 - 训练损失: 1.1926, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:08,994 - main - INFO - Epoch 76 平均损失: 1.1630
2025-05-23 20:13:09,049 - main - INFO - Epoch 76/160 - 训练损失: 1.1630, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:10,006 - main - INFO - Epoch 77 平均损失: 1.1438
2025-05-23 20:13:10,056 - main - INFO - Epoch 77/160 - 训练损失: 1.1438, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:11,026 - main - INFO - Epoch 78 平均损失: 1.2688
2025-05-23 20:13:11,073 - main - INFO - Epoch 78/160 - 训练损失: 1.2688, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:12,047 - main - INFO - Epoch 79 平均损失: 1.1317
2025-05-23 20:13:12,098 - main - INFO - Epoch 79/160 - 训练损失: 1.1317, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:13,081 - main - INFO - Epoch 80 平均损失: 1.2151
2025-05-23 20:13:13,144 - main - INFO - Epoch 80/160 - 训练损失: 1.2151, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:13,144 - main - INFO - 学习率衰减至: 0.000316
2025-05-23 20:13:14,382 - main - INFO - Epoch 81 平均损失: 1.1034
2025-05-23 20:13:14,452 - main - INFO - Epoch 81/160 - 训练损失: 1.1034, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:15,489 - main - INFO - Epoch 82 平均损失: 1.1475
2025-05-23 20:13:15,544 - main - INFO - Epoch 82/160 - 训练损失: 1.1475, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:16,857 - main - INFO - Epoch 83 平均损失: 1.1624
2025-05-23 20:13:16,948 - main - INFO - Epoch 83/160 - 训练损失: 1.1624, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:18,292 - main - INFO - Epoch 84 平均损失: 1.1842
2025-05-23 20:13:18,367 - main - INFO - Epoch 84/160 - 训练损失: 1.1842, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:19,618 - main - INFO - Epoch 85 平均损失: 1.0591
2025-05-23 20:13:20,063 - main - INFO - Epoch 85/160 - 训练损失: 1.0591, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:21,444 - main - INFO - Epoch 86 平均损失: 1.1574
2025-05-23 20:13:21,508 - main - INFO - Epoch 86/160 - 训练损失: 1.1574, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:22,777 - main - INFO - Epoch 87 平均损失: 1.1424
2025-05-23 20:13:22,845 - main - INFO - Epoch 87/160 - 训练损失: 1.1424, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:24,076 - main - INFO - Epoch 88 平均损失: 1.1157
2025-05-23 20:13:24,148 - main - INFO - Epoch 88/160 - 训练损失: 1.1157, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:25,399 - main - INFO - Epoch 89 平均损失: 1.1394
2025-05-23 20:13:25,657 - main - INFO - Epoch 89/160 - 训练损失: 1.1394, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:26,944 - main - INFO - Epoch 90 平均损失: 1.0103
2025-05-23 20:13:27,021 - main - INFO - Epoch 90/160 - 训练损失: 1.0103, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:28,257 - main - INFO - Epoch 91 平均损失: 1.0807
2025-05-23 20:13:28,357 - main - INFO - Epoch 91/160 - 训练损失: 1.0807, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:29,574 - main - INFO - Epoch 92 平均损失: 1.0970
2025-05-23 20:13:29,641 - main - INFO - Epoch 92/160 - 训练损失: 1.0970, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:30,860 - main - INFO - Epoch 93 平均损失: 1.0840
2025-05-23 20:13:30,917 - main - INFO - Epoch 93/160 - 训练损失: 1.0840, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:32,109 - main - INFO - Epoch 94 平均损失: 1.0643
2025-05-23 20:13:32,444 - main - INFO - Epoch 94/160 - 训练损失: 1.0643, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:33,639 - main - INFO - Epoch 95 平均损失: 1.1565
2025-05-23 20:13:33,714 - main - INFO - Epoch 95/160 - 训练损失: 1.1565, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:34,855 - main - INFO - Epoch 96 平均损失: 1.0366
2025-05-23 20:13:34,912 - main - INFO - Epoch 96/160 - 训练损失: 1.0366, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:36,395 - main - INFO - Epoch 97 平均损失: 1.0637
2025-05-23 20:13:36,464 - main - INFO - Epoch 97/160 - 训练损失: 1.0637, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:38,023 - main - INFO - Epoch 98 平均损失: 1.1032
2025-05-23 20:13:38,088 - main - INFO - Epoch 98/160 - 训练损失: 1.1032, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:39,486 - main - INFO - Epoch 99 平均损失: 1.1143
2025-05-23 20:13:39,548 - main - INFO - Epoch 99/160 - 训练损失: 1.1143, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:40,874 - main - INFO - Epoch 100 平均损失: 1.0359
2025-05-23 20:13:40,942 - main - INFO - Epoch 100/160 - 训练损失: 1.0359, 验证准确率: 0.2500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:40,942 - main - INFO - 学习率衰减至: 0.000237
2025-05-23 20:13:42,434 - main - INFO - Epoch 101 平均损失: 1.1156
2025-05-23 20:13:42,515 - main - INFO - Epoch 101/160 - 训练损失: 1.1156, 验证准确率: 0.2500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:43,972 - main - INFO - Epoch 102 平均损失: 1.0918
2025-05-23 20:13:44,226 - main - INFO - Epoch 102/160 - 训练损失: 1.0918, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:45,658 - main - INFO - Epoch 103 平均损失: 0.9760
2025-05-23 20:13:45,723 - main - INFO - Epoch 103/160 - 训练损失: 0.9760, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:47,206 - main - INFO - Epoch 104 平均损失: 1.0187
2025-05-23 20:13:47,299 - main - INFO - Epoch 104/160 - 训练损失: 1.0187, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:48,729 - main - INFO - Epoch 105 平均损失: 1.0202
2025-05-23 20:13:48,794 - main - INFO - Epoch 105/160 - 训练损失: 1.0202, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:50,094 - main - INFO - Epoch 106 平均损失: 0.9963
2025-05-23 20:13:50,160 - main - INFO - Epoch 106/160 - 训练损失: 0.9963, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:51,426 - main - INFO - Epoch 107 平均损失: 1.0362
2025-05-23 20:13:51,492 - main - INFO - Epoch 107/160 - 训练损失: 1.0362, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:52,532 - main - INFO - Epoch 108 平均损失: 1.0410
2025-05-23 20:13:52,593 - main - INFO - Epoch 108/160 - 训练损失: 1.0410, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:53,561 - main - INFO - Epoch 109 平均损失: 1.1046
2025-05-23 20:13:53,628 - main - INFO - Epoch 109/160 - 训练损失: 1.1046, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:54,670 - main - INFO - Epoch 110 平均损失: 0.9900
2025-05-23 20:13:54,744 - main - INFO - Epoch 110/160 - 训练损失: 0.9900, 验证准确率: 0.2500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:55,730 - main - INFO - Epoch 111 平均损失: 0.9942
2025-05-23 20:13:55,797 - main - INFO - Epoch 111/160 - 训练损失: 0.9942, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:57,019 - main - INFO - Epoch 112 平均损失: 0.9369
2025-05-23 20:13:57,154 - main - INFO - Epoch 112/160 - 训练损失: 0.9369, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:58,484 - main - INFO - Epoch 113 平均损失: 0.9537
2025-05-23 20:13:58,550 - main - INFO - Epoch 113/160 - 训练损失: 0.9537, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:13:59,644 - main - INFO - Epoch 114 平均损失: 1.0122
2025-05-23 20:13:59,734 - main - INFO - Epoch 114/160 - 训练损失: 1.0122, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:14:01,314 - main - INFO - Epoch 115 平均损失: 1.0334
2025-05-23 20:14:01,371 - main - INFO - Epoch 115/160 - 训练损失: 1.0334, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:14:02,469 - main - INFO - Epoch 116 平均损失: 1.0505
2025-05-23 20:14:02,526 - main - INFO - Epoch 116/160 - 训练损失: 1.0505, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:14:03,662 - main - INFO - Epoch 117 平均损失: 1.0103
2025-05-23 20:14:03,723 - main - INFO - Epoch 117/160 - 训练损失: 1.0103, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:14:05,174 - main - INFO - Epoch 118 平均损失: 1.0209
2025-05-23 20:14:05,237 - main - INFO - Epoch 118/160 - 训练损失: 1.0209, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:14:06,562 - main - INFO - Epoch 119 平均损失: 1.0406
2025-05-23 20:14:06,631 - main - INFO - Epoch 119/160 - 训练损失: 1.0406, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:14:08,040 - main - INFO - Epoch 120 平均损失: 0.9964
2025-05-23 20:14:08,111 - main - INFO - Epoch 120/160 - 训练损失: 0.9964, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:14:08,111 - main - INFO - 学习率衰减至: 0.000178
2025-05-23 20:14:09,787 - main - INFO - Epoch 121 平均损失: 1.0618
2025-05-23 20:14:09,880 - main - INFO - Epoch 121/160 - 训练损失: 1.0618, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:14:11,569 - main - INFO - Epoch 122 平均损失: 0.9856
2025-05-23 20:14:11,641 - main - INFO - Epoch 122/160 - 训练损失: 0.9856, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:14:13,352 - main - INFO - Epoch 123 平均损失: 0.9762
2025-05-23 20:14:13,447 - main - INFO - Epoch 123/160 - 训练损失: 0.9762, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:14:15,064 - main - INFO - Epoch 124 平均损失: 1.0236
2025-05-23 20:14:15,133 - main - INFO - Epoch 124/160 - 训练损失: 1.0236, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:14:16,540 - main - INFO - Epoch 125 平均损失: 0.9117
2025-05-23 20:14:16,608 - main - INFO - Epoch 125/160 - 训练损失: 0.9117, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:14:17,807 - main - INFO - Epoch 126 平均损失: 0.8997
2025-05-23 20:14:17,862 - main - INFO - Epoch 126/160 - 训练损失: 0.8997, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:14:19,082 - main - INFO - Epoch 127 平均损失: 0.9892
2025-05-23 20:14:19,541 - main - INFO - Epoch 127/160 - 训练损失: 0.9892, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:14:20,696 - main - INFO - Epoch 128 平均损失: 0.8992
2025-05-23 20:14:20,775 - main - INFO - Epoch 128/160 - 训练损失: 0.8992, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:14:21,961 - main - INFO - Epoch 129 平均损失: 1.0091
2025-05-23 20:14:22,015 - main - INFO - Epoch 129/160 - 训练损失: 1.0091, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:14:23,146 - main - INFO - Epoch 130 平均损失: 0.9402
2025-05-23 20:14:23,197 - main - INFO - Epoch 130/160 - 训练损失: 0.9402, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:14:24,383 - main - INFO - Epoch 131 平均损失: 0.9928
2025-05-23 20:14:24,434 - main - INFO - Epoch 131/160 - 训练损失: 0.9928, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:14:26,171 - main - INFO - Epoch 132 平均损失: 0.9682
2025-05-23 20:14:26,271 - main - INFO - Epoch 132/160 - 训练损失: 0.9682, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:14:28,078 - main - INFO - Epoch 133 平均损失: 0.8633
2025-05-23 20:14:28,167 - main - INFO - Epoch 133/160 - 训练损失: 0.8633, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:14:29,946 - main - INFO - Epoch 134 平均损失: 1.0251
2025-05-23 20:14:30,046 - main - INFO - Epoch 134/160 - 训练损失: 1.0251, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:14:32,082 - main - INFO - Epoch 135 平均损失: 0.9267
2025-05-23 20:14:32,182 - main - INFO - Epoch 135/160 - 训练损失: 0.9267, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:14:34,143 - main - INFO - Epoch 136 平均损失: 0.9357
2025-05-23 20:14:34,233 - main - INFO - Epoch 136/160 - 训练损失: 0.9357, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:14:36,150 - main - INFO - Epoch 137 平均损失: 1.0202
2025-05-23 20:14:36,258 - main - INFO - Epoch 137/160 - 训练损失: 1.0202, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:14:38,114 - main - INFO - Epoch 138 平均损失: 0.9573
2025-05-23 20:14:38,199 - main - INFO - Epoch 138/160 - 训练损失: 0.9573, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:14:40,077 - main - INFO - Epoch 139 平均损失: 0.9282
2025-05-23 20:14:40,176 - main - INFO - Epoch 139/160 - 训练损失: 0.9282, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:14:41,979 - main - INFO - Epoch 140 平均损失: 0.9294
2025-05-23 20:14:42,070 - main - INFO - Epoch 140/160 - 训练损失: 0.9294, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:14:42,070 - main - INFO - 学习率衰减至: 0.000133
2025-05-23 20:14:44,057 - main - INFO - Epoch 141 平均损失: 0.9189
2025-05-23 20:14:44,141 - main - INFO - Epoch 141/160 - 训练损失: 0.9189, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:14:45,937 - main - INFO - Epoch 142 平均损失: 0.8633
2025-05-23 20:14:46,043 - main - INFO - Epoch 142/160 - 训练损失: 0.8633, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:14:47,653 - main - INFO - Epoch 143 平均损失: 0.8860
2025-05-23 20:14:47,726 - main - INFO - Epoch 143/160 - 训练损失: 0.8860, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:14:49,242 - main - INFO - Epoch 144 平均损失: 0.8845
2025-05-23 20:14:49,320 - main - INFO - Epoch 144/160 - 训练损失: 0.8845, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:14:51,028 - main - INFO - Epoch 145 平均损失: 0.9325
2025-05-23 20:14:51,113 - main - INFO - Epoch 145/160 - 训练损失: 0.9325, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:14:52,504 - main - INFO - Epoch 146 平均损失: 0.9390
2025-05-23 20:14:52,584 - main - INFO - Epoch 146/160 - 训练损失: 0.9390, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:14:54,012 - main - INFO - Epoch 147 平均损失: 0.9629
2025-05-23 20:14:54,079 - main - INFO - Epoch 147/160 - 训练损失: 0.9629, 验证准确率: 0.2500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:14:55,557 - main - INFO - Epoch 148 平均损失: 1.0508
2025-05-23 20:14:55,623 - main - INFO - Epoch 148/160 - 训练损失: 1.0508, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:14:56,861 - main - INFO - Epoch 149 平均损失: 0.9636
2025-05-23 20:14:56,934 - main - INFO - Epoch 149/160 - 训练损失: 0.9636, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:14:58,424 - main - INFO - Epoch 150 平均损失: 0.9503
2025-05-23 20:14:58,486 - main - INFO - Epoch 150/160 - 训练损失: 0.9503, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:14:59,835 - main - INFO - Epoch 151 平均损失: 0.9215
2025-05-23 20:14:59,898 - main - INFO - Epoch 151/160 - 训练损失: 0.9215, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:15:01,472 - main - INFO - Epoch 152 平均损失: 0.8905
2025-05-23 20:15:01,536 - main - INFO - Epoch 152/160 - 训练损失: 0.8905, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:15:02,841 - main - INFO - Epoch 153 平均损失: 0.9123
2025-05-23 20:15:02,898 - main - INFO - Epoch 153/160 - 训练损失: 0.9123, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:15:04,173 - main - INFO - Epoch 154 平均损失: 0.8817
2025-05-23 20:15:04,224 - main - INFO - Epoch 154/160 - 训练损失: 0.8817, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:15:05,334 - main - INFO - Epoch 155 平均损失: 0.8855
2025-05-23 20:15:05,400 - main - INFO - Epoch 155/160 - 训练损失: 0.8855, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:15:06,636 - main - INFO - Epoch 156 平均损失: 0.8182
2025-05-23 20:15:06,700 - main - INFO - Epoch 156/160 - 训练损失: 0.8182, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:15:07,916 - main - INFO - Epoch 157 平均损失: 0.9173
2025-05-23 20:15:07,996 - main - INFO - Epoch 157/160 - 训练损失: 0.9173, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:15:09,066 - main - INFO - Epoch 158 平均损失: 0.8557
2025-05-23 20:15:09,121 - main - INFO - Epoch 158/160 - 训练损失: 0.8557, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:15:10,418 - main - INFO - Epoch 159 平均损失: 0.9427
2025-05-23 20:15:10,485 - main - INFO - Epoch 159/160 - 训练损失: 0.9427, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:15:11,752 - main - INFO - Epoch 160 平均损失: 0.8808
2025-05-23 20:15:11,816 - main - INFO - Epoch 160/160 - 训练损失: 0.8808, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:15:11,820 - main - INFO - 最佳模型已保存至: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results\best_scn.pt
2025-05-23 20:15:11,821 - main - INFO - 
在测试集上评估最终性能...
2025-05-23 20:15:11,882 - main - INFO - ============================================================
2025-05-23 20:15:11,882 - main - INFO - 最终测试结果:
2025-05-23 20:15:11,883 - main - INFO -   测试损失: 3.4513
2025-05-23 20:15:11,883 - main - INFO -   测试准确率: 0.1053
2025-05-23 20:15:11,883 - main - INFO -   平均类别准确率: 0.2083
2025-05-23 20:15:11,883 - main - INFO - ============================================================
2025-05-23 20:15:11,883 - __main__ - INFO - ✓ 模型训练完成
2025-05-23 20:15:11,883 - __main__ - INFO - 最终测试准确率: 0.1053
2025-05-23 20:15:11,884 - __main__ - INFO - 平均类别准确率: 0.2083
2025-05-23 20:15:11,884 - __main__ - INFO - 操作成功完成
2025-05-23 20:30:08,804 - __main__ - INFO - ============================================================
2025-05-23 20:30:08,804 - __main__ - INFO - 测试核心模块
2025-05-23 20:30:08,804 - __main__ - INFO - ============================================================
2025-05-23 20:30:09,312 - __main__ - ERROR - ✗ 核心模块测试失败
2025-05-23 20:30:09,312 - __main__ - ERROR - 操作失败
2025-05-23 20:31:51,497 - __main__ - INFO - ============================================================
2025-05-23 20:31:51,497 - __main__ - INFO - 当前配置参数
2025-05-23 20:31:51,497 - __main__ - INFO - ============================================================
2025-05-23 20:31:51,497 - __main__ - INFO - 
数据处理配置:
2025-05-23 20:31:51,497 - __main__ - INFO -   帧率: 0.67 Hz
2025-05-23 20:31:51,497 - __main__ - INFO -   嵌入维度: 3
2025-05-23 20:31:51,497 - __main__ - INFO -   轨迹长度: 170
2025-05-23 20:31:51,497 - __main__ - INFO -   最大处理细胞数: 10
2025-05-23 20:31:51,497 - __main__ - INFO - 
模型配置:
2025-05-23 20:31:51,498 - __main__ - INFO -   隐藏层维度: 32
2025-05-23 20:31:51,498 - __main__ - INFO -   GCN层数: 3
2025-05-23 20:31:51,498 - __main__ - INFO -   分类类别数: 6
2025-05-23 20:31:51,498 - __main__ - INFO -   Dropout率: 0.5
2025-05-23 20:31:51,498 - __main__ - INFO - 
训练配置:
2025-05-23 20:31:51,498 - __main__ - INFO -   训练轮数: 160
2025-05-23 20:31:51,498 - __main__ - INFO -   学习率: 0.001
2025-05-23 20:31:51,498 - __main__ - INFO -   批次大小: 1
2025-05-23 20:31:51,498 - __main__ - INFO -   计算设备: cuda
2025-05-23 20:31:51,498 - __main__ - INFO - 
文件路径:
2025-05-23 20:31:51,498 - __main__ - INFO -   输入数据: datasets/EMtrace01.xlsx
2025-05-23 20:31:51,498 - __main__ - INFO -   数据目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets
2025-05-23 20:31:51,499 - __main__ - INFO -   结果目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results
2025-05-23 20:31:51,499 - __main__ - INFO - 操作成功完成
2025-05-23 20:32:10,572 - __main__ - INFO - 检查运行环境...
2025-05-23 20:32:19,838 - __main__ - INFO - ✓ 检测到Excel数据文件: datasets/EMtrace01.xlsx
2025-05-23 20:32:19,838 - __main__ - INFO - ✓ 运行环境检查通过
2025-05-23 20:32:19,838 - __main__ - INFO - 操作成功完成
2025-05-23 20:33:31,276 - __main__ - INFO - 尝试使用简化测试方法...
2025-05-23 20:33:31,276 - __main__ - INFO - ============================================================
2025-05-23 20:33:31,276 - __main__ - INFO - 使用简化方法测试核心模块
2025-05-23 20:33:31,276 - __main__ - INFO - ============================================================
2025-05-23 20:33:31,656 - __main__ - INFO - ✓ 所有核心模块导入成功
2025-05-23 20:33:31,657 - __main__ - INFO - 执行基本功能测试...
2025-05-23 20:33:31,657 - __main__ - INFO - ✓ format_convert 模块测试通过
2025-05-23 20:33:31,679 - __main__ - INFO - ✓ mutual 模块测试通过
2025-05-23 20:33:31,680 - __main__ - INFO - ✓ phasespace 模块测试通过
2025-05-23 20:33:31,680 - __main__ - INFO - ✓ cellset2trim 模块测试通过
2025-05-23 20:33:31,681 - __main__ - INFO - ✓ 所有核心模块功能测试通过
2025-05-23 20:33:31,681 - __main__ - INFO - 操作成功完成
2025-05-23 20:33:36,458 - __main__ - INFO - 尝试使用简化测试方法...
2025-05-23 20:33:36,458 - __main__ - INFO - ============================================================
2025-05-23 20:33:36,458 - __main__ - INFO - 使用简化方法测试核心模块
2025-05-23 20:33:36,459 - __main__ - INFO - ============================================================
2025-05-23 20:33:36,823 - __main__ - INFO - ✓ 所有核心模块导入成功
2025-05-23 20:33:36,823 - __main__ - INFO - 执行基本功能测试...
2025-05-23 20:33:36,824 - __main__ - INFO - ✓ format_convert 模块测试通过
2025-05-23 20:33:36,842 - __main__ - INFO - ✓ mutual 模块测试通过
2025-05-23 20:33:36,843 - __main__ - INFO - ✓ phasespace 模块测试通过
2025-05-23 20:33:36,844 - __main__ - INFO - ✓ cellset2trim 模块测试通过
2025-05-23 20:33:36,844 - __main__ - INFO - ✓ 所有核心模块功能测试通过
2025-05-23 20:33:36,844 - __main__ - INFO - 操作成功完成
2025-05-23 20:34:03,662 - __main__ - INFO - ============================================================
2025-05-23 20:34:03,662 - __main__ - INFO - 开始完整的处理和训练流程
2025-05-23 20:34:03,662 - __main__ - INFO - ============================================================
2025-05-23 20:34:03,663 - __main__ - INFO - ============================================================
2025-05-23 20:34:03,663 - __main__ - INFO - 开始数据处理流程
2025-05-23 20:34:03,663 - __main__ - INFO - ============================================================
2025-05-23 20:34:04,708 - scn_phase_space_process - INFO - ============================================================
2025-05-23 20:34:04,708 - scn_phase_space_process - INFO - 3D SCN数据处理流程 - Python版本
2025-05-23 20:34:04,709 - scn_phase_space_process - INFO - 增强版本：支持Excel和MAT格式
2025-05-23 20:34:04,709 - scn_phase_space_process - INFO - ============================================================
2025-05-23 20:34:04,710 - scn_phase_space_process - INFO - 输出目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets
2025-05-23 20:34:04,710 - scn_phase_space_process - INFO - 
步骤1: 智能数据加载
2025-05-23 20:34:04,710 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 20:34:04,710 - scn_phase_space_process - INFO - 正在检测和加载数据文件: datasets/EMtrace01.xlsx
2025-05-23 20:34:04,711 - scn_phase_space_process - INFO - 检测到文件格式: excel
2025-05-23 20:34:04,711 - scn_phase_space_process - INFO - 使用Excel数据处理器加载钙离子数据...
2025-05-23 20:34:04,711 - excel_data_processor - INFO - 正在加载Excel数据文件: datasets\EMtrace01.xlsx
2025-05-23 20:34:05,671 - excel_data_processor - INFO - ✓ 成功加载数据: 2999 个时间点, 43 个神经元
2025-05-23 20:34:05,671 - excel_data_processor - INFO - 神经元列: ['n1', 'n2', 'n3', 'n4', 'n5', 'n6', 'n7', 'n8', 'n9', 'n10']...
2025-05-23 20:34:05,671 - excel_data_processor - INFO - 开始预处理钙离子数据...
2025-05-23 20:34:05,677 - excel_data_processor - WARNING - 检测并处理了 247 个异常值
2025-05-23 20:34:05,677 - excel_data_processor - INFO - 执行Z-score标准化...
2025-05-23 20:34:05,680 - excel_data_processor - INFO - ✓ 数据预处理完成: (2999, 43) -> (2999, 43)
2025-05-23 20:34:05,681 - excel_data_processor - INFO - 转换数据为SCN处理格式...
2025-05-23 20:34:05,681 - excel_data_processor - INFO - 分段参数: 段长度=340, 步长=170
2025-05-23 20:34:05,681 - excel_data_processor - INFO - ✓ 转换完成: 10 个神经元, 平均每个神经元 10.0 个时间段
2025-05-23 20:34:05,683 - scn_phase_space_process - INFO - 数据加载信息:
2025-05-23 20:34:05,683 - scn_phase_space_process - INFO -   文件路径: datasets\EMtrace01.xlsx
2025-05-23 20:34:05,684 - scn_phase_space_process - INFO -   时间点数量: 2999
2025-05-23 20:34:05,684 - scn_phase_space_process - INFO -   神经元数量: 43
2025-05-23 20:34:05,684 - scn_phase_space_process - INFO -   数据形状: (2999, 43)
2025-05-23 20:34:05,684 - scn_phase_space_process - INFO -   时间戳范围: 1 - 2999
2025-05-23 20:34:05,685 - scn_phase_space_process - INFO -   神经元ID: ['n1', 'n2', 'n3', 'n4', 'n5', '...']
2025-05-23 20:34:05,685 - scn_phase_space_process - INFO -   缺失值数量: 0
2025-05-23 20:34:05,685 - scn_phase_space_process - INFO -   数据范围: -1.358 - 4.895
2025-05-23 20:34:05,685 - scn_phase_space_process - INFO -   数据均值: -0.000
2025-05-23 20:34:05,686 - scn_phase_space_process - INFO -   数据标准差: 0.578
2025-05-23 20:34:05,686 - scn_phase_space_process - INFO -   数据格式: Excel
2025-05-23 20:34:05,686 - scn_phase_space_process - INFO -   处理器: ExcelCalciumDataProcessor
2025-05-23 20:34:05,686 - scn_phase_space_process - INFO - 
步骤2: 相空间重构
2025-05-23 20:34:05,687 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 20:34:05,687 - scn_phase_space_process - INFO - 数据维度: 10 个细胞, 10 个时间线
2025-05-23 20:34:05,688 - scn_phase_space_process - INFO - 开始处理钙信号数据...
2025-05-23 20:34:10,335 - scn_phase_space_process - INFO - ✓ 相空间重构完成
2025-05-23 20:34:10,336 - scn_phase_space_process - INFO - 
步骤3: 数据裁剪
2025-05-23 20:34:10,336 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 20:34:10,336 - scn_phase_space_process - INFO - 开始裁剪数据到统一长度: 170
2025-05-23 20:34:10,336 - scn_phase_space_process - INFO - ✓ 数据裁剪完成
2025-05-23 20:34:10,337 - scn_phase_space_process - INFO - 
步骤4: 构建图数据集
2025-05-23 20:34:10,337 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 20:34:10,337 - scn_phase_space_process - INFO - 有效样本数量: 100
2025-05-23 20:34:10,337 - scn_phase_space_process - INFO - 生成 nodes.csv 文件...
2025-05-23 20:34:10,337 - scn_phase_space_process - INFO - 转换节点特征格式...
2025-05-23 20:34:10,408 - scn_phase_space_process - INFO - ✓ nodes.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\nodes.csv
2025-05-23 20:34:10,409 - scn_phase_space_process - INFO - 生成 edges.csv 文件...
2025-05-23 20:34:10,421 - scn_phase_space_process - INFO - ✓ edges.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\edges.csv
2025-05-23 20:34:10,421 - scn_phase_space_process - INFO - 生成 graphs.csv 文件...
2025-05-23 20:34:10,422 - scn_phase_space_process - INFO - 标签分布: {np.int64(0): np.int64(14), np.int64(1): np.int64(15), np.int64(2): np.int64(18), np.int64(3): np.int64(20), np.int64(4): np.int64(17), np.int64(5): np.int64(16)}
2025-05-23 20:34:10,423 - scn_phase_space_process - INFO - ✓ graphs.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\graphs.csv
2025-05-23 20:34:10,424 - scn_phase_space_process - INFO - 
============================================================
2025-05-23 20:34:10,424 - scn_phase_space_process - INFO - 数据处理流程全部完成!
2025-05-23 20:34:10,424 - scn_phase_space_process - INFO - ============================================================
2025-05-23 20:34:10,425 - scn_phase_space_process - INFO - 数据源信息:
2025-05-23 20:34:10,425 - scn_phase_space_process - INFO -   - 文件: datasets/EMtrace01.xlsx
2025-05-23 20:34:10,425 - scn_phase_space_process - INFO -   - 格式: Excel
2025-05-23 20:34:10,426 - scn_phase_space_process - INFO -   - 处理器: ExcelCalciumDataProcessor
2025-05-23 20:34:10,426 - scn_phase_space_process - INFO - 
生成的文件:
2025-05-23 20:34:10,426 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/nodes.csv
2025-05-23 20:34:10,426 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/edges.csv
2025-05-23 20:34:10,427 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/graphs.csv
2025-05-23 20:34:10,427 - scn_phase_space_process - INFO - 
处理结果:
2025-05-23 20:34:10,427 - scn_phase_space_process - INFO -   - 总样本数量: 100
2025-05-23 20:34:10,428 - scn_phase_space_process - INFO -   - 轨迹长度: 170
2025-05-23 20:34:10,428 - scn_phase_space_process - INFO -   - 嵌入维度: 3
2025-05-23 20:34:10,428 - scn_phase_space_process - INFO - 
下一步操作:
2025-05-23 20:34:10,428 - scn_phase_space_process - INFO -   1. 检查生成的CSV文件质量
2025-05-23 20:34:10,428 - scn_phase_space_process - INFO -   2. 运行训练: python main.py 或 python run.py --train
2025-05-23 20:34:10,428 - scn_phase_space_process - INFO -   3. 查看训练结果: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results
2025-05-23 20:34:10,429 - __main__ - INFO - ✓ 数据处理完成
2025-05-23 20:34:10,429 - __main__ - INFO - ============================================================
2025-05-23 20:34:10,429 - __main__ - INFO - 开始模型训练流程
2025-05-23 20:34:10,429 - __main__ - INFO - ============================================================
2025-05-23 20:34:20,502 - main - INFO - ============================================================
2025-05-23 20:34:20,503 - main - INFO - 脑网络状态分类器训练程序启动
2025-05-23 20:34:20,503 - main - INFO - ============================================================
2025-05-23 20:34:20,505 - main - INFO - ✓ 随机种子设置完成
2025-05-23 20:34:20,508 - main - INFO - ✓ 使用GPU: NVIDIA GeForce RTX 4060
2025-05-23 20:34:20,508 - main - INFO - 加载数据集...
2025-05-23 20:34:20,641 - main - INFO - ✓ 数据集加载成功
2025-05-23 20:34:20,641 - main - INFO -   - 训练集批次数: 240
2025-05-23 20:34:20,642 - main - INFO -   - 验证集批次数: 20
2025-05-23 20:34:20,642 - main - INFO -   - 测试集批次数: 19
2025-05-23 20:34:20,798 - main - INFO - ✓ 模型创建成功
2025-05-23 20:34:20,799 - main - INFO - 模型架构:
MultiLayerGCN(
  (conv0): GCNConv(3, 32)
  (conv1): GCNConv(32, 32)
  (conv2): GCNConv(32, 32)
  (pool): GlobalPooling(
    (max_pool): AdaptiveMaxPool1d(output_size=1)
    (avg_pool): AdaptiveAvgPool1d(output_size=1)
  )
  (classifier): Sequential(
    (fc0): Linear(in_features=192, out_features=16, bias=False)
    (relu0): LeakyReLU(negative_slope=0.2)
    (drop0): Dropout(p=0.5, inplace=False)
    (fc2): Linear(in_features=16, out_features=6, bias=True)
  )
)
2025-05-23 20:34:20,799 - main - INFO - 模型参数总数: 5,414
2025-05-23 20:34:20,800 - main - INFO - 可训练参数: 5,414
2025-05-23 20:34:20,800 - main - INFO - 
开始模型训练...
2025-05-23 20:34:20,800 - main - INFO - 开始训练，总共 160 个epoch
2025-05-23 20:34:22,123 - main - INFO - Epoch 1 平均损失: 1.8034
2025-05-23 20:34:22,182 - main - INFO - Epoch 1/160 - 训练损失: 1.8034, 验证准确率: 0.3500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:34:23,289 - main - INFO - Epoch 2 平均损失: 1.7931
2025-05-23 20:34:23,352 - main - INFO - Epoch 2/160 - 训练损失: 1.7931, 验证准确率: 0.3000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:34:24,499 - main - INFO - Epoch 3 平均损失: 1.8045
2025-05-23 20:34:24,554 - main - INFO - Epoch 3/160 - 训练损失: 1.8045, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:34:25,771 - main - INFO - Epoch 4 平均损失: 1.7776
2025-05-23 20:34:25,828 - main - INFO - Epoch 4/160 - 训练损失: 1.7776, 验证准确率: 0.3000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:34:27,031 - main - INFO - Epoch 5 平均损失: 1.7617
2025-05-23 20:34:27,083 - main - INFO - Epoch 5/160 - 训练损失: 1.7617, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:34:28,195 - main - INFO - Epoch 6 平均损失: 1.7692
2025-05-23 20:34:28,254 - main - INFO - Epoch 6/160 - 训练损失: 1.7692, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:34:29,437 - main - INFO - Epoch 7 平均损失: 1.7601
2025-05-23 20:34:29,502 - main - INFO - Epoch 7/160 - 训练损失: 1.7601, 验证准确率: 0.3000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:34:30,676 - main - INFO - Epoch 8 平均损失: 1.7369
2025-05-23 20:34:30,731 - main - INFO - Epoch 8/160 - 训练损失: 1.7369, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:34:31,916 - main - INFO - Epoch 9 平均损失: 1.7436
2025-05-23 20:34:31,975 - main - INFO - Epoch 9/160 - 训练损失: 1.7436, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:34:33,042 - main - INFO - Epoch 10 平均损失: 1.7220
2025-05-23 20:34:33,096 - main - INFO - Epoch 10/160 - 训练损失: 1.7220, 验证准确率: 0.0000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:34:34,158 - main - INFO - Epoch 11 平均损失: 1.7015
2025-05-23 20:34:34,238 - main - INFO - Epoch 11/160 - 训练损失: 1.7015, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:34:35,295 - main - INFO - Epoch 12 平均损失: 1.7111
2025-05-23 20:34:36,148 - main - INFO - Epoch 12/160 - 训练损失: 1.7111, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:34:37,228 - main - INFO - Epoch 13 平均损失: 1.7085
2025-05-23 20:34:37,285 - main - INFO - Epoch 13/160 - 训练损失: 1.7085, 验证准确率: 0.0000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:34:38,386 - main - INFO - Epoch 14 平均损失: 1.7022
2025-05-23 20:34:38,449 - main - INFO - Epoch 14/160 - 训练损失: 1.7022, 验证准确率: 0.0500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:34:39,755 - main - INFO - Epoch 15 平均损失: 1.6723
2025-05-23 20:34:39,821 - main - INFO - Epoch 15/160 - 训练损失: 1.6723, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:34:41,088 - main - INFO - Epoch 16 平均损失: 1.6644
2025-05-23 20:34:41,152 - main - INFO - Epoch 16/160 - 训练损失: 1.6644, 验证准确率: 0.0500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:34:42,373 - main - INFO - Epoch 17 平均损失: 1.6432
2025-05-23 20:34:42,433 - main - INFO - Epoch 17/160 - 训练损失: 1.6432, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:34:43,531 - main - INFO - Epoch 18 平均损失: 1.6602
2025-05-23 20:34:44,381 - main - INFO - Epoch 18/160 - 训练损失: 1.6602, 验证准确率: 0.0500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:34:45,621 - main - INFO - Epoch 19 平均损失: 1.6385
2025-05-23 20:34:45,680 - main - INFO - Epoch 19/160 - 训练损失: 1.6385, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:34:46,760 - main - INFO - Epoch 20 平均损失: 1.6472
2025-05-23 20:34:46,817 - main - INFO - Epoch 20/160 - 训练损失: 1.6472, 验证准确率: 0.2500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:34:46,818 - main - INFO - 学习率衰减至: 0.000750
2025-05-23 20:34:47,858 - main - INFO - Epoch 21 平均损失: 1.5749
2025-05-23 20:34:47,915 - main - INFO - Epoch 21/160 - 训练损失: 1.5749, 验证准确率: 0.2500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:34:48,967 - main - INFO - Epoch 22 平均损失: 1.5450
2025-05-23 20:34:49,016 - main - INFO - Epoch 22/160 - 训练损失: 1.5450, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:34:50,036 - main - INFO - Epoch 23 平均损失: 1.5803
2025-05-23 20:34:50,095 - main - INFO - Epoch 23/160 - 训练损失: 1.5803, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:34:51,221 - main - INFO - Epoch 24 平均损失: 1.5770
2025-05-23 20:34:51,280 - main - INFO - Epoch 24/160 - 训练损失: 1.5770, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:34:52,387 - main - INFO - Epoch 25 平均损失: 1.5521
2025-05-23 20:34:52,448 - main - INFO - Epoch 25/160 - 训练损失: 1.5521, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:34:53,484 - main - INFO - Epoch 26 平均损失: 1.5211
2025-05-23 20:34:53,547 - main - INFO - Epoch 26/160 - 训练损失: 1.5211, 验证准确率: 0.0000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:34:54,545 - main - INFO - Epoch 27 平均损失: 1.5190
2025-05-23 20:34:54,612 - main - INFO - Epoch 27/160 - 训练损失: 1.5190, 验证准确率: 0.0000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:34:55,616 - main - INFO - Epoch 28 平均损失: 1.5106
2025-05-23 20:34:55,672 - main - INFO - Epoch 28/160 - 训练损失: 1.5106, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:34:56,737 - main - INFO - Epoch 29 平均损失: 1.4798
2025-05-23 20:34:56,785 - main - INFO - Epoch 29/160 - 训练损失: 1.4798, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:34:57,882 - main - INFO - Epoch 30 平均损失: 1.5262
2025-05-23 20:34:57,941 - main - INFO - Epoch 30/160 - 训练损失: 1.5262, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:34:58,938 - main - INFO - Epoch 31 平均损失: 1.5349
2025-05-23 20:34:58,989 - main - INFO - Epoch 31/160 - 训练损失: 1.5349, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:34:59,990 - main - INFO - Epoch 32 平均损失: 1.4814
2025-05-23 20:35:00,043 - main - INFO - Epoch 32/160 - 训练损失: 1.4814, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:01,044 - main - INFO - Epoch 33 平均损失: 1.4738
2025-05-23 20:35:01,096 - main - INFO - Epoch 33/160 - 训练损失: 1.4738, 验证准确率: 0.0000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:02,097 - main - INFO - Epoch 34 平均损失: 1.4991
2025-05-23 20:35:02,171 - main - INFO - Epoch 34/160 - 训练损失: 1.4991, 验证准确率: 0.0500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:03,136 - main - INFO - Epoch 35 平均损失: 1.4406
2025-05-23 20:35:03,200 - main - INFO - Epoch 35/160 - 训练损失: 1.4406, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:04,202 - main - INFO - Epoch 36 平均损失: 1.4653
2025-05-23 20:35:04,261 - main - INFO - Epoch 36/160 - 训练损失: 1.4653, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:05,412 - main - INFO - Epoch 37 平均损失: 1.4520
2025-05-23 20:35:06,273 - main - INFO - Epoch 37/160 - 训练损失: 1.4520, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:07,355 - main - INFO - Epoch 38 平均损失: 1.4825
2025-05-23 20:35:07,416 - main - INFO - Epoch 38/160 - 训练损失: 1.4825, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:08,500 - main - INFO - Epoch 39 平均损失: 1.4040
2025-05-23 20:35:08,567 - main - INFO - Epoch 39/160 - 训练损失: 1.4040, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:09,700 - main - INFO - Epoch 40 平均损失: 1.4054
2025-05-23 20:35:09,756 - main - INFO - Epoch 40/160 - 训练损失: 1.4054, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:09,757 - main - INFO - 学习率衰减至: 0.000563
2025-05-23 20:35:10,878 - main - INFO - Epoch 41 平均损失: 1.3852
2025-05-23 20:35:10,932 - main - INFO - Epoch 41/160 - 训练损失: 1.3852, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:12,078 - main - INFO - Epoch 42 平均损失: 1.4006
2025-05-23 20:35:12,154 - main - INFO - Epoch 42/160 - 训练损失: 1.4006, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:13,442 - main - INFO - Epoch 43 平均损失: 1.4127
2025-05-23 20:35:13,505 - main - INFO - Epoch 43/160 - 训练损失: 1.4127, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:14,751 - main - INFO - Epoch 44 平均损失: 1.3745
2025-05-23 20:35:14,812 - main - INFO - Epoch 44/160 - 训练损失: 1.3745, 验证准确率: 0.2500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:16,090 - main - INFO - Epoch 45 平均损失: 1.3693
2025-05-23 20:35:16,159 - main - INFO - Epoch 45/160 - 训练损失: 1.3693, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:17,394 - main - INFO - Epoch 46 平均损失: 1.4087
2025-05-23 20:35:17,451 - main - INFO - Epoch 46/160 - 训练损失: 1.4087, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:18,621 - main - INFO - Epoch 47 平均损失: 1.4172
2025-05-23 20:35:18,688 - main - INFO - Epoch 47/160 - 训练损失: 1.4172, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:19,818 - main - INFO - Epoch 48 平均损失: 1.3352
2025-05-23 20:35:19,886 - main - INFO - Epoch 48/160 - 训练损失: 1.3352, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:21,008 - main - INFO - Epoch 49 平均损失: 1.3579
2025-05-23 20:35:21,070 - main - INFO - Epoch 49/160 - 训练损失: 1.3579, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:22,144 - main - INFO - Epoch 50 平均损失: 1.3309
2025-05-23 20:35:22,202 - main - INFO - Epoch 50/160 - 训练损失: 1.3309, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:23,350 - main - INFO - Epoch 51 平均损失: 1.3321
2025-05-23 20:35:23,424 - main - INFO - Epoch 51/160 - 训练损失: 1.3321, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:24,577 - main - INFO - Epoch 52 平均损失: 1.2944
2025-05-23 20:35:24,637 - main - INFO - Epoch 52/160 - 训练损失: 1.2944, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:25,888 - main - INFO - Epoch 53 平均损失: 1.3670
2025-05-23 20:35:25,963 - main - INFO - Epoch 53/160 - 训练损失: 1.3670, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:27,129 - main - INFO - Epoch 54 平均损失: 1.3107
2025-05-23 20:35:27,192 - main - INFO - Epoch 54/160 - 训练损失: 1.3107, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:28,588 - main - INFO - Epoch 55 平均损失: 1.2471
2025-05-23 20:35:28,648 - main - INFO - Epoch 55/160 - 训练损失: 1.2471, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:29,932 - main - INFO - Epoch 56 平均损失: 1.3113
2025-05-23 20:35:29,993 - main - INFO - Epoch 56/160 - 训练损失: 1.3113, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:31,198 - main - INFO - Epoch 57 平均损失: 1.2900
2025-05-23 20:35:31,253 - main - INFO - Epoch 57/160 - 训练损失: 1.2900, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:32,388 - main - INFO - Epoch 58 平均损失: 1.2758
2025-05-23 20:35:32,451 - main - INFO - Epoch 58/160 - 训练损失: 1.2758, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:33,773 - main - INFO - Epoch 59 平均损失: 1.1780
2025-05-23 20:35:33,839 - main - INFO - Epoch 59/160 - 训练损失: 1.1780, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:35,124 - main - INFO - Epoch 60 平均损失: 1.2639
2025-05-23 20:35:35,191 - main - INFO - Epoch 60/160 - 训练损失: 1.2639, 验证准确率: 0.2500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:35,192 - main - INFO - 学习率衰减至: 0.000422
2025-05-23 20:35:36,328 - main - INFO - Epoch 61 平均损失: 1.2248
2025-05-23 20:35:36,384 - main - INFO - Epoch 61/160 - 训练损失: 1.2248, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:37,502 - main - INFO - Epoch 62 平均损失: 1.2091
2025-05-23 20:35:37,557 - main - INFO - Epoch 62/160 - 训练损失: 1.2091, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:38,568 - main - INFO - Epoch 63 平均损失: 1.2514
2025-05-23 20:35:38,622 - main - INFO - Epoch 63/160 - 训练损失: 1.2514, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:39,762 - main - INFO - Epoch 64 平均损失: 1.2273
2025-05-23 20:35:40,213 - main - INFO - Epoch 64/160 - 训练损失: 1.2273, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:41,556 - main - INFO - Epoch 65 平均损失: 1.2247
2025-05-23 20:35:41,630 - main - INFO - Epoch 65/160 - 训练损失: 1.2247, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:42,896 - main - INFO - Epoch 66 平均损失: 1.2269
2025-05-23 20:35:42,963 - main - INFO - Epoch 66/160 - 训练损失: 1.2269, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:44,188 - main - INFO - Epoch 67 平均损失: 1.2338
2025-05-23 20:35:44,243 - main - INFO - Epoch 67/160 - 训练损失: 1.2338, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:45,659 - main - INFO - Epoch 68 平均损失: 1.2124
2025-05-23 20:35:45,722 - main - INFO - Epoch 68/160 - 训练损失: 1.2124, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:46,962 - main - INFO - Epoch 69 平均损失: 1.1821
2025-05-23 20:35:47,019 - main - INFO - Epoch 69/160 - 训练损失: 1.1821, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:48,164 - main - INFO - Epoch 70 平均损失: 1.2045
2025-05-23 20:35:48,216 - main - INFO - Epoch 70/160 - 训练损失: 1.2045, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:49,485 - main - INFO - Epoch 71 平均损失: 1.1820
2025-05-23 20:35:49,553 - main - INFO - Epoch 71/160 - 训练损失: 1.1820, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:50,673 - main - INFO - Epoch 72 平均损失: 1.2004
2025-05-23 20:35:50,723 - main - INFO - Epoch 72/160 - 训练损失: 1.2004, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:51,756 - main - INFO - Epoch 73 平均损失: 1.1673
2025-05-23 20:35:51,818 - main - INFO - Epoch 73/160 - 训练损失: 1.1673, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:52,831 - main - INFO - Epoch 74 平均损失: 1.2613
2025-05-23 20:35:52,888 - main - INFO - Epoch 74/160 - 训练损失: 1.2613, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:54,000 - main - INFO - Epoch 75 平均损失: 1.1926
2025-05-23 20:35:54,052 - main - INFO - Epoch 75/160 - 训练损失: 1.1926, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:55,243 - main - INFO - Epoch 76 平均损失: 1.1630
2025-05-23 20:35:55,312 - main - INFO - Epoch 76/160 - 训练损失: 1.1630, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:56,639 - main - INFO - Epoch 77 平均损失: 1.1438
2025-05-23 20:35:56,693 - main - INFO - Epoch 77/160 - 训练损失: 1.1438, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:58,158 - main - INFO - Epoch 78 平均损失: 1.2688
2025-05-23 20:35:58,210 - main - INFO - Epoch 78/160 - 训练损失: 1.2688, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:35:59,476 - main - INFO - Epoch 79 平均损失: 1.1317
2025-05-23 20:35:59,538 - main - INFO - Epoch 79/160 - 训练损失: 1.1317, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:36:00,951 - main - INFO - Epoch 80 平均损失: 1.2151
2025-05-23 20:36:01,039 - main - INFO - Epoch 80/160 - 训练损失: 1.2151, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:36:01,040 - main - INFO - 学习率衰减至: 0.000316
2025-05-23 20:36:02,408 - main - INFO - Epoch 81 平均损失: 1.1034
2025-05-23 20:36:02,481 - main - INFO - Epoch 81/160 - 训练损失: 1.1034, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:36:04,045 - main - INFO - Epoch 82 平均损失: 1.1475
2025-05-23 20:36:04,128 - main - INFO - Epoch 82/160 - 训练损失: 1.1475, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:36:05,394 - main - INFO - Epoch 83 平均损失: 1.1624
2025-05-23 20:36:05,492 - main - INFO - Epoch 83/160 - 训练损失: 1.1624, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:36:06,842 - main - INFO - Epoch 84 平均损失: 1.1842
2025-05-23 20:36:06,911 - main - INFO - Epoch 84/160 - 训练损失: 1.1842, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:36:08,204 - main - INFO - Epoch 85 平均损失: 1.0591
2025-05-23 20:36:08,262 - main - INFO - Epoch 85/160 - 训练损失: 1.0591, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:36:09,647 - main - INFO - Epoch 86 平均损失: 1.1574
2025-05-23 20:36:09,783 - main - INFO - Epoch 86/160 - 训练损失: 1.1574, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:36:11,117 - main - INFO - Epoch 87 平均损失: 1.1424
2025-05-23 20:36:11,203 - main - INFO - Epoch 87/160 - 训练损失: 1.1424, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:36:12,583 - main - INFO - Epoch 88 平均损失: 1.1157
2025-05-23 20:36:12,655 - main - INFO - Epoch 88/160 - 训练损失: 1.1157, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:36:14,018 - main - INFO - Epoch 89 平均损失: 1.1394
2025-05-23 20:36:14,090 - main - INFO - Epoch 89/160 - 训练损失: 1.1394, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:36:15,289 - main - INFO - Epoch 90 平均损失: 1.0103
2025-05-23 20:36:15,357 - main - INFO - Epoch 90/160 - 训练损失: 1.0103, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:36:16,611 - main - INFO - Epoch 91 平均损失: 1.0807
2025-05-23 20:36:16,673 - main - INFO - Epoch 91/160 - 训练损失: 1.0807, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:36:18,015 - main - INFO - Epoch 92 平均损失: 1.0970
2025-05-23 20:36:18,085 - main - INFO - Epoch 92/160 - 训练损失: 1.0970, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:36:19,525 - main - INFO - Epoch 93 平均损失: 1.0840
2025-05-23 20:36:19,583 - main - INFO - Epoch 93/160 - 训练损失: 1.0840, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:36:20,732 - main - INFO - Epoch 94 平均损失: 1.0643
2025-05-23 20:36:20,794 - main - INFO - Epoch 94/160 - 训练损失: 1.0643, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:36:22,229 - main - INFO - Epoch 95 平均损失: 1.1565
2025-05-23 20:36:22,292 - main - INFO - Epoch 95/160 - 训练损失: 1.1565, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:36:23,588 - main - INFO - Epoch 96 平均损失: 1.0366
2025-05-23 20:36:23,679 - main - INFO - Epoch 96/160 - 训练损失: 1.0366, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:36:25,689 - main - INFO - Epoch 97 平均损失: 1.0637
2025-05-23 20:36:25,791 - main - INFO - Epoch 97/160 - 训练损失: 1.0637, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:36:27,993 - main - INFO - Epoch 98 平均损失: 1.1032
2025-05-23 20:36:28,091 - main - INFO - Epoch 98/160 - 训练损失: 1.1032, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:36:30,153 - main - INFO - Epoch 99 平均损失: 1.1143
2025-05-23 20:36:30,266 - main - INFO - Epoch 99/160 - 训练损失: 1.1143, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:36:32,209 - main - INFO - Epoch 100 平均损失: 1.0359
2025-05-23 20:36:32,303 - main - INFO - Epoch 100/160 - 训练损失: 1.0359, 验证准确率: 0.2500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:36:32,303 - main - INFO - 学习率衰减至: 0.000237
2025-05-23 20:36:33,722 - main - INFO - Epoch 101 平均损失: 1.1156
2025-05-23 20:36:33,772 - main - INFO - Epoch 101/160 - 训练损失: 1.1156, 验证准确率: 0.2500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:36:35,014 - main - INFO - Epoch 102 平均损失: 1.0918
2025-05-23 20:36:35,082 - main - INFO - Epoch 102/160 - 训练损失: 1.0918, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:36:36,291 - main - INFO - Epoch 103 平均损失: 0.9760
2025-05-23 20:36:36,353 - main - INFO - Epoch 103/160 - 训练损失: 0.9760, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:36:37,761 - main - INFO - Epoch 104 平均损失: 1.0187
2025-05-23 20:36:37,813 - main - INFO - Epoch 104/160 - 训练损失: 1.0187, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:36:39,306 - main - INFO - Epoch 105 平均损失: 1.0202
2025-05-23 20:36:39,377 - main - INFO - Epoch 105/160 - 训练损失: 1.0202, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:36:40,670 - main - INFO - Epoch 106 平均损失: 0.9963
2025-05-23 20:36:40,763 - main - INFO - Epoch 106/160 - 训练损失: 0.9963, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:36:42,782 - main - INFO - Epoch 107 平均损失: 1.0362
2025-05-23 20:36:42,869 - main - INFO - Epoch 107/160 - 训练损失: 1.0362, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:36:44,825 - main - INFO - Epoch 108 平均损失: 1.0410
2025-05-23 20:36:44,912 - main - INFO - Epoch 108/160 - 训练损失: 1.0410, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:36:46,791 - main - INFO - Epoch 109 平均损失: 1.1046
2025-05-23 20:36:46,885 - main - INFO - Epoch 109/160 - 训练损失: 1.1046, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:36:48,934 - main - INFO - Epoch 110 平均损失: 0.9900
2025-05-23 20:36:49,040 - main - INFO - Epoch 110/160 - 训练损失: 0.9900, 验证准确率: 0.2500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:36:51,017 - main - INFO - Epoch 111 平均损失: 0.9942
2025-05-23 20:36:51,139 - main - INFO - Epoch 111/160 - 训练损失: 0.9942, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:36:52,712 - main - INFO - Epoch 112 平均损失: 0.9369
2025-05-23 20:36:52,766 - main - INFO - Epoch 112/160 - 训练损失: 0.9369, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:36:54,169 - main - INFO - Epoch 113 平均损失: 0.9537
2025-05-23 20:36:54,227 - main - INFO - Epoch 113/160 - 训练损失: 0.9537, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:36:55,846 - main - INFO - Epoch 114 平均损失: 1.0122
2025-05-23 20:36:55,938 - main - INFO - Epoch 114/160 - 训练损失: 1.0122, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:36:57,708 - main - INFO - Epoch 115 平均损失: 1.0334
2025-05-23 20:36:57,781 - main - INFO - Epoch 115/160 - 训练损失: 1.0334, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:36:59,328 - main - INFO - Epoch 116 平均损失: 1.0505
2025-05-23 20:36:59,403 - main - INFO - Epoch 116/160 - 训练损失: 1.0505, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:00,781 - main - INFO - Epoch 117 平均损失: 1.0103
2025-05-23 20:37:00,863 - main - INFO - Epoch 117/160 - 训练损失: 1.0103, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:02,061 - main - INFO - Epoch 118 平均损失: 1.0209
2025-05-23 20:37:02,155 - main - INFO - Epoch 118/160 - 训练损失: 1.0209, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:03,697 - main - INFO - Epoch 119 平均损失: 1.0406
2025-05-23 20:37:03,785 - main - INFO - Epoch 119/160 - 训练损失: 1.0406, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:05,374 - main - INFO - Epoch 120 平均损失: 0.9964
2025-05-23 20:37:05,476 - main - INFO - Epoch 120/160 - 训练损失: 0.9964, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:05,477 - main - INFO - 学习率衰减至: 0.000178
2025-05-23 20:37:07,199 - main - INFO - Epoch 121 平均损失: 1.0618
2025-05-23 20:37:07,254 - main - INFO - Epoch 121/160 - 训练损失: 1.0618, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:08,513 - main - INFO - Epoch 122 平均损失: 0.9856
2025-05-23 20:37:08,572 - main - INFO - Epoch 122/160 - 训练损失: 0.9856, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:09,697 - main - INFO - Epoch 123 平均损失: 0.9762
2025-05-23 20:37:10,367 - main - INFO - Epoch 123/160 - 训练损失: 0.9762, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:12,113 - main - INFO - Epoch 124 平均损失: 1.0236
2025-05-23 20:37:12,242 - main - INFO - Epoch 124/160 - 训练损失: 1.0236, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:14,326 - main - INFO - Epoch 125 平均损失: 0.9117
2025-05-23 20:37:14,430 - main - INFO - Epoch 125/160 - 训练损失: 0.9117, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:15,931 - main - INFO - Epoch 126 平均损失: 0.8997
2025-05-23 20:37:16,036 - main - INFO - Epoch 126/160 - 训练损失: 0.8997, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:17,579 - main - INFO - Epoch 127 平均损失: 0.9892
2025-05-23 20:37:17,642 - main - INFO - Epoch 127/160 - 训练损失: 0.9892, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:19,047 - main - INFO - Epoch 128 平均损失: 0.8992
2025-05-23 20:37:19,126 - main - INFO - Epoch 128/160 - 训练损失: 0.8992, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:20,715 - main - INFO - Epoch 129 平均损失: 1.0091
2025-05-23 20:37:20,771 - main - INFO - Epoch 129/160 - 训练损失: 1.0091, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:22,480 - main - INFO - Epoch 130 平均损失: 0.9402
2025-05-23 20:37:22,564 - main - INFO - Epoch 130/160 - 训练损失: 0.9402, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:23,886 - main - INFO - Epoch 131 平均损失: 0.9928
2025-05-23 20:37:23,956 - main - INFO - Epoch 131/160 - 训练损失: 0.9928, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:25,350 - main - INFO - Epoch 132 平均损失: 0.9682
2025-05-23 20:37:25,429 - main - INFO - Epoch 132/160 - 训练损失: 0.9682, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:26,865 - main - INFO - Epoch 133 平均损失: 0.8633
2025-05-23 20:37:26,971 - main - INFO - Epoch 133/160 - 训练损失: 0.8633, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:28,319 - main - INFO - Epoch 134 平均损失: 1.0251
2025-05-23 20:37:28,376 - main - INFO - Epoch 134/160 - 训练损失: 1.0251, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:29,854 - main - INFO - Epoch 135 平均损失: 0.9267
2025-05-23 20:37:29,936 - main - INFO - Epoch 135/160 - 训练损失: 0.9267, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:31,081 - main - INFO - Epoch 136 平均损失: 0.9357
2025-05-23 20:37:31,135 - main - INFO - Epoch 136/160 - 训练损失: 0.9357, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:32,275 - main - INFO - Epoch 137 平均损失: 1.0202
2025-05-23 20:37:32,344 - main - INFO - Epoch 137/160 - 训练损失: 1.0202, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:33,417 - main - INFO - Epoch 138 平均损失: 0.9573
2025-05-23 20:37:33,501 - main - INFO - Epoch 138/160 - 训练损失: 0.9573, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:34,734 - main - INFO - Epoch 139 平均损失: 0.9282
2025-05-23 20:37:34,825 - main - INFO - Epoch 139/160 - 训练损失: 0.9282, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:36,021 - main - INFO - Epoch 140 平均损失: 0.9294
2025-05-23 20:37:36,077 - main - INFO - Epoch 140/160 - 训练损失: 0.9294, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:36,078 - main - INFO - 学习率衰减至: 0.000133
2025-05-23 20:37:37,345 - main - INFO - Epoch 141 平均损失: 0.9189
2025-05-23 20:37:37,831 - main - INFO - Epoch 141/160 - 训练损失: 0.9189, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:39,087 - main - INFO - Epoch 142 平均损失: 0.8633
2025-05-23 20:37:39,166 - main - INFO - Epoch 142/160 - 训练损失: 0.8633, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:40,625 - main - INFO - Epoch 143 平均损失: 0.8860
2025-05-23 20:37:40,685 - main - INFO - Epoch 143/160 - 训练损失: 0.8860, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:42,178 - main - INFO - Epoch 144 平均损失: 0.8845
2025-05-23 20:37:42,259 - main - INFO - Epoch 144/160 - 训练损失: 0.8845, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:43,755 - main - INFO - Epoch 145 平均损失: 0.9325
2025-05-23 20:37:43,855 - main - INFO - Epoch 145/160 - 训练损失: 0.9325, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:45,161 - main - INFO - Epoch 146 平均损失: 0.9390
2025-05-23 20:37:45,258 - main - INFO - Epoch 146/160 - 训练损失: 0.9390, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:46,614 - main - INFO - Epoch 147 平均损失: 0.9629
2025-05-23 20:37:46,678 - main - INFO - Epoch 147/160 - 训练损失: 0.9629, 验证准确率: 0.2500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:48,535 - main - INFO - Epoch 148 平均损失: 1.0508
2025-05-23 20:37:48,639 - main - INFO - Epoch 148/160 - 训练损失: 1.0508, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:50,629 - main - INFO - Epoch 149 平均损失: 0.9636
2025-05-23 20:37:50,736 - main - INFO - Epoch 149/160 - 训练损失: 0.9636, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:52,298 - main - INFO - Epoch 150 平均损失: 0.9503
2025-05-23 20:37:52,363 - main - INFO - Epoch 150/160 - 训练损失: 0.9503, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:53,744 - main - INFO - Epoch 151 平均损失: 0.9215
2025-05-23 20:37:53,813 - main - INFO - Epoch 151/160 - 训练损失: 0.9215, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:55,335 - main - INFO - Epoch 152 平均损失: 0.8905
2025-05-23 20:37:55,468 - main - INFO - Epoch 152/160 - 训练损失: 0.8905, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:57,067 - main - INFO - Epoch 153 平均损失: 0.9123
2025-05-23 20:37:57,142 - main - INFO - Epoch 153/160 - 训练损失: 0.9123, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:58,523 - main - INFO - Epoch 154 平均损失: 0.8817
2025-05-23 20:37:58,597 - main - INFO - Epoch 154/160 - 训练损失: 0.8817, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:37:59,916 - main - INFO - Epoch 155 平均损失: 0.8855
2025-05-23 20:38:00,200 - main - INFO - Epoch 155/160 - 训练损失: 0.8855, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:38:01,480 - main - INFO - Epoch 156 平均损失: 0.8182
2025-05-23 20:38:01,539 - main - INFO - Epoch 156/160 - 训练损失: 0.8182, 验证准确率: 0.2000, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:38:02,849 - main - INFO - Epoch 157 平均损失: 0.9173
2025-05-23 20:38:02,910 - main - INFO - Epoch 157/160 - 训练损失: 0.9173, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:38:04,224 - main - INFO - Epoch 158 平均损失: 0.8557
2025-05-23 20:38:04,293 - main - INFO - Epoch 158/160 - 训练损失: 0.8557, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:38:05,454 - main - INFO - Epoch 159 平均损失: 0.9427
2025-05-23 20:38:05,511 - main - INFO - Epoch 159/160 - 训练损失: 0.9427, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:38:06,920 - main - INFO - Epoch 160 平均损失: 0.8808
2025-05-23 20:38:06,986 - main - INFO - Epoch 160/160 - 训练损失: 0.8808, 验证准确率: 0.1500, 最佳准确率: 0.3500 (Epoch 1), 最佳平均类别准确率: 0.2500
2025-05-23 20:38:06,989 - main - INFO - 最佳模型已保存至: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results\best_scn.pt
2025-05-23 20:38:06,990 - main - INFO - 
在测试集上评估最终性能...
2025-05-23 20:38:07,062 - main - INFO - ============================================================
2025-05-23 20:38:07,063 - main - INFO - 最终测试结果:
2025-05-23 20:38:07,063 - main - INFO -   测试损失: 3.4513
2025-05-23 20:38:07,063 - main - INFO -   测试准确率: 0.1053
2025-05-23 20:38:07,063 - main - INFO -   平均类别准确率: 0.2083
2025-05-23 20:38:07,063 - main - INFO - ============================================================
2025-05-23 20:38:07,064 - __main__ - INFO - ✓ 模型训练完成
2025-05-23 20:38:07,064 - __main__ - INFO - 最终测试准确率: 0.1053
2025-05-23 20:38:07,064 - __main__ - INFO - 平均类别准确率: 0.2083
2025-05-23 20:38:07,064 - __main__ - INFO - ============================================================
2025-05-23 20:38:07,064 - __main__ - INFO - 完整流程执行成功!
2025-05-23 20:38:07,065 - __main__ - INFO - ============================================================
2025-05-23 20:38:07,065 - __main__ - INFO - 操作成功完成
2025-05-23 21:06:44,586 - __main__ - INFO - ============================================================
2025-05-23 21:06:44,587 - __main__ - INFO - 开始数据处理流程
2025-05-23 21:06:44,587 - __main__ - INFO - ============================================================
2025-05-23 21:06:45,579 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:06:45,580 - scn_phase_space_process - INFO - 3D SCN数据处理流程 - Python版本
2025-05-23 21:06:45,580 - scn_phase_space_process - INFO - 增强版本：支持Excel和MAT格式
2025-05-23 21:06:45,580 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:06:45,581 - scn_phase_space_process - INFO - 输出目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets
2025-05-23 21:06:45,581 - scn_phase_space_process - INFO - 
步骤1: 智能数据加载
2025-05-23 21:06:45,581 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:06:45,581 - scn_phase_space_process - INFO - 正在检测和加载数据文件: datasets/EMtrace01.xlsx
2025-05-23 21:06:45,582 - scn_phase_space_process - INFO - 检测到文件格式: excel
2025-05-23 21:06:45,582 - scn_phase_space_process - INFO - 使用Excel数据处理器加载钙离子数据...
2025-05-23 21:06:45,582 - excel_data_processor - INFO - 正在加载Excel数据文件: datasets\EMtrace01.xlsx
2025-05-23 21:06:46,490 - excel_data_processor - INFO - ✓ 成功加载数据: 2999 个时间点, 43 个神经元
2025-05-23 21:06:46,490 - excel_data_processor - INFO - 神经元列: ['n1', 'n2', 'n3', 'n4', 'n5', 'n6', 'n7', 'n8', 'n9', 'n10']...
2025-05-23 21:06:46,491 - excel_data_processor - INFO - 开始预处理钙离子数据...
2025-05-23 21:06:46,495 - excel_data_processor - WARNING - 检测并处理了 247 个异常值
2025-05-23 21:06:46,496 - excel_data_processor - INFO - 执行Z-score标准化...
2025-05-23 21:06:46,499 - excel_data_processor - INFO - ✓ 数据预处理完成: (2999, 43) -> (2999, 43)
2025-05-23 21:06:46,499 - excel_data_processor - INFO - 转换数据为SCN处理格式...
2025-05-23 21:06:46,499 - excel_data_processor - INFO - 分段参数: 段长度=340, 步长=170
2025-05-23 21:06:46,499 - excel_data_processor - INFO - ✓ 转换完成: 10 个神经元, 平均每个神经元 10.0 个时间段
2025-05-23 21:06:46,501 - scn_phase_space_process - INFO - 数据加载信息:
2025-05-23 21:06:46,501 - scn_phase_space_process - INFO -   文件路径: datasets\EMtrace01.xlsx
2025-05-23 21:06:46,501 - scn_phase_space_process - INFO -   时间点数量: 2999
2025-05-23 21:06:46,502 - scn_phase_space_process - INFO -   神经元数量: 43
2025-05-23 21:06:46,502 - scn_phase_space_process - INFO -   数据形状: (2999, 43)
2025-05-23 21:06:46,502 - scn_phase_space_process - INFO -   时间戳范围: 1 - 2999
2025-05-23 21:06:46,503 - scn_phase_space_process - INFO -   神经元ID: ['n1', 'n2', 'n3', 'n4', 'n5', '...']
2025-05-23 21:06:46,503 - scn_phase_space_process - INFO -   缺失值数量: 0
2025-05-23 21:06:46,503 - scn_phase_space_process - INFO -   数据范围: -1.358 - 4.895
2025-05-23 21:06:46,503 - scn_phase_space_process - INFO -   数据均值: -0.000
2025-05-23 21:06:46,504 - scn_phase_space_process - INFO -   数据标准差: 0.578
2025-05-23 21:06:46,504 - scn_phase_space_process - INFO -   数据格式: Excel
2025-05-23 21:06:46,504 - scn_phase_space_process - INFO -   处理器: ExcelCalciumDataProcessor
2025-05-23 21:06:46,504 - scn_phase_space_process - INFO - 
步骤2: 相空间重构
2025-05-23 21:06:46,505 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:06:46,505 - scn_phase_space_process - INFO - 数据维度: 10 个细胞, 10 个时间线
2025-05-23 21:06:46,505 - scn_phase_space_process - INFO - 开始处理钙信号数据...
2025-05-23 21:06:51,054 - scn_phase_space_process - INFO - ✓ 相空间重构完成
2025-05-23 21:06:51,055 - scn_phase_space_process - INFO - 
步骤3: 数据裁剪
2025-05-23 21:06:51,055 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:06:51,055 - scn_phase_space_process - INFO - 开始裁剪数据到统一长度: 170
2025-05-23 21:06:51,056 - scn_phase_space_process - INFO - ✓ 数据裁剪完成
2025-05-23 21:06:51,056 - scn_phase_space_process - INFO - 
步骤4: 构建图数据集
2025-05-23 21:06:51,056 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:06:51,056 - scn_phase_space_process - INFO - 有效样本数量: 100
2025-05-23 21:06:51,057 - scn_phase_space_process - INFO - 生成 nodes.csv 文件...
2025-05-23 21:06:51,057 - scn_phase_space_process - INFO - 转换节点特征格式...
2025-05-23 21:06:51,136 - scn_phase_space_process - INFO - ✓ nodes.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\nodes.csv
2025-05-23 21:06:51,136 - scn_phase_space_process - INFO - 生成 edges.csv 文件...
2025-05-23 21:06:51,148 - scn_phase_space_process - INFO - ✓ edges.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\edges.csv
2025-05-23 21:06:51,148 - scn_phase_space_process - INFO - 生成 graphs.csv 文件...
2025-05-23 21:06:51,149 - scn_phase_space_process - INFO - 外部模块不可用，使用内置的改进标签生成方法...
2025-05-23 21:06:51,416 - scn_phase_space_process - INFO - 使用内置的改进标签生成方法...
2025-05-23 21:06:51,417 - scn_phase_space_process - INFO - 处理 100 个有效样本
2025-05-23 21:06:51,466 - scn_phase_space_process - INFO - 特征矩阵形状: (100, 14)
2025-05-23 21:06:51,472 - scn_phase_space_process - INFO - PCA降维: 14 -> 8
2025-05-23 21:06:51,642 - scn_phase_space_process - INFO - 聚类质量 - 轮廓系数: 0.224
2025-05-23 21:06:51,643 - scn_phase_space_process - INFO - 改进标签分布: {np.int32(0): np.int64(21), np.int32(1): np.int64(28), np.int32(2): np.int64(13), np.int32(3): np.int64(13), np.int32(4): np.int64(9), np.int32(5): np.int64(16)}
2025-05-23 21:06:51,643 - scn_phase_space_process - INFO - 最终标签分布: {np.int32(0): np.int64(21), np.int32(1): np.int64(28), np.int32(2): np.int64(13), np.int32(3): np.int64(13), np.int32(4): np.int64(9), np.int32(5): np.int64(16)}
2025-05-23 21:06:51,645 - scn_phase_space_process - INFO - ✓ graphs.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\graphs.csv
2025-05-23 21:06:51,645 - scn_phase_space_process - INFO - 
============================================================
2025-05-23 21:06:51,646 - scn_phase_space_process - INFO - 数据处理流程全部完成!
2025-05-23 21:06:51,646 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:06:51,647 - scn_phase_space_process - INFO - 数据源信息:
2025-05-23 21:06:51,647 - scn_phase_space_process - INFO -   - 文件: datasets/EMtrace01.xlsx
2025-05-23 21:06:51,647 - scn_phase_space_process - INFO -   - 格式: Excel
2025-05-23 21:06:51,648 - scn_phase_space_process - INFO -   - 处理器: ExcelCalciumDataProcessor
2025-05-23 21:06:51,648 - scn_phase_space_process - INFO - 
生成的文件:
2025-05-23 21:06:51,649 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/nodes.csv
2025-05-23 21:06:51,649 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/edges.csv
2025-05-23 21:06:51,650 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/graphs.csv
2025-05-23 21:06:51,650 - scn_phase_space_process - INFO - 
处理结果:
2025-05-23 21:06:51,650 - scn_phase_space_process - INFO -   - 总样本数量: 100
2025-05-23 21:06:51,651 - scn_phase_space_process - INFO -   - 轨迹长度: 170
2025-05-23 21:06:51,651 - scn_phase_space_process - INFO -   - 嵌入维度: 3
2025-05-23 21:06:51,652 - scn_phase_space_process - INFO - 
下一步操作:
2025-05-23 21:06:51,652 - scn_phase_space_process - INFO -   1. 检查生成的CSV文件质量
2025-05-23 21:06:51,652 - scn_phase_space_process - INFO -   2. 运行训练: python main.py 或 python run.py --train
2025-05-23 21:06:51,653 - scn_phase_space_process - INFO -   3. 查看训练结果: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results
2025-05-23 21:06:51,653 - __main__ - INFO - ✓ 数据处理完成
2025-05-23 21:06:51,653 - __main__ - INFO - 操作成功完成
2025-05-23 21:07:29,367 - __main__ - INFO - ============================================================
2025-05-23 21:07:29,368 - __main__ - INFO - 开始模型训练流程
2025-05-23 21:07:29,368 - __main__ - INFO - ============================================================
2025-05-23 21:07:34,923 - main - INFO - ================================================================================
2025-05-23 21:07:34,924 - main - INFO - 脑网络状态分类器训练程序启动 - 改进版本
2025-05-23 21:07:34,924 - main - INFO - 改进内容: Focal Loss + 早停 + 学习率调度 + 梯度裁剪
2025-05-23 21:07:34,924 - main - INFO - ================================================================================
2025-05-23 21:07:34,927 - main - INFO - ✓ 随机种子设置完成
2025-05-23 21:07:34,929 - main - INFO - ✓ 使用GPU: NVIDIA GeForce RTX 4060
2025-05-23 21:07:34,930 - main - INFO - 加载数据集...
2025-05-23 21:07:34,984 - main - INFO - ✓ 数据集加载成功
2025-05-23 21:07:34,984 - main - INFO -   - 训练集批次数: 240
2025-05-23 21:07:34,984 - main - INFO -   - 验证集批次数: 20
2025-05-23 21:07:34,984 - main - INFO -   - 测试集批次数: 19
2025-05-23 21:07:35,028 - __main__ - ERROR - ✗ 模型训练失败: 'BatchNorm' object has no attribute 'weight'
2025-05-23 21:07:35,029 - __main__ - ERROR - 操作失败
2025-05-23 21:08:41,690 - __main__ - INFO - ============================================================
2025-05-23 21:08:41,690 - __main__ - INFO - 开始模型训练流程
2025-05-23 21:08:41,690 - __main__ - INFO - ============================================================
2025-05-23 21:08:46,042 - main - INFO - ================================================================================
2025-05-23 21:08:46,042 - main - INFO - 脑网络状态分类器训练程序启动 - 改进版本
2025-05-23 21:08:46,042 - main - INFO - 改进内容: Focal Loss + 早停 + 学习率调度 + 梯度裁剪
2025-05-23 21:08:46,042 - main - INFO - ================================================================================
2025-05-23 21:08:46,044 - main - INFO - ✓ 随机种子设置完成
2025-05-23 21:08:46,047 - main - INFO - ✓ 使用GPU: NVIDIA GeForce RTX 4060
2025-05-23 21:08:46,047 - main - INFO - 加载数据集...
2025-05-23 21:08:46,102 - main - INFO - ✓ 数据集加载成功
2025-05-23 21:08:46,102 - main - INFO -   - 训练集批次数: 240
2025-05-23 21:08:46,102 - main - INFO -   - 验证集批次数: 20
2025-05-23 21:08:46,102 - main - INFO -   - 测试集批次数: 19
2025-05-23 21:08:46,236 - main - INFO - ✓ 模型创建成功
2025-05-23 21:08:46,237 - main - INFO - 模型架构:
MultiLayerGCN(
  (conv_layers): ModuleList(
    (0): GCNConv(3, 64)
    (1): GCNConv(64, 128)
    (2): GCNConv(128, 128)
    (3): GCNConv(128, 64)
  )
  (batch_norms): ModuleList(
    (0): BatchNorm(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1-2): 2 x BatchNorm(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): BatchNorm(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (pool): ImprovedGlobalPooling(
    (max_pool): AdaptiveMaxPool1d(output_size=1)
    (avg_pool): AdaptiveAvgPool1d(output_size=1)
  )
  (attention): AttentionLayer()
  (classifier): Sequential(
    (fc1): Linear(in_features=1152, out_features=512, bias=False)
    (bn1): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu1): ELU(alpha=1.0)
    (drop1): Dropout(p=0.3, inplace=False)
    (fc2): Linear(in_features=512, out_features=256, bias=False)
    (bn2): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu2): ELU(alpha=1.0)
    (drop2): Dropout(p=0.3, inplace=False)
    (fc3): Linear(in_features=256, out_features=128, bias=False)
    (bn3): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu3): ELU(alpha=1.0)
    (drop3): Dropout(p=0.3, inplace=False)
    (fc_out): Linear(in_features=128, out_features=6, bias=True)
  )
)
2025-05-23 21:08:46,237 - main - INFO - 模型参数总数: 790,726
2025-05-23 21:08:46,237 - main - INFO - 可训练参数: 790,726
2025-05-23 21:08:46,238 - main - INFO - 
开始改进版模型训练...
2025-05-23 21:08:46,238 - main - INFO - ✓ 使用Focal Loss处理类别不平衡问题
2025-05-23 21:08:46,249 - main - INFO - 开始改进版训练，总共 200 个epoch
2025-05-23 21:08:46,249 - main - INFO - 训练技术: Focal Loss + AdamW + 学习率调度 + 早停 + 梯度裁剪
2025-05-23 21:08:46,443 - __main__ - ERROR - ✗ 模型训练失败: Expected more than 1 value per channel when training, got input size torch.Size([1, 512])
2025-05-23 21:08:46,445 - __main__ - ERROR - 操作失败
2025-05-23 21:13:47,008 - __main__ - INFO - ============================================================
2025-05-23 21:13:47,008 - __main__ - INFO - 开始数据处理流程
2025-05-23 21:13:47,009 - __main__ - INFO - ============================================================
2025-05-23 21:13:47,986 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:13:47,986 - scn_phase_space_process - INFO - 3D SCN数据处理流程 - Python版本
2025-05-23 21:13:47,986 - scn_phase_space_process - INFO - 增强版本：支持Excel和MAT格式
2025-05-23 21:13:47,987 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:13:47,987 - scn_phase_space_process - INFO - 输出目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets
2025-05-23 21:13:47,987 - scn_phase_space_process - INFO - 
步骤1: 智能数据加载
2025-05-23 21:13:47,987 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:13:47,988 - scn_phase_space_process - INFO - 正在检测和加载数据文件: datasets/EMtrace01.xlsx
2025-05-23 21:13:47,988 - scn_phase_space_process - INFO - 检测到文件格式: excel
2025-05-23 21:13:47,988 - scn_phase_space_process - INFO - 使用Excel数据处理器加载钙离子数据...
2025-05-23 21:13:47,988 - excel_data_processor - INFO - 正在加载Excel数据文件: datasets\EMtrace01.xlsx
2025-05-23 21:13:48,925 - excel_data_processor - INFO - ✓ 成功加载数据: 2999 个时间点, 43 个神经元
2025-05-23 21:13:48,925 - excel_data_processor - INFO - 神经元列: ['n1', 'n2', 'n3', 'n4', 'n5', 'n6', 'n7', 'n8', 'n9', 'n10']...
2025-05-23 21:13:48,926 - excel_data_processor - INFO - 开始预处理钙离子数据...
2025-05-23 21:13:48,930 - excel_data_processor - WARNING - 检测并处理了 247 个异常值
2025-05-23 21:13:48,931 - excel_data_processor - INFO - 执行Z-score标准化...
2025-05-23 21:13:48,933 - excel_data_processor - INFO - ✓ 数据预处理完成: (2999, 43) -> (2999, 43)
2025-05-23 21:13:48,933 - excel_data_processor - INFO - 转换数据为SCN处理格式...
2025-05-23 21:13:48,934 - excel_data_processor - INFO - 分段参数: 段长度=340, 步长=170
2025-05-23 21:13:48,934 - excel_data_processor - INFO - ✓ 转换完成: 10 个神经元, 平均每个神经元 10.0 个时间段
2025-05-23 21:13:48,935 - scn_phase_space_process - INFO - 数据加载信息:
2025-05-23 21:13:48,936 - scn_phase_space_process - INFO -   文件路径: datasets\EMtrace01.xlsx
2025-05-23 21:13:48,936 - scn_phase_space_process - INFO -   时间点数量: 2999
2025-05-23 21:13:48,936 - scn_phase_space_process - INFO -   神经元数量: 43
2025-05-23 21:13:48,936 - scn_phase_space_process - INFO -   数据形状: (2999, 43)
2025-05-23 21:13:48,937 - scn_phase_space_process - INFO -   时间戳范围: 1 - 2999
2025-05-23 21:13:48,937 - scn_phase_space_process - INFO -   神经元ID: ['n1', 'n2', 'n3', 'n4', 'n5', '...']
2025-05-23 21:13:48,937 - scn_phase_space_process - INFO -   缺失值数量: 0
2025-05-23 21:13:48,937 - scn_phase_space_process - INFO -   数据范围: -1.358 - 4.895
2025-05-23 21:13:48,938 - scn_phase_space_process - INFO -   数据均值: -0.000
2025-05-23 21:13:48,938 - scn_phase_space_process - INFO -   数据标准差: 0.578
2025-05-23 21:13:48,938 - scn_phase_space_process - INFO -   数据格式: Excel
2025-05-23 21:13:48,939 - scn_phase_space_process - INFO -   处理器: ExcelCalciumDataProcessor
2025-05-23 21:13:48,939 - scn_phase_space_process - INFO - 
步骤2: 相空间重构
2025-05-23 21:13:48,939 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:13:48,939 - scn_phase_space_process - INFO - 数据维度: 10 个细胞, 10 个时间线
2025-05-23 21:13:48,939 - scn_phase_space_process - INFO - 开始处理钙信号数据...
2025-05-23 21:13:53,426 - scn_phase_space_process - INFO - ✓ 相空间重构完成
2025-05-23 21:13:53,426 - scn_phase_space_process - INFO - 
步骤3: 数据裁剪
2025-05-23 21:13:53,427 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:13:53,427 - scn_phase_space_process - INFO - 开始裁剪数据到统一长度: 170
2025-05-23 21:13:53,427 - scn_phase_space_process - INFO - ✓ 数据裁剪完成
2025-05-23 21:13:53,427 - scn_phase_space_process - INFO - 
步骤4: 构建图数据集
2025-05-23 21:13:53,428 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:13:53,428 - scn_phase_space_process - INFO - 有效样本数量: 100
2025-05-23 21:13:53,428 - scn_phase_space_process - INFO - 生成 nodes.csv 文件...
2025-05-23 21:13:53,428 - scn_phase_space_process - INFO - 转换节点特征格式...
2025-05-23 21:13:53,499 - scn_phase_space_process - INFO - ✓ nodes.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\nodes.csv
2025-05-23 21:13:53,500 - scn_phase_space_process - INFO - 生成 edges.csv 文件...
2025-05-23 21:13:53,512 - scn_phase_space_process - INFO - ✓ edges.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\edges.csv
2025-05-23 21:13:53,512 - scn_phase_space_process - INFO - 生成 graphs.csv 文件...
2025-05-23 21:13:53,513 - scn_phase_space_process - INFO - 外部模块不可用，使用内置的改进标签生成方法...
2025-05-23 21:13:53,702 - scn_phase_space_process - INFO - 使用内置的改进标签生成方法...
2025-05-23 21:13:53,703 - scn_phase_space_process - INFO - 处理 100 个有效样本
2025-05-23 21:13:53,755 - scn_phase_space_process - INFO - 特征矩阵形状: (100, 14)
2025-05-23 21:13:53,756 - scn_phase_space_process - INFO - PCA降维: 14 -> 8
2025-05-23 21:13:53,916 - scn_phase_space_process - INFO - 聚类质量 - 轮廓系数: 0.224
2025-05-23 21:13:53,916 - scn_phase_space_process - INFO - 改进标签分布: {np.int32(0): np.int64(21), np.int32(1): np.int64(28), np.int32(2): np.int64(13), np.int32(3): np.int64(13), np.int32(4): np.int64(9), np.int32(5): np.int64(16)}
2025-05-23 21:13:53,917 - scn_phase_space_process - INFO - 最终标签分布: {np.int32(0): np.int64(21), np.int32(1): np.int64(28), np.int32(2): np.int64(13), np.int32(3): np.int64(13), np.int32(4): np.int64(9), np.int32(5): np.int64(16)}
2025-05-23 21:13:53,919 - scn_phase_space_process - INFO - ✓ graphs.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\graphs.csv
2025-05-23 21:13:53,919 - scn_phase_space_process - INFO - 
============================================================
2025-05-23 21:13:53,919 - scn_phase_space_process - INFO - 数据处理流程全部完成!
2025-05-23 21:13:53,920 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:13:53,920 - scn_phase_space_process - INFO - 数据源信息:
2025-05-23 21:13:53,920 - scn_phase_space_process - INFO -   - 文件: datasets/EMtrace01.xlsx
2025-05-23 21:13:53,921 - scn_phase_space_process - INFO -   - 格式: Excel
2025-05-23 21:13:53,922 - scn_phase_space_process - INFO -   - 处理器: ExcelCalciumDataProcessor
2025-05-23 21:13:53,922 - scn_phase_space_process - INFO - 
生成的文件:
2025-05-23 21:13:53,922 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/nodes.csv
2025-05-23 21:13:53,923 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/edges.csv
2025-05-23 21:13:53,923 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/graphs.csv
2025-05-23 21:13:53,923 - scn_phase_space_process - INFO - 
处理结果:
2025-05-23 21:13:53,923 - scn_phase_space_process - INFO -   - 总样本数量: 100
2025-05-23 21:13:53,924 - scn_phase_space_process - INFO -   - 轨迹长度: 170
2025-05-23 21:13:53,924 - scn_phase_space_process - INFO -   - 嵌入维度: 3
2025-05-23 21:13:53,924 - scn_phase_space_process - INFO - 
下一步操作:
2025-05-23 21:13:53,925 - scn_phase_space_process - INFO -   1. 检查生成的CSV文件质量
2025-05-23 21:13:53,925 - scn_phase_space_process - INFO -   2. 运行训练: python main.py 或 python run.py --train
2025-05-23 21:13:53,925 - scn_phase_space_process - INFO -   3. 查看训练结果: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results
2025-05-23 21:13:53,926 - __main__ - INFO - ✓ 数据处理完成
2025-05-23 21:13:53,926 - __main__ - INFO - 操作成功完成
2025-05-23 21:14:13,873 - __main__ - INFO - ============================================================
2025-05-23 21:14:13,874 - __main__ - INFO - 开始模型训练流程
2025-05-23 21:14:13,874 - __main__ - INFO - ============================================================
2025-05-23 21:14:18,272 - main - INFO - ================================================================================
2025-05-23 21:14:18,273 - main - INFO - 脑网络状态分类器训练程序启动 - 改进版本
2025-05-23 21:14:18,273 - main - INFO - 改进内容: Focal Loss + 早停 + 学习率调度 + 梯度裁剪
2025-05-23 21:14:18,273 - main - INFO - ================================================================================
2025-05-23 21:14:18,277 - main - INFO - ✓ 随机种子设置完成
2025-05-23 21:14:18,279 - main - INFO - ✓ 使用GPU: NVIDIA GeForce RTX 4060
2025-05-23 21:14:18,280 - main - INFO - 加载数据集...
2025-05-23 21:14:18,334 - main - INFO - ✓ 数据集加载成功
2025-05-23 21:14:18,335 - main - INFO -   - 训练集批次数: 240
2025-05-23 21:14:18,335 - main - INFO -   - 验证集批次数: 20
2025-05-23 21:14:18,335 - main - INFO -   - 测试集批次数: 19
2025-05-23 21:14:18,376 - __main__ - ERROR - ✗ 模型训练失败: 'BatchNorm' object has no attribute 'weight'
2025-05-23 21:14:18,376 - __main__ - ERROR - 操作失败
2025-05-23 21:15:17,569 - __main__ - INFO - ============================================================
2025-05-23 21:15:17,569 - __main__ - INFO - 开始数据处理流程
2025-05-23 21:15:17,569 - __main__ - INFO - ============================================================
2025-05-23 21:15:18,573 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:15:18,574 - scn_phase_space_process - INFO - 3D SCN数据处理流程 - Python版本
2025-05-23 21:15:18,574 - scn_phase_space_process - INFO - 增强版本：支持Excel和MAT格式
2025-05-23 21:15:18,575 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:15:18,575 - scn_phase_space_process - INFO - 输出目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets
2025-05-23 21:15:18,575 - scn_phase_space_process - INFO - 
步骤1: 智能数据加载
2025-05-23 21:15:18,575 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:15:18,575 - scn_phase_space_process - INFO - 正在检测和加载数据文件: datasets/EMtrace01.xlsx
2025-05-23 21:15:18,576 - scn_phase_space_process - INFO - 检测到文件格式: excel
2025-05-23 21:15:18,576 - scn_phase_space_process - INFO - 使用Excel数据处理器加载钙离子数据...
2025-05-23 21:15:18,576 - excel_data_processor - INFO - 正在加载Excel数据文件: datasets\EMtrace01.xlsx
2025-05-23 21:15:19,491 - excel_data_processor - INFO - ✓ 成功加载数据: 2999 个时间点, 43 个神经元
2025-05-23 21:15:19,492 - excel_data_processor - INFO - 神经元列: ['n1', 'n2', 'n3', 'n4', 'n5', 'n6', 'n7', 'n8', 'n9', 'n10']...
2025-05-23 21:15:19,492 - excel_data_processor - INFO - 开始预处理钙离子数据...
2025-05-23 21:15:19,499 - excel_data_processor - WARNING - 检测并处理了 247 个异常值
2025-05-23 21:15:19,499 - excel_data_processor - INFO - 执行Z-score标准化...
2025-05-23 21:15:19,502 - excel_data_processor - INFO - ✓ 数据预处理完成: (2999, 43) -> (2999, 43)
2025-05-23 21:15:19,502 - excel_data_processor - INFO - 转换数据为SCN处理格式...
2025-05-23 21:15:19,502 - excel_data_processor - INFO - 分段参数: 段长度=340, 步长=170
2025-05-23 21:15:19,503 - excel_data_processor - INFO - ✓ 转换完成: 10 个神经元, 平均每个神经元 10.0 个时间段
2025-05-23 21:15:19,504 - scn_phase_space_process - INFO - 数据加载信息:
2025-05-23 21:15:19,505 - scn_phase_space_process - INFO -   文件路径: datasets\EMtrace01.xlsx
2025-05-23 21:15:19,505 - scn_phase_space_process - INFO -   时间点数量: 2999
2025-05-23 21:15:19,505 - scn_phase_space_process - INFO -   神经元数量: 43
2025-05-23 21:15:19,506 - scn_phase_space_process - INFO -   数据形状: (2999, 43)
2025-05-23 21:15:19,506 - scn_phase_space_process - INFO -   时间戳范围: 1 - 2999
2025-05-23 21:15:19,506 - scn_phase_space_process - INFO -   神经元ID: ['n1', 'n2', 'n3', 'n4', 'n5', '...']
2025-05-23 21:15:19,507 - scn_phase_space_process - INFO -   缺失值数量: 0
2025-05-23 21:15:19,507 - scn_phase_space_process - INFO -   数据范围: -1.358 - 4.895
2025-05-23 21:15:19,507 - scn_phase_space_process - INFO -   数据均值: -0.000
2025-05-23 21:15:19,507 - scn_phase_space_process - INFO -   数据标准差: 0.578
2025-05-23 21:15:19,507 - scn_phase_space_process - INFO -   数据格式: Excel
2025-05-23 21:15:19,508 - scn_phase_space_process - INFO -   处理器: ExcelCalciumDataProcessor
2025-05-23 21:15:19,508 - scn_phase_space_process - INFO - 
步骤2: 相空间重构
2025-05-23 21:15:19,508 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:15:19,508 - scn_phase_space_process - INFO - 数据维度: 10 个细胞, 10 个时间线
2025-05-23 21:15:19,508 - scn_phase_space_process - INFO - 开始处理钙信号数据...
2025-05-23 21:15:24,088 - scn_phase_space_process - INFO - ✓ 相空间重构完成
2025-05-23 21:15:24,088 - scn_phase_space_process - INFO - 
步骤3: 数据裁剪
2025-05-23 21:15:24,088 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:15:24,089 - scn_phase_space_process - INFO - 开始裁剪数据到统一长度: 170
2025-05-23 21:15:24,089 - scn_phase_space_process - INFO - ✓ 数据裁剪完成
2025-05-23 21:15:24,089 - scn_phase_space_process - INFO - 
步骤4: 构建图数据集
2025-05-23 21:15:24,089 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:15:24,090 - scn_phase_space_process - INFO - 有效样本数量: 100
2025-05-23 21:15:24,090 - scn_phase_space_process - INFO - 生成 nodes.csv 文件...
2025-05-23 21:15:24,090 - scn_phase_space_process - INFO - 转换节点特征格式...
2025-05-23 21:15:24,162 - scn_phase_space_process - INFO - ✓ nodes.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\nodes.csv
2025-05-23 21:15:24,163 - scn_phase_space_process - INFO - 生成 edges.csv 文件...
2025-05-23 21:15:24,175 - scn_phase_space_process - INFO - ✓ edges.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\edges.csv
2025-05-23 21:15:24,176 - scn_phase_space_process - INFO - 生成 graphs.csv 文件...
2025-05-23 21:15:24,176 - scn_phase_space_process - INFO - 外部模块不可用，使用内置的改进标签生成方法...
2025-05-23 21:15:24,372 - scn_phase_space_process - INFO - 使用内置的改进标签生成方法...
2025-05-23 21:15:24,373 - scn_phase_space_process - INFO - 处理 100 个有效样本
2025-05-23 21:15:24,423 - scn_phase_space_process - INFO - 特征矩阵形状: (100, 14)
2025-05-23 21:15:24,425 - scn_phase_space_process - INFO - PCA降维: 14 -> 8
2025-05-23 21:15:24,599 - scn_phase_space_process - INFO - 聚类质量 - 轮廓系数: 0.224
2025-05-23 21:15:24,599 - scn_phase_space_process - INFO - 改进标签分布: {np.int32(0): np.int64(21), np.int32(1): np.int64(28), np.int32(2): np.int64(13), np.int32(3): np.int64(13), np.int32(4): np.int64(9), np.int32(5): np.int64(16)}
2025-05-23 21:15:24,600 - scn_phase_space_process - INFO - 最终标签分布: {np.int32(0): np.int64(21), np.int32(1): np.int64(28), np.int32(2): np.int64(13), np.int32(3): np.int64(13), np.int32(4): np.int64(9), np.int32(5): np.int64(16)}
2025-05-23 21:15:24,601 - scn_phase_space_process - INFO - ✓ graphs.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\graphs.csv
2025-05-23 21:15:24,602 - scn_phase_space_process - INFO - 
============================================================
2025-05-23 21:15:24,602 - scn_phase_space_process - INFO - 数据处理流程全部完成!
2025-05-23 21:15:24,603 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:15:24,603 - scn_phase_space_process - INFO - 数据源信息:
2025-05-23 21:15:24,603 - scn_phase_space_process - INFO -   - 文件: datasets/EMtrace01.xlsx
2025-05-23 21:15:24,604 - scn_phase_space_process - INFO -   - 格式: Excel
2025-05-23 21:15:24,604 - scn_phase_space_process - INFO -   - 处理器: ExcelCalciumDataProcessor
2025-05-23 21:15:24,604 - scn_phase_space_process - INFO - 
生成的文件:
2025-05-23 21:15:24,605 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/nodes.csv
2025-05-23 21:15:24,605 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/edges.csv
2025-05-23 21:15:24,606 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/graphs.csv
2025-05-23 21:15:24,606 - scn_phase_space_process - INFO - 
处理结果:
2025-05-23 21:15:24,607 - scn_phase_space_process - INFO -   - 总样本数量: 100
2025-05-23 21:15:24,607 - scn_phase_space_process - INFO -   - 轨迹长度: 170
2025-05-23 21:15:24,608 - scn_phase_space_process - INFO -   - 嵌入维度: 3
2025-05-23 21:15:24,608 - scn_phase_space_process - INFO - 
下一步操作:
2025-05-23 21:15:24,609 - scn_phase_space_process - INFO -   1. 检查生成的CSV文件质量
2025-05-23 21:15:24,609 - scn_phase_space_process - INFO -   2. 运行训练: python main.py 或 python run.py --train
2025-05-23 21:15:24,609 - scn_phase_space_process - INFO -   3. 查看训练结果: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results
2025-05-23 21:15:24,610 - __main__ - INFO - ✓ 数据处理完成
2025-05-23 21:15:24,610 - __main__ - INFO - 操作成功完成
2025-05-23 21:15:48,024 - __main__ - INFO - ============================================================
2025-05-23 21:15:48,024 - __main__ - INFO - 开始模型训练流程
2025-05-23 21:15:48,025 - __main__ - INFO - ============================================================
2025-05-23 21:15:52,491 - main - INFO - ================================================================================
2025-05-23 21:15:52,492 - main - INFO - 脑网络状态分类器训练程序启动 - 改进版本
2025-05-23 21:15:52,492 - main - INFO - 改进内容: Focal Loss + 早停 + 学习率调度 + 梯度裁剪
2025-05-23 21:15:52,492 - main - INFO - ================================================================================
2025-05-23 21:15:52,494 - main - INFO - ✓ 随机种子设置完成
2025-05-23 21:15:52,497 - main - INFO - ✓ 使用GPU: NVIDIA GeForce RTX 4060
2025-05-23 21:15:52,497 - main - INFO - 加载数据集...
2025-05-23 21:15:52,552 - main - INFO - ✓ 数据集加载成功
2025-05-23 21:15:52,552 - main - INFO -   - 训练集批次数: 240
2025-05-23 21:15:52,553 - main - INFO -   - 验证集批次数: 20
2025-05-23 21:15:52,553 - main - INFO -   - 测试集批次数: 19
2025-05-23 21:15:52,682 - main - INFO - ✓ 模型创建成功
2025-05-23 21:15:52,683 - main - INFO - 模型架构:
MultiLayerGCN(
  (conv_layers): ModuleList(
    (0): GCNConv(3, 64)
    (1): GCNConv(64, 128)
    (2): GCNConv(128, 128)
    (3): GCNConv(128, 64)
  )
  (batch_norms): ModuleList(
    (0): BatchNorm(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1-2): 2 x BatchNorm(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): BatchNorm(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (pool): ImprovedGlobalPooling(
    (max_pool): AdaptiveMaxPool1d(output_size=1)
    (avg_pool): AdaptiveAvgPool1d(output_size=1)
  )
  (attention): AttentionLayer()
  (classifier): Sequential(
    (fc1): Linear(in_features=1152, out_features=512, bias=False)
    (bn1): BatchNorm1d(512, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu1): ELU(alpha=1.0)
    (drop1): Dropout(p=0.5, inplace=False)
    (fc2): Linear(in_features=512, out_features=256, bias=False)
    (bn2): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu2): ELU(alpha=1.0)
    (drop2): Dropout(p=0.5, inplace=False)
    (fc3): Linear(in_features=256, out_features=128, bias=False)
    (bn3): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (relu3): ELU(alpha=1.0)
    (drop3): Dropout(p=0.5, inplace=False)
    (fc_out): Linear(in_features=128, out_features=6, bias=True)
  )
)
2025-05-23 21:15:52,684 - main - INFO - 模型参数总数: 790,726
2025-05-23 21:15:52,684 - main - INFO - 可训练参数: 790,726
2025-05-23 21:15:52,684 - main - INFO - 
开始改进版模型训练...
2025-05-23 21:15:52,684 - main - INFO - ✓ 使用Focal Loss处理类别不平衡问题
2025-05-23 21:15:52,686 - main - INFO - 开始改进版训练，总共 160 个epoch
2025-05-23 21:15:52,686 - main - INFO - 训练技术: Focal Loss + AdamW + 学习率调度 + 早停 + 梯度裁剪
2025-05-23 21:15:52,874 - __main__ - ERROR - ✗ 模型训练失败: Expected more than 1 value per channel when training, got input size torch.Size([1, 512])
2025-05-23 21:15:52,875 - __main__ - ERROR - 操作失败
2025-05-23 21:18:11,421 - __main__ - INFO - ============================================================
2025-05-23 21:18:11,422 - __main__ - INFO - 开始数据处理流程
2025-05-23 21:18:11,422 - __main__ - INFO - ============================================================
2025-05-23 21:18:12,566 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:18:12,566 - scn_phase_space_process - INFO - 3D SCN数据处理流程 - Python版本
2025-05-23 21:18:12,567 - scn_phase_space_process - INFO - 增强版本：支持Excel和MAT格式
2025-05-23 21:18:12,567 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:18:12,567 - scn_phase_space_process - INFO - 输出目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets
2025-05-23 21:18:12,567 - scn_phase_space_process - INFO - 
步骤1: 智能数据加载
2025-05-23 21:18:12,568 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:18:12,568 - scn_phase_space_process - INFO - 正在检测和加载数据文件: datasets/EMtrace01.xlsx
2025-05-23 21:18:12,568 - scn_phase_space_process - INFO - 检测到文件格式: excel
2025-05-23 21:18:12,568 - scn_phase_space_process - INFO - 使用Excel数据处理器加载钙离子数据...
2025-05-23 21:18:12,569 - excel_data_processor - INFO - 正在加载Excel数据文件: datasets\EMtrace01.xlsx
2025-05-23 21:18:13,543 - excel_data_processor - INFO - ✓ 成功加载数据: 2999 个时间点, 43 个神经元
2025-05-23 21:18:13,543 - excel_data_processor - INFO - 神经元列: ['n1', 'n2', 'n3', 'n4', 'n5', 'n6', 'n7', 'n8', 'n9', 'n10']...
2025-05-23 21:18:13,543 - excel_data_processor - INFO - 开始预处理钙离子数据...
2025-05-23 21:18:13,549 - excel_data_processor - WARNING - 检测并处理了 247 个异常值
2025-05-23 21:18:13,549 - excel_data_processor - INFO - 执行Z-score标准化...
2025-05-23 21:18:13,554 - excel_data_processor - INFO - ✓ 数据预处理完成: (2999, 43) -> (2999, 43)
2025-05-23 21:18:13,554 - excel_data_processor - INFO - 转换数据为SCN处理格式...
2025-05-23 21:18:13,554 - excel_data_processor - INFO - 分段参数: 段长度=340, 步长=170
2025-05-23 21:18:13,555 - excel_data_processor - INFO - ✓ 转换完成: 10 个神经元, 平均每个神经元 10.0 个时间段
2025-05-23 21:18:13,557 - scn_phase_space_process - INFO - 数据加载信息:
2025-05-23 21:18:13,557 - scn_phase_space_process - INFO -   文件路径: datasets\EMtrace01.xlsx
2025-05-23 21:18:13,558 - scn_phase_space_process - INFO -   时间点数量: 2999
2025-05-23 21:18:13,558 - scn_phase_space_process - INFO -   神经元数量: 43
2025-05-23 21:18:13,558 - scn_phase_space_process - INFO -   数据形状: (2999, 43)
2025-05-23 21:18:13,559 - scn_phase_space_process - INFO -   时间戳范围: 1 - 2999
2025-05-23 21:18:13,559 - scn_phase_space_process - INFO -   神经元ID: ['n1', 'n2', 'n3', 'n4', 'n5', '...']
2025-05-23 21:18:13,559 - scn_phase_space_process - INFO -   缺失值数量: 0
2025-05-23 21:18:13,560 - scn_phase_space_process - INFO -   数据范围: -1.358 - 4.895
2025-05-23 21:18:13,560 - scn_phase_space_process - INFO -   数据均值: -0.000
2025-05-23 21:18:13,560 - scn_phase_space_process - INFO -   数据标准差: 0.578
2025-05-23 21:18:13,561 - scn_phase_space_process - INFO -   数据格式: Excel
2025-05-23 21:18:13,561 - scn_phase_space_process - INFO -   处理器: ExcelCalciumDataProcessor
2025-05-23 21:18:13,561 - scn_phase_space_process - INFO - 
步骤2: 相空间重构
2025-05-23 21:18:13,561 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:18:13,562 - scn_phase_space_process - INFO - 数据维度: 10 个细胞, 10 个时间线
2025-05-23 21:18:13,562 - scn_phase_space_process - INFO - 开始处理钙信号数据...
2025-05-23 21:18:18,209 - scn_phase_space_process - INFO - ✓ 相空间重构完成
2025-05-23 21:18:18,210 - scn_phase_space_process - INFO - 
步骤3: 数据裁剪
2025-05-23 21:18:18,210 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:18:18,210 - scn_phase_space_process - INFO - 开始裁剪数据到统一长度: 170
2025-05-23 21:18:18,210 - scn_phase_space_process - INFO - ✓ 数据裁剪完成
2025-05-23 21:18:18,211 - scn_phase_space_process - INFO - 
步骤4: 构建图数据集
2025-05-23 21:18:18,211 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:18:18,211 - scn_phase_space_process - INFO - 有效样本数量: 100
2025-05-23 21:18:18,212 - scn_phase_space_process - INFO - 生成 nodes.csv 文件...
2025-05-23 21:18:18,212 - scn_phase_space_process - INFO - 转换节点特征格式...
2025-05-23 21:18:18,289 - scn_phase_space_process - INFO - ✓ nodes.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\nodes.csv
2025-05-23 21:18:18,289 - scn_phase_space_process - INFO - 生成 edges.csv 文件...
2025-05-23 21:18:18,303 - scn_phase_space_process - INFO - ✓ edges.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\edges.csv
2025-05-23 21:18:18,303 - scn_phase_space_process - INFO - 生成 graphs.csv 文件...
2025-05-23 21:18:18,304 - scn_phase_space_process - INFO - 外部模块不可用，使用内置的改进标签生成方法...
2025-05-23 21:18:18,509 - scn_phase_space_process - INFO - 使用内置的改进标签生成方法...
2025-05-23 21:18:18,509 - scn_phase_space_process - INFO - 处理 100 个有效样本
2025-05-23 21:18:18,559 - scn_phase_space_process - INFO - 特征矩阵形状: (100, 14)
2025-05-23 21:18:18,561 - scn_phase_space_process - INFO - PCA降维: 14 -> 8
2025-05-23 21:18:18,737 - scn_phase_space_process - INFO - 聚类质量 - 轮廓系数: 0.224
2025-05-23 21:18:18,737 - scn_phase_space_process - INFO - 改进标签分布: {np.int32(0): np.int64(21), np.int32(1): np.int64(28), np.int32(2): np.int64(13), np.int32(3): np.int64(13), np.int32(4): np.int64(9), np.int32(5): np.int64(16)}
2025-05-23 21:18:18,738 - scn_phase_space_process - INFO - 最终标签分布: {np.int32(0): np.int64(21), np.int32(1): np.int64(28), np.int32(2): np.int64(13), np.int32(3): np.int64(13), np.int32(4): np.int64(9), np.int32(5): np.int64(16)}
2025-05-23 21:18:18,740 - scn_phase_space_process - INFO - ✓ graphs.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\graphs.csv
2025-05-23 21:18:18,740 - scn_phase_space_process - INFO - 
============================================================
2025-05-23 21:18:18,741 - scn_phase_space_process - INFO - 数据处理流程全部完成!
2025-05-23 21:18:18,741 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:18:18,741 - scn_phase_space_process - INFO - 数据源信息:
2025-05-23 21:18:18,742 - scn_phase_space_process - INFO -   - 文件: datasets/EMtrace01.xlsx
2025-05-23 21:18:18,742 - scn_phase_space_process - INFO -   - 格式: Excel
2025-05-23 21:18:18,743 - scn_phase_space_process - INFO -   - 处理器: ExcelCalciumDataProcessor
2025-05-23 21:18:18,743 - scn_phase_space_process - INFO - 
生成的文件:
2025-05-23 21:18:18,743 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/nodes.csv
2025-05-23 21:18:18,744 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/edges.csv
2025-05-23 21:18:18,744 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/graphs.csv
2025-05-23 21:18:18,744 - scn_phase_space_process - INFO - 
处理结果:
2025-05-23 21:18:18,745 - scn_phase_space_process - INFO -   - 总样本数量: 100
2025-05-23 21:18:18,745 - scn_phase_space_process - INFO -   - 轨迹长度: 170
2025-05-23 21:18:18,746 - scn_phase_space_process - INFO -   - 嵌入维度: 3
2025-05-23 21:18:18,746 - scn_phase_space_process - INFO - 
下一步操作:
2025-05-23 21:18:18,746 - scn_phase_space_process - INFO -   1. 检查生成的CSV文件质量
2025-05-23 21:18:18,747 - scn_phase_space_process - INFO -   2. 运行训练: python main.py 或 python run.py --train
2025-05-23 21:18:18,747 - scn_phase_space_process - INFO -   3. 查看训练结果: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results
2025-05-23 21:18:18,748 - __main__ - INFO - ✓ 数据处理完成
2025-05-23 21:18:18,748 - __main__ - INFO - 操作成功完成
2025-05-23 21:18:30,247 - __main__ - INFO - ============================================================
2025-05-23 21:18:30,247 - __main__ - INFO - 开始模型训练流程
2025-05-23 21:18:30,248 - __main__ - INFO - ============================================================
2025-05-23 21:18:33,873 - __main__ - INFO - ============================================================
2025-05-23 21:18:33,873 - __main__ - INFO - 开始模型训练流程
2025-05-23 21:18:33,873 - __main__ - INFO - ============================================================
2025-05-23 21:18:34,835 - main - INFO - ================================================================================
2025-05-23 21:18:34,836 - main - INFO - 脑网络状态分类器训练程序启动 - 改进版本
2025-05-23 21:18:34,836 - main - INFO - 改进内容: Focal Loss + 早停 + 学习率调度 + 梯度裁剪
2025-05-23 21:18:34,837 - main - INFO - ================================================================================
2025-05-23 21:18:34,839 - main - INFO - ✓ 随机种子设置完成
2025-05-23 21:18:34,842 - main - INFO - ✓ 使用GPU: NVIDIA GeForce RTX 4060
2025-05-23 21:18:34,842 - main - INFO - 加载数据集...
2025-05-23 21:18:34,906 - main - INFO - ✓ 数据集加载成功
2025-05-23 21:18:34,906 - main - INFO -   - 训练集批次数: 240
2025-05-23 21:18:34,907 - main - INFO -   - 验证集批次数: 20
2025-05-23 21:18:34,907 - main - INFO -   - 测试集批次数: 19
2025-05-23 21:18:35,048 - main - INFO - ✓ 模型创建成功
2025-05-23 21:18:35,049 - main - INFO - 模型架构:
MultiLayerGCN(
  (conv_layers): ModuleList(
    (0): GCNConv(3, 64)
    (1): GCNConv(64, 128)
    (2): GCNConv(128, 128)
    (3): GCNConv(128, 64)
  )
  (batch_norms): ModuleList(
    (0): BatchNorm(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1-2): 2 x BatchNorm(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): BatchNorm(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (pool): ImprovedGlobalPooling(
    (max_pool): AdaptiveMaxPool1d(output_size=1)
    (avg_pool): AdaptiveAvgPool1d(output_size=1)
  )
  (attention): AttentionLayer()
  (classifier): Sequential(
    (fc1): Linear(in_features=1152, out_features=512, bias=False)
    (ln1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (relu1): ELU(alpha=1.0)
    (drop1): Dropout(p=0.5, inplace=False)
    (fc2): Linear(in_features=512, out_features=256, bias=False)
    (ln2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
    (relu2): ELU(alpha=1.0)
    (drop2): Dropout(p=0.5, inplace=False)
    (fc3): Linear(in_features=256, out_features=128, bias=False)
    (ln3): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    (relu3): ELU(alpha=1.0)
    (drop3): Dropout(p=0.5, inplace=False)
    (fc_out): Linear(in_features=128, out_features=6, bias=True)
  )
)
2025-05-23 21:18:35,050 - main - INFO - 模型参数总数: 790,726
2025-05-23 21:18:35,050 - main - INFO - 可训练参数: 790,726
2025-05-23 21:18:35,050 - main - INFO - 
开始改进版模型训练...
2025-05-23 21:18:35,050 - main - INFO - ✓ 使用Focal Loss处理类别不平衡问题
2025-05-23 21:18:35,051 - main - INFO - 开始改进版训练，总共 160 个epoch
2025-05-23 21:18:35,051 - main - INFO - 训练技术: Focal Loss + AdamW + 学习率调度 + 早停 + 梯度裁剪
2025-05-23 21:18:37,612 - main - INFO - Epoch 1 训练损失: 2.1060
2025-05-23 21:18:37,712 - main - INFO - Epoch 1/160 - 训练损失: 2.1060, 验证损失: 1.9960, 验证准确率: 0.2500, 最佳准确率: 0.2500 (Epoch 1), 学习率: 1.00e-03
2025-05-23 21:18:38,487 - main - INFO - ================================================================================
2025-05-23 21:18:38,488 - main - INFO - 脑网络状态分类器训练程序启动 - 改进版本
2025-05-23 21:18:38,488 - main - INFO - 改进内容: Focal Loss + 早停 + 学习率调度 + 梯度裁剪
2025-05-23 21:18:38,488 - main - INFO - ================================================================================
2025-05-23 21:18:38,491 - main - INFO - ✓ 随机种子设置完成
2025-05-23 21:18:38,494 - main - INFO - ✓ 使用GPU: NVIDIA GeForce RTX 4060
2025-05-23 21:18:38,495 - main - INFO - 加载数据集...
2025-05-23 21:18:38,559 - main - INFO - ✓ 数据集加载成功
2025-05-23 21:18:38,560 - main - INFO -   - 训练集批次数: 240
2025-05-23 21:18:38,560 - main - INFO -   - 验证集批次数: 20
2025-05-23 21:18:38,560 - main - INFO -   - 测试集批次数: 19
2025-05-23 21:18:38,696 - main - INFO - ✓ 模型创建成功
2025-05-23 21:18:38,697 - main - INFO - 模型架构:
MultiLayerGCN(
  (conv_layers): ModuleList(
    (0): GCNConv(3, 64)
    (1): GCNConv(64, 128)
    (2): GCNConv(128, 128)
    (3): GCNConv(128, 64)
  )
  (batch_norms): ModuleList(
    (0): BatchNorm(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (1-2): 2 x BatchNorm(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (3): BatchNorm(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
  )
  (pool): ImprovedGlobalPooling(
    (max_pool): AdaptiveMaxPool1d(output_size=1)
    (avg_pool): AdaptiveAvgPool1d(output_size=1)
  )
  (attention): AttentionLayer()
  (classifier): Sequential(
    (fc1): Linear(in_features=1152, out_features=512, bias=False)
    (ln1): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
    (relu1): ELU(alpha=1.0)
    (drop1): Dropout(p=0.5, inplace=False)
    (fc2): Linear(in_features=512, out_features=256, bias=False)
    (ln2): LayerNorm((256,), eps=1e-05, elementwise_affine=True)
    (relu2): ELU(alpha=1.0)
    (drop2): Dropout(p=0.5, inplace=False)
    (fc3): Linear(in_features=256, out_features=128, bias=False)
    (ln3): LayerNorm((128,), eps=1e-05, elementwise_affine=True)
    (relu3): ELU(alpha=1.0)
    (drop3): Dropout(p=0.5, inplace=False)
    (fc_out): Linear(in_features=128, out_features=6, bias=True)
  )
)
2025-05-23 21:18:38,698 - main - INFO - 模型参数总数: 790,726
2025-05-23 21:18:38,698 - main - INFO - 可训练参数: 790,726
2025-05-23 21:18:38,699 - main - INFO - 
开始改进版模型训练...
2025-05-23 21:18:38,699 - main - INFO - ✓ 使用Focal Loss处理类别不平衡问题
2025-05-23 21:18:38,700 - main - INFO - 开始改进版训练，总共 160 个epoch
2025-05-23 21:18:38,701 - main - INFO - 训练技术: Focal Loss + AdamW + 学习率调度 + 早停 + 梯度裁剪
2025-05-23 21:18:39,988 - main - INFO - Epoch 2 训练损失: 1.8712
2025-05-23 21:18:40,079 - main - INFO - Epoch 2/160 - 训练损失: 1.8712, 验证损失: 1.5862, 验证准确率: 0.2500, 最佳准确率: 0.2500 (Epoch 1), 学习率: 1.00e-03
2025-05-23 21:18:41,262 - main - INFO - Epoch 1 训练损失: 2.1060
2025-05-23 21:18:41,373 - main - INFO - Epoch 1/160 - 训练损失: 2.1060, 验证损失: 1.9960, 验证准确率: 0.2500, 最佳准确率: 0.2500 (Epoch 1), 学习率: 1.00e-03
2025-05-23 21:18:42,194 - main - INFO - Epoch 3 训练损失: 1.6418
2025-05-23 21:18:42,304 - main - INFO - Epoch 3/160 - 训练损失: 1.6418, 验证损失: 1.5963, 验证准确率: 0.2500, 最佳准确率: 0.2500 (Epoch 1), 学习率: 1.00e-03
2025-05-23 21:18:43,566 - main - INFO - Epoch 2 训练损失: 1.8712
2025-05-23 21:18:43,684 - main - INFO - Epoch 2/160 - 训练损失: 1.8712, 验证损失: 1.5862, 验证准确率: 0.2500, 最佳准确率: 0.2500 (Epoch 1), 学习率: 1.00e-03
2025-05-23 21:18:44,407 - main - INFO - Epoch 4 训练损失: 1.5663
2025-05-23 21:18:44,511 - main - INFO - Epoch 4/160 - 训练损失: 1.5663, 验证损失: 1.6224, 验证准确率: 0.2500, 最佳准确率: 0.2500 (Epoch 1), 学习率: 1.00e-03
2025-05-23 21:18:45,918 - main - INFO - Epoch 3 训练损失: 1.6418
2025-05-23 21:18:46,019 - main - INFO - Epoch 3/160 - 训练损失: 1.6418, 验证损失: 1.5963, 验证准确率: 0.2500, 最佳准确率: 0.2500 (Epoch 1), 学习率: 1.00e-03
2025-05-23 21:18:46,601 - main - INFO - Epoch 5 训练损失: 1.3733
2025-05-23 21:18:46,703 - main - INFO - Epoch 5/160 - 训练损失: 1.3733, 验证损失: 1.3167, 验证准确率: 0.2500, 最佳准确率: 0.2500 (Epoch 1), 学习率: 1.00e-03
2025-05-23 21:18:48,192 - main - INFO - Epoch 4 训练损失: 1.5663
2025-05-23 21:18:48,301 - main - INFO - Epoch 4/160 - 训练损失: 1.5663, 验证损失: 1.6224, 验证准确率: 0.2500, 最佳准确率: 0.2500 (Epoch 1), 学习率: 1.00e-03
2025-05-23 21:18:48,865 - main - INFO - Epoch 6 训练损失: 1.3509
2025-05-23 21:18:48,971 - main - INFO - Epoch 6/160 - 训练损失: 1.3509, 验证损失: 1.7671, 验证准确率: 0.2500, 最佳准确率: 0.2500 (Epoch 1), 学习率: 1.00e-03
2025-05-23 21:18:50,397 - main - INFO - Epoch 5 训练损失: 1.3733
2025-05-23 21:18:50,501 - main - INFO - Epoch 5/160 - 训练损失: 1.3733, 验证损失: 1.3167, 验证准确率: 0.2500, 最佳准确率: 0.2500 (Epoch 1), 学习率: 1.00e-03
2025-05-23 21:18:51,189 - main - INFO - Epoch 7 训练损失: 1.4330
2025-05-23 21:18:51,285 - main - INFO - Epoch 7/160 - 训练损失: 1.4330, 验证损失: 1.2775, 验证准确率: 0.2000, 最佳准确率: 0.2500 (Epoch 1), 学习率: 1.00e-03
2025-05-23 21:18:52,650 - main - INFO - Epoch 6 训练损失: 1.3509
2025-05-23 21:18:52,745 - main - INFO - Epoch 6/160 - 训练损失: 1.3509, 验证损失: 1.7671, 验证准确率: 0.2500, 最佳准确率: 0.2500 (Epoch 1), 学习率: 1.00e-03
2025-05-23 21:18:53,485 - main - INFO - Epoch 8 训练损失: 1.2726
2025-05-23 21:18:53,585 - main - INFO - Epoch 8/160 - 训练损失: 1.2726, 验证损失: 1.4163, 验证准确率: 0.2500, 最佳准确率: 0.2500 (Epoch 1), 学习率: 1.00e-03
2025-05-23 21:18:55,714 - main - INFO - Epoch 9 训练损失: 1.2215
2025-05-23 21:18:55,807 - main - INFO - Epoch 9/160 - 训练损失: 1.2215, 验证损失: 1.4956, 验证准确率: 0.0000, 最佳准确率: 0.2500 (Epoch 1), 学习率: 1.00e-03
2025-05-23 21:18:57,742 - main - INFO - Epoch 10 训练损失: 1.2095
2025-05-23 21:18:57,827 - main - INFO - Epoch 10/160 - 训练损失: 1.2095, 验证损失: 1.2185, 验证准确率: 0.2500, 最佳准确率: 0.2500 (Epoch 1), 学习率: 1.00e-03
2025-05-23 21:18:59,809 - main - INFO - Epoch 11 训练损失: 1.1343
2025-05-23 21:18:59,891 - main - INFO - Epoch 11/160 - 训练损失: 1.1343, 验证损失: 1.6297, 验证准确率: 0.3000, 最佳准确率: 0.3000 (Epoch 11), 学习率: 1.00e-03
2025-05-23 21:19:01,868 - main - INFO - Epoch 12 训练损失: 1.0938
2025-05-23 21:19:01,955 - main - INFO - Epoch 12/160 - 训练损失: 1.0938, 验证损失: 2.0576, 验证准确率: 0.2500, 最佳准确率: 0.3000 (Epoch 11), 学习率: 1.00e-03
2025-05-23 21:19:04,157 - main - INFO - Epoch 13 训练损失: 1.1324
2025-05-23 21:19:04,263 - main - INFO - Epoch 13/160 - 训练损失: 1.1324, 验证损失: 2.1859, 验证准确率: 0.2500, 最佳准确率: 0.3000 (Epoch 11), 学习率: 1.00e-03
2025-05-23 21:19:06,432 - main - INFO - Epoch 14 训练损失: 1.1596
2025-05-23 21:19:06,531 - main - INFO - Epoch 14/160 - 训练损失: 1.1596, 验证损失: 2.2679, 验证准确率: 0.3500, 最佳准确率: 0.3500 (Epoch 14), 学习率: 1.00e-03
2025-05-23 21:19:08,699 - main - INFO - Epoch 15 训练损失: 1.0992
2025-05-23 21:19:08,788 - main - INFO - Epoch 15/160 - 训练损失: 1.0992, 验证损失: 1.8099, 验证准确率: 0.3500, 最佳准确率: 0.3500 (Epoch 14), 学习率: 1.00e-03
2025-05-23 21:19:10,873 - main - INFO - Epoch 16 训练损失: 1.0791
2025-05-23 21:19:10,958 - main - INFO - Epoch 16/160 - 训练损失: 1.0791, 验证损失: 1.7804, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 14), 学习率: 5.00e-04
2025-05-23 21:19:13,084 - main - INFO - Epoch 17 训练损失: 0.9496
2025-05-23 21:19:13,168 - main - INFO - Epoch 17/160 - 训练损失: 0.9496, 验证损失: 3.4458, 验证准确率: 0.3500, 最佳准确率: 0.3500 (Epoch 14), 学习率: 5.00e-04
2025-05-23 21:19:15,108 - main - INFO - Epoch 18 训练损失: 0.9028
2025-05-23 21:19:15,197 - main - INFO - Epoch 18/160 - 训练损失: 0.9028, 验证损失: 2.3571, 验证准确率: 0.3000, 最佳准确率: 0.3500 (Epoch 14), 学习率: 5.00e-04
2025-05-23 21:19:17,195 - main - INFO - Epoch 19 训练损失: 1.0666
2025-05-23 21:19:17,284 - main - INFO - Epoch 19/160 - 训练损失: 1.0666, 验证损失: 3.5364, 验证准确率: 0.2500, 最佳准确率: 0.3500 (Epoch 14), 学习率: 5.00e-04
2025-05-23 21:19:19,232 - main - INFO - Epoch 20 训练损失: 1.0057
2025-05-23 21:19:19,326 - main - INFO - Epoch 20/160 - 训练损失: 1.0057, 验证损失: 2.9058, 验证准确率: 0.1000, 最佳准确率: 0.3500 (Epoch 14), 学习率: 5.00e-04
2025-05-23 21:19:21,240 - main - INFO - Epoch 21 训练损失: 1.0581
2025-05-23 21:19:21,344 - main - INFO - Epoch 21/160 - 训练损失: 1.0581, 验证损失: 3.1771, 验证准确率: 0.3500, 最佳准确率: 0.3500 (Epoch 14), 学习率: 5.00e-04
2025-05-23 21:19:23,271 - main - INFO - Epoch 22 训练损失: 0.8824
2025-05-23 21:19:23,370 - main - INFO - Epoch 22/160 - 训练损失: 0.8824, 验证损失: 3.1591, 验证准确率: 0.4000, 最佳准确率: 0.4000 (Epoch 22), 学习率: 2.50e-04
2025-05-23 21:19:25,291 - main - INFO - Epoch 23 训练损失: 0.7788
2025-05-23 21:19:25,376 - main - INFO - Epoch 23/160 - 训练损失: 0.7788, 验证损失: 3.4325, 验证准确率: 0.3000, 最佳准确率: 0.4000 (Epoch 22), 学习率: 2.50e-04
2025-05-23 21:19:27,297 - main - INFO - Epoch 24 训练损失: 1.0164
2025-05-23 21:19:27,393 - main - INFO - Epoch 24/160 - 训练损失: 1.0164, 验证损失: 3.4628, 验证准确率: 0.3000, 最佳准确率: 0.4000 (Epoch 22), 学习率: 2.50e-04
2025-05-23 21:19:29,424 - main - INFO - Epoch 25 训练损失: 0.9079
2025-05-23 21:19:29,515 - main - INFO - Epoch 25/160 - 训练损失: 0.9079, 验证损失: 3.6440, 验证准确率: 0.3500, 最佳准确率: 0.4000 (Epoch 22), 学习率: 2.50e-04
2025-05-23 21:19:29,516 - main - INFO - 早停触发，在第 25 个epoch停止训练
2025-05-23 21:19:29,516 - main - INFO - 最佳验证准确率: 0.4000 (Epoch 22)
2025-05-23 21:19:29,524 - main - INFO - 最佳模型已保存至: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results\best_scn.pt
2025-05-23 21:19:29,525 - main - INFO - 
在测试集上评估最终性能...
2025-05-23 21:19:29,609 - main - INFO - ================================================================================
2025-05-23 21:19:29,610 - main - INFO - 最终测试结果:
2025-05-23 21:19:29,610 - main - INFO -   测试损失: 3.2128
2025-05-23 21:19:29,611 - main - INFO -   测试准确率: 0.3158
2025-05-23 21:19:29,611 - main - INFO -   测试平衡准确率: 0.1944
2025-05-23 21:19:29,611 - main - INFO - ================================================================================
2025-05-23 21:19:29,611 - main - INFO - 详细分类报告:
2025-05-23 21:19:29,611 - main - INFO - 
              precision    recall  f1-score   support

        状态_0     0.1667    0.3333    0.2222         3
        状态_1     0.5000    0.8333    0.6250         6
        状态_2     0.0000    0.0000    0.0000         4
        状态_3     0.0000    0.0000    0.0000         1
        状态_4     0.0000    0.0000    0.0000         1
        状态_5     0.0000    0.0000    0.0000         4

    accuracy                         0.3158        19
   macro avg     0.1111    0.1944    0.1412        19
weighted avg     0.1842    0.3158    0.2325        19

2025-05-23 21:19:29,611 - main - INFO - ================================================================================
2025-05-23 21:19:29,611 - main - INFO - 性能分析:
2025-05-23 21:19:29,611 - main - INFO -   最佳训练epoch: 22
2025-05-23 21:19:29,612 - main - INFO -   最佳验证准确率: 0.4000
2025-05-23 21:19:29,612 - main - INFO -   最终测试准确率: 0.3158
2025-05-23 21:19:29,613 - main - INFO -   相对于随机分类的提升: 89.1%
2025-05-23 21:19:29,613 - __main__ - INFO - ✓ 模型训练完成
2025-05-23 21:19:29,613 - __main__ - INFO - 最终测试准确率: 0.3158
2025-05-23 21:19:29,613 - __main__ - INFO - 平均类别准确率: 0.1944
2025-05-23 21:19:29,613 - __main__ - INFO - 操作成功完成
2025-05-23 21:31:37,921 - __main__ - INFO - ============================================================
2025-05-23 21:31:37,921 - __main__ - INFO - 开始数据处理流程
2025-05-23 21:31:37,922 - __main__ - INFO - ============================================================
2025-05-23 21:31:38,911 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:31:38,911 - scn_phase_space_process - INFO - 3D SCN数据处理流程 - Python版本
2025-05-23 21:31:38,911 - scn_phase_space_process - INFO - 增强版本：支持Excel和MAT格式
2025-05-23 21:31:38,912 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:31:38,912 - scn_phase_space_process - INFO - 输出目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets
2025-05-23 21:31:38,912 - scn_phase_space_process - INFO - 
步骤1: 智能数据加载
2025-05-23 21:31:38,912 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:31:38,913 - scn_phase_space_process - INFO - 正在检测和加载数据文件: datasets/EMtrace01.xlsx
2025-05-23 21:31:38,914 - scn_phase_space_process - INFO - 检测到文件格式: excel
2025-05-23 21:31:38,915 - scn_phase_space_process - INFO - 使用Excel数据处理器加载钙离子数据...
2025-05-23 21:31:38,915 - excel_data_processor - INFO - 正在加载Excel数据文件: datasets\EMtrace01.xlsx
2025-05-23 21:31:39,851 - excel_data_processor - INFO - ✓ 成功加载数据: 2999 个时间点, 43 个神经元
2025-05-23 21:31:39,851 - excel_data_processor - INFO - 神经元列: ['n1', 'n2', 'n3', 'n4', 'n5', 'n6', 'n7', 'n8', 'n9', 'n10']...
2025-05-23 21:31:39,851 - excel_data_processor - INFO - 开始预处理钙离子数据...
2025-05-23 21:31:39,856 - excel_data_processor - WARNING - 检测并处理了 247 个异常值
2025-05-23 21:31:39,856 - excel_data_processor - INFO - 执行Z-score标准化...
2025-05-23 21:31:39,858 - excel_data_processor - INFO - ✓ 数据预处理完成: (2999, 43) -> (2999, 43)
2025-05-23 21:31:39,859 - excel_data_processor - INFO - 转换数据为SCN处理格式...
2025-05-23 21:31:39,859 - excel_data_processor - INFO - 分段参数: 段长度=340, 步长=170
2025-05-23 21:31:39,859 - excel_data_processor - INFO - ✓ 转换完成: 10 个神经元, 平均每个神经元 10.0 个时间段
2025-05-23 21:31:39,861 - scn_phase_space_process - INFO - 数据加载信息:
2025-05-23 21:31:39,861 - scn_phase_space_process - INFO -   文件路径: datasets\EMtrace01.xlsx
2025-05-23 21:31:39,861 - scn_phase_space_process - INFO -   时间点数量: 2999
2025-05-23 21:31:39,862 - scn_phase_space_process - INFO -   神经元数量: 43
2025-05-23 21:31:39,862 - scn_phase_space_process - INFO -   数据形状: (2999, 43)
2025-05-23 21:31:39,862 - scn_phase_space_process - INFO -   时间戳范围: 1 - 2999
2025-05-23 21:31:39,863 - scn_phase_space_process - INFO -   神经元ID: ['n1', 'n2', 'n3', 'n4', 'n5', '...']
2025-05-23 21:31:39,863 - scn_phase_space_process - INFO -   缺失值数量: 0
2025-05-23 21:31:39,864 - scn_phase_space_process - INFO -   数据范围: -1.358 - 4.895
2025-05-23 21:31:39,864 - scn_phase_space_process - INFO -   数据均值: -0.000
2025-05-23 21:31:39,864 - scn_phase_space_process - INFO -   数据标准差: 0.578
2025-05-23 21:31:39,865 - scn_phase_space_process - INFO -   数据格式: Excel
2025-05-23 21:31:39,865 - scn_phase_space_process - INFO -   处理器: ExcelCalciumDataProcessor
2025-05-23 21:31:39,865 - scn_phase_space_process - INFO - 
步骤2: 相空间重构
2025-05-23 21:31:39,866 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:31:39,866 - scn_phase_space_process - INFO - 数据维度: 10 个细胞, 10 个时间线
2025-05-23 21:31:39,866 - scn_phase_space_process - INFO - 开始处理钙信号数据...
2025-05-23 21:31:44,483 - scn_phase_space_process - INFO - ✓ 相空间重构完成
2025-05-23 21:31:44,483 - scn_phase_space_process - INFO - 
步骤3: 数据裁剪
2025-05-23 21:31:44,483 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:31:44,483 - scn_phase_space_process - INFO - 开始裁剪数据到统一长度: 170
2025-05-23 21:31:44,483 - scn_phase_space_process - INFO - ✓ 数据裁剪完成
2025-05-23 21:31:44,484 - scn_phase_space_process - INFO - 
步骤4: 构建图数据集
2025-05-23 21:31:44,484 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:31:44,484 - scn_phase_space_process - INFO - 有效样本数量: 100
2025-05-23 21:31:44,484 - scn_phase_space_process - INFO - 生成 nodes.csv 文件...
2025-05-23 21:31:44,485 - scn_phase_space_process - INFO - 转换节点特征格式...
2025-05-23 21:31:44,562 - scn_phase_space_process - INFO - ✓ nodes.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\nodes.csv
2025-05-23 21:31:44,563 - scn_phase_space_process - INFO - 生成 edges.csv 文件...
2025-05-23 21:31:44,575 - scn_phase_space_process - INFO - ✓ edges.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\edges.csv
2025-05-23 21:31:44,575 - scn_phase_space_process - INFO - 生成 graphs.csv 文件...
2025-05-23 21:31:44,576 - scn_phase_space_process - INFO - 外部模块不可用，使用内置的改进标签生成方法...
2025-05-23 21:31:44,777 - scn_phase_space_process - INFO - 使用内置的改进标签生成方法...
2025-05-23 21:31:44,778 - scn_phase_space_process - INFO - 处理 100 个有效样本
2025-05-23 21:31:44,827 - scn_phase_space_process - INFO - 特征矩阵形状: (100, 14)
2025-05-23 21:31:44,828 - scn_phase_space_process - INFO - PCA降维: 14 -> 8
2025-05-23 21:31:45,004 - scn_phase_space_process - INFO - 聚类质量 - 轮廓系数: 0.224
2025-05-23 21:31:45,005 - scn_phase_space_process - INFO - 改进标签分布: {np.int32(0): np.int64(21), np.int32(1): np.int64(28), np.int32(2): np.int64(13), np.int32(3): np.int64(13), np.int32(4): np.int64(9), np.int32(5): np.int64(16)}
2025-05-23 21:31:45,005 - scn_phase_space_process - INFO - 最终标签分布: {np.int32(0): np.int64(21), np.int32(1): np.int64(28), np.int32(2): np.int64(13), np.int32(3): np.int64(13), np.int32(4): np.int64(9), np.int32(5): np.int64(16)}
2025-05-23 21:31:45,007 - scn_phase_space_process - INFO - ✓ graphs.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\graphs.csv
2025-05-23 21:31:45,007 - scn_phase_space_process - INFO - 
============================================================
2025-05-23 21:31:45,008 - scn_phase_space_process - INFO - 数据处理流程全部完成!
2025-05-23 21:31:45,008 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:31:45,008 - scn_phase_space_process - INFO - 数据源信息:
2025-05-23 21:31:45,009 - scn_phase_space_process - INFO -   - 文件: datasets/EMtrace01.xlsx
2025-05-23 21:31:45,009 - scn_phase_space_process - INFO -   - 格式: Excel
2025-05-23 21:31:45,009 - scn_phase_space_process - INFO -   - 处理器: ExcelCalciumDataProcessor
2025-05-23 21:31:45,010 - scn_phase_space_process - INFO - 
生成的文件:
2025-05-23 21:31:45,010 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/nodes.csv
2025-05-23 21:31:45,011 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/edges.csv
2025-05-23 21:31:45,011 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/graphs.csv
2025-05-23 21:31:45,011 - scn_phase_space_process - INFO - 
处理结果:
2025-05-23 21:31:45,012 - scn_phase_space_process - INFO -   - 总样本数量: 100
2025-05-23 21:31:45,012 - scn_phase_space_process - INFO -   - 轨迹长度: 170
2025-05-23 21:31:45,012 - scn_phase_space_process - INFO -   - 嵌入维度: 3
2025-05-23 21:31:45,013 - scn_phase_space_process - INFO - 
下一步操作:
2025-05-23 21:31:45,013 - scn_phase_space_process - INFO -   1. 检查生成的CSV文件质量
2025-05-23 21:31:45,013 - scn_phase_space_process - INFO -   2. 运行训练: python main.py 或 python run.py --train
2025-05-23 21:31:45,013 - scn_phase_space_process - INFO -   3. 查看训练结果: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results
2025-05-23 21:31:45,014 - __main__ - INFO - ✓ 数据处理完成
2025-05-23 21:31:45,014 - __main__ - INFO - 操作成功完成
2025-05-23 21:32:00,091 - __main__ - INFO - ============================================================
2025-05-23 21:32:00,091 - __main__ - INFO - 开始模型训练流程
2025-05-23 21:32:00,091 - __main__ - INFO - ============================================================
2025-05-23 21:32:04,382 - main - INFO - ================================================================================
2025-05-23 21:32:04,383 - main - INFO - 🧠 脑网络状态分类器 - 先进版本
2025-05-23 21:32:04,383 - main - INFO - ================================================================================
2025-05-23 21:32:04,383 - main - INFO - 使用设备: cuda
2025-05-23 21:32:04,383 - main - INFO - 📊 加载数据集...
2025-05-23 21:32:04,436 - main - INFO - 数据集加载完成 - 训练集: 60, 验证集: 20, 测试集: 20
2025-05-23 21:32:04,436 - main - INFO - 🏗️  创建先进模型...
2025-05-23 21:32:04,511 - main - INFO - 创建先进模型，参数总数: 67934
2025-05-23 21:32:04,630 - main - INFO - 🚀 开始训练...
2025-05-23 21:32:04,630 - main - INFO - 🚀 开始先进训练流程...
2025-05-23 21:32:04,645 - main - ERROR - ❌ 训练过程中发生错误: mat1 and mat2 shapes cannot be multiplied (170x3 and 15x32)
2025-05-23 21:32:04,647 - main - ERROR - Traceback (most recent call last):
  File "D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\main.py", line 457, in main
    train_history = trainer.train(train_loader, val_loader, config.NUM_EPOCHS)
  File "D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\main.py", line 331, in train
    train_loss, train_acc = self.train_epoch(train_loader, epoch)
  File "D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\main.py", line 259, in train_epoch
    outputs, embeddings = self.model(data, return_embeddings=True)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\model.py", line 725, in forward
    x = self.feature_projection(x)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\container.py", line 250, in forward
    input = module(input)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (170x3 and 15x32)

2025-05-23 21:32:04,648 - __main__ - ERROR - ✗ 模型训练失败: cannot unpack non-iterable int object
2025-05-23 21:32:04,648 - __main__ - ERROR - 操作失败
2025-05-23 21:32:38,736 - __main__ - INFO - ============================================================
2025-05-23 21:32:38,736 - __main__ - INFO - 开始数据处理流程
2025-05-23 21:32:38,737 - __main__ - INFO - ============================================================
2025-05-23 21:32:39,778 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:32:39,779 - scn_phase_space_process - INFO - 3D SCN数据处理流程 - Python版本
2025-05-23 21:32:39,779 - scn_phase_space_process - INFO - 增强版本：支持Excel和MAT格式
2025-05-23 21:32:39,779 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:32:39,780 - scn_phase_space_process - INFO - 输出目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets
2025-05-23 21:32:39,780 - scn_phase_space_process - INFO - 
步骤1: 智能数据加载
2025-05-23 21:32:39,780 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:32:39,781 - scn_phase_space_process - INFO - 正在检测和加载数据文件: datasets/EMtrace01.xlsx
2025-05-23 21:32:39,781 - scn_phase_space_process - INFO - 检测到文件格式: excel
2025-05-23 21:32:39,781 - scn_phase_space_process - INFO - 使用Excel数据处理器加载钙离子数据...
2025-05-23 21:32:39,782 - excel_data_processor - INFO - 正在加载Excel数据文件: datasets\EMtrace01.xlsx
2025-05-23 21:32:40,696 - excel_data_processor - INFO - ✓ 成功加载数据: 2999 个时间点, 43 个神经元
2025-05-23 21:32:40,696 - excel_data_processor - INFO - 神经元列: ['n1', 'n2', 'n3', 'n4', 'n5', 'n6', 'n7', 'n8', 'n9', 'n10']...
2025-05-23 21:32:40,696 - excel_data_processor - INFO - 开始预处理钙离子数据...
2025-05-23 21:32:40,701 - excel_data_processor - WARNING - 检测并处理了 247 个异常值
2025-05-23 21:32:40,701 - excel_data_processor - INFO - 执行Z-score标准化...
2025-05-23 21:32:40,705 - excel_data_processor - INFO - ✓ 数据预处理完成: (2999, 43) -> (2999, 43)
2025-05-23 21:32:40,705 - excel_data_processor - INFO - 转换数据为SCN处理格式...
2025-05-23 21:32:40,705 - excel_data_processor - INFO - 分段参数: 段长度=340, 步长=170
2025-05-23 21:32:40,706 - excel_data_processor - INFO - ✓ 转换完成: 10 个神经元, 平均每个神经元 10.0 个时间段
2025-05-23 21:32:40,707 - scn_phase_space_process - INFO - 数据加载信息:
2025-05-23 21:32:40,708 - scn_phase_space_process - INFO -   文件路径: datasets\EMtrace01.xlsx
2025-05-23 21:32:40,708 - scn_phase_space_process - INFO -   时间点数量: 2999
2025-05-23 21:32:40,708 - scn_phase_space_process - INFO -   神经元数量: 43
2025-05-23 21:32:40,709 - scn_phase_space_process - INFO -   数据形状: (2999, 43)
2025-05-23 21:32:40,709 - scn_phase_space_process - INFO -   时间戳范围: 1 - 2999
2025-05-23 21:32:40,709 - scn_phase_space_process - INFO -   神经元ID: ['n1', 'n2', 'n3', 'n4', 'n5', '...']
2025-05-23 21:32:40,709 - scn_phase_space_process - INFO -   缺失值数量: 0
2025-05-23 21:32:40,709 - scn_phase_space_process - INFO -   数据范围: -1.358 - 4.895
2025-05-23 21:32:40,709 - scn_phase_space_process - INFO -   数据均值: -0.000
2025-05-23 21:32:40,710 - scn_phase_space_process - INFO -   数据标准差: 0.578
2025-05-23 21:32:40,710 - scn_phase_space_process - INFO -   数据格式: Excel
2025-05-23 21:32:40,710 - scn_phase_space_process - INFO -   处理器: ExcelCalciumDataProcessor
2025-05-23 21:32:40,710 - scn_phase_space_process - INFO - 
步骤2: 相空间重构
2025-05-23 21:32:40,710 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:32:40,710 - scn_phase_space_process - INFO - 数据维度: 10 个细胞, 10 个时间线
2025-05-23 21:32:40,711 - scn_phase_space_process - INFO - 开始处理钙信号数据...
2025-05-23 21:32:45,443 - scn_phase_space_process - INFO - ✓ 相空间重构完成
2025-05-23 21:32:45,443 - scn_phase_space_process - INFO - 
步骤3: 数据裁剪
2025-05-23 21:32:45,443 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:32:45,444 - scn_phase_space_process - INFO - 开始裁剪数据到统一长度: 170
2025-05-23 21:32:45,444 - scn_phase_space_process - INFO - ✓ 数据裁剪完成
2025-05-23 21:32:45,444 - scn_phase_space_process - INFO - 
步骤4: 构建图数据集
2025-05-23 21:32:45,445 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:32:45,445 - scn_phase_space_process - INFO - 有效样本数量: 100
2025-05-23 21:32:45,445 - scn_phase_space_process - INFO - 生成 nodes.csv 文件...
2025-05-23 21:32:45,446 - scn_phase_space_process - INFO - 转换节点特征格式...
2025-05-23 21:32:45,520 - scn_phase_space_process - INFO - ✓ nodes.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\nodes.csv
2025-05-23 21:32:45,521 - scn_phase_space_process - INFO - 生成 edges.csv 文件...
2025-05-23 21:32:45,532 - scn_phase_space_process - INFO - ✓ edges.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\edges.csv
2025-05-23 21:32:45,533 - scn_phase_space_process - INFO - 生成 graphs.csv 文件...
2025-05-23 21:32:45,534 - scn_phase_space_process - INFO - 外部模块不可用，使用内置的改进标签生成方法...
2025-05-23 21:32:45,734 - scn_phase_space_process - INFO - 使用内置的改进标签生成方法...
2025-05-23 21:32:45,735 - scn_phase_space_process - INFO - 处理 100 个有效样本
2025-05-23 21:32:45,785 - scn_phase_space_process - INFO - 特征矩阵形状: (100, 14)
2025-05-23 21:32:45,786 - scn_phase_space_process - INFO - PCA降维: 14 -> 8
2025-05-23 21:32:45,942 - scn_phase_space_process - INFO - 聚类质量 - 轮廓系数: 0.224
2025-05-23 21:32:45,942 - scn_phase_space_process - INFO - 改进标签分布: {np.int32(0): np.int64(21), np.int32(1): np.int64(28), np.int32(2): np.int64(13), np.int32(3): np.int64(13), np.int32(4): np.int64(9), np.int32(5): np.int64(16)}
2025-05-23 21:32:45,943 - scn_phase_space_process - INFO - 最终标签分布: {np.int32(0): np.int64(21), np.int32(1): np.int64(28), np.int32(2): np.int64(13), np.int32(3): np.int64(13), np.int32(4): np.int64(9), np.int32(5): np.int64(16)}
2025-05-23 21:32:45,945 - scn_phase_space_process - INFO - ✓ graphs.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\graphs.csv
2025-05-23 21:32:45,945 - scn_phase_space_process - INFO - 
============================================================
2025-05-23 21:32:45,946 - scn_phase_space_process - INFO - 数据处理流程全部完成!
2025-05-23 21:32:45,946 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:32:45,946 - scn_phase_space_process - INFO - 数据源信息:
2025-05-23 21:32:45,947 - scn_phase_space_process - INFO -   - 文件: datasets/EMtrace01.xlsx
2025-05-23 21:32:45,947 - scn_phase_space_process - INFO -   - 格式: Excel
2025-05-23 21:32:45,947 - scn_phase_space_process - INFO -   - 处理器: ExcelCalciumDataProcessor
2025-05-23 21:32:45,948 - scn_phase_space_process - INFO - 
生成的文件:
2025-05-23 21:32:45,948 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/nodes.csv
2025-05-23 21:32:45,948 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/edges.csv
2025-05-23 21:32:45,949 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/graphs.csv
2025-05-23 21:32:45,949 - scn_phase_space_process - INFO - 
处理结果:
2025-05-23 21:32:45,949 - scn_phase_space_process - INFO -   - 总样本数量: 100
2025-05-23 21:32:45,950 - scn_phase_space_process - INFO -   - 轨迹长度: 170
2025-05-23 21:32:45,950 - scn_phase_space_process - INFO -   - 嵌入维度: 3
2025-05-23 21:32:45,950 - scn_phase_space_process - INFO - 
下一步操作:
2025-05-23 21:32:45,951 - scn_phase_space_process - INFO -   1. 检查生成的CSV文件质量
2025-05-23 21:32:45,951 - scn_phase_space_process - INFO -   2. 运行训练: python main.py 或 python run.py --train
2025-05-23 21:32:45,951 - scn_phase_space_process - INFO -   3. 查看训练结果: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results
2025-05-23 21:32:45,952 - __main__ - INFO - ✓ 数据处理完成
2025-05-23 21:32:45,952 - __main__ - INFO - 操作成功完成
2025-05-23 21:33:18,380 - __main__ - INFO - ============================================================
2025-05-23 21:33:18,380 - __main__ - INFO - 开始模型训练流程
2025-05-23 21:33:18,380 - __main__ - INFO - ============================================================
2025-05-23 21:33:22,816 - main - INFO - ================================================================================
2025-05-23 21:33:22,816 - main - INFO - 🧠 脑网络状态分类器 - 先进版本
2025-05-23 21:33:22,817 - main - INFO - ================================================================================
2025-05-23 21:33:22,817 - main - INFO - 使用设备: cuda
2025-05-23 21:33:22,817 - main - INFO - 📊 加载数据集...
2025-05-23 21:33:22,868 - main - INFO - 数据集加载完成 - 训练集: 60, 验证集: 20, 测试集: 20
2025-05-23 21:33:22,869 - main - INFO - 🏗️  创建先进模型...
2025-05-23 21:33:22,944 - main - INFO - 创建先进模型，参数总数: 67934
2025-05-23 21:33:23,059 - main - INFO - 🚀 开始训练...
2025-05-23 21:33:23,059 - main - INFO - 🚀 开始先进训练流程...
2025-05-23 21:33:23,061 - main - ERROR - ❌ 训练过程中发生错误: mat1 and mat2 shapes cannot be multiplied (170x3 and 15x32)
2025-05-23 21:33:23,063 - main - ERROR - Traceback (most recent call last):
  File "D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\main.py", line 457, in main
    train_history = trainer.train(train_loader, val_loader, config.NUM_EPOCHS)
  File "D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\main.py", line 331, in train
    train_loss, train_acc = self.train_epoch(train_loader, epoch)
  File "D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\main.py", line 259, in train_epoch
    outputs, embeddings = self.model(data, return_embeddings=True)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\model.py", line 725, in forward
    x = self.feature_projection(x)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\container.py", line 250, in forward
    input = module(input)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (170x3 and 15x32)

2025-05-23 21:33:23,064 - __main__ - ERROR - ✗ 模型训练失败: cannot unpack non-iterable int object
2025-05-23 21:33:23,064 - __main__ - ERROR - 操作失败
2025-05-23 21:35:25,637 - __main__ - INFO - ============================================================
2025-05-23 21:35:25,637 - __main__ - INFO - 开始数据处理流程
2025-05-23 21:35:25,637 - __main__ - INFO - ============================================================
2025-05-23 21:35:26,717 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:35:26,718 - scn_phase_space_process - INFO - 3D SCN数据处理流程 - Python版本
2025-05-23 21:35:26,718 - scn_phase_space_process - INFO - 增强版本：支持Excel和MAT格式
2025-05-23 21:35:26,718 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:35:26,718 - scn_phase_space_process - INFO - 输出目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets
2025-05-23 21:35:26,719 - scn_phase_space_process - INFO - 
步骤1: 智能数据加载
2025-05-23 21:35:26,719 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:35:26,719 - scn_phase_space_process - INFO - 正在检测和加载数据文件: datasets/EMtrace01.xlsx
2025-05-23 21:35:26,719 - scn_phase_space_process - INFO - 检测到文件格式: excel
2025-05-23 21:35:26,719 - scn_phase_space_process - INFO - 使用Excel数据处理器加载钙离子数据...
2025-05-23 21:35:26,719 - excel_data_processor - INFO - 正在加载Excel数据文件: datasets\EMtrace01.xlsx
2025-05-23 21:35:27,679 - excel_data_processor - INFO - ✓ 成功加载数据: 2999 个时间点, 43 个神经元
2025-05-23 21:35:27,680 - excel_data_processor - INFO - 神经元列: ['n1', 'n2', 'n3', 'n4', 'n5', 'n6', 'n7', 'n8', 'n9', 'n10']...
2025-05-23 21:35:27,680 - excel_data_processor - INFO - 开始预处理钙离子数据...
2025-05-23 21:35:27,684 - excel_data_processor - WARNING - 检测并处理了 247 个异常值
2025-05-23 21:35:27,685 - excel_data_processor - INFO - 执行Z-score标准化...
2025-05-23 21:35:27,688 - excel_data_processor - INFO - ✓ 数据预处理完成: (2999, 43) -> (2999, 43)
2025-05-23 21:35:27,688 - excel_data_processor - INFO - 转换数据为SCN处理格式...
2025-05-23 21:35:27,689 - excel_data_processor - INFO - 分段参数: 段长度=340, 步长=170
2025-05-23 21:35:27,689 - excel_data_processor - INFO - ✓ 转换完成: 10 个神经元, 平均每个神经元 10.0 个时间段
2025-05-23 21:35:27,690 - scn_phase_space_process - INFO - 数据加载信息:
2025-05-23 21:35:27,691 - scn_phase_space_process - INFO -   文件路径: datasets\EMtrace01.xlsx
2025-05-23 21:35:27,691 - scn_phase_space_process - INFO -   时间点数量: 2999
2025-05-23 21:35:27,692 - scn_phase_space_process - INFO -   神经元数量: 43
2025-05-23 21:35:27,692 - scn_phase_space_process - INFO -   数据形状: (2999, 43)
2025-05-23 21:35:27,692 - scn_phase_space_process - INFO -   时间戳范围: 1 - 2999
2025-05-23 21:35:27,692 - scn_phase_space_process - INFO -   神经元ID: ['n1', 'n2', 'n3', 'n4', 'n5', '...']
2025-05-23 21:35:27,693 - scn_phase_space_process - INFO -   缺失值数量: 0
2025-05-23 21:35:27,693 - scn_phase_space_process - INFO -   数据范围: -1.358 - 4.895
2025-05-23 21:35:27,693 - scn_phase_space_process - INFO -   数据均值: -0.000
2025-05-23 21:35:27,694 - scn_phase_space_process - INFO -   数据标准差: 0.578
2025-05-23 21:35:27,694 - scn_phase_space_process - INFO -   数据格式: Excel
2025-05-23 21:35:27,694 - scn_phase_space_process - INFO -   处理器: ExcelCalciumDataProcessor
2025-05-23 21:35:27,694 - scn_phase_space_process - INFO - 
步骤2: 相空间重构
2025-05-23 21:35:27,694 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:35:27,695 - scn_phase_space_process - INFO - 数据维度: 10 个细胞, 10 个时间线
2025-05-23 21:35:27,695 - scn_phase_space_process - INFO - 开始处理钙信号数据...
2025-05-23 21:35:32,319 - scn_phase_space_process - INFO - ✓ 相空间重构完成
2025-05-23 21:35:32,320 - scn_phase_space_process - INFO - 
步骤3: 数据裁剪
2025-05-23 21:35:32,320 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:35:32,320 - scn_phase_space_process - INFO - 开始裁剪数据到统一长度: 170
2025-05-23 21:35:32,320 - scn_phase_space_process - INFO - ✓ 数据裁剪完成
2025-05-23 21:35:32,320 - scn_phase_space_process - INFO - 
步骤4: 构建图数据集
2025-05-23 21:35:32,321 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:35:32,321 - scn_phase_space_process - INFO - 有效样本数量: 100
2025-05-23 21:35:32,321 - scn_phase_space_process - INFO - 生成 nodes.csv 文件...
2025-05-23 21:35:32,321 - scn_phase_space_process - INFO - 转换节点特征格式...
2025-05-23 21:35:32,393 - scn_phase_space_process - INFO - ✓ nodes.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\nodes.csv
2025-05-23 21:35:32,393 - scn_phase_space_process - INFO - 生成 edges.csv 文件...
2025-05-23 21:35:32,406 - scn_phase_space_process - INFO - ✓ edges.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\edges.csv
2025-05-23 21:35:32,407 - scn_phase_space_process - INFO - 生成 graphs.csv 文件...
2025-05-23 21:35:32,407 - scn_phase_space_process - INFO - 外部模块不可用，使用内置的改进标签生成方法...
2025-05-23 21:35:32,592 - scn_phase_space_process - INFO - 使用内置的改进标签生成方法...
2025-05-23 21:35:32,593 - scn_phase_space_process - INFO - 处理 100 个有效样本
2025-05-23 21:35:32,644 - scn_phase_space_process - INFO - 特征矩阵形状: (100, 14)
2025-05-23 21:35:32,645 - scn_phase_space_process - INFO - PCA降维: 14 -> 8
2025-05-23 21:35:32,799 - scn_phase_space_process - INFO - 聚类质量 - 轮廓系数: 0.224
2025-05-23 21:35:32,799 - scn_phase_space_process - INFO - 改进标签分布: {np.int32(0): np.int64(21), np.int32(1): np.int64(28), np.int32(2): np.int64(13), np.int32(3): np.int64(13), np.int32(4): np.int64(9), np.int32(5): np.int64(16)}
2025-05-23 21:35:32,800 - scn_phase_space_process - INFO - 最终标签分布: {np.int32(0): np.int64(21), np.int32(1): np.int64(28), np.int32(2): np.int64(13), np.int32(3): np.int64(13), np.int32(4): np.int64(9), np.int32(5): np.int64(16)}
2025-05-23 21:35:32,802 - scn_phase_space_process - INFO - ✓ graphs.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\graphs.csv
2025-05-23 21:35:32,802 - scn_phase_space_process - INFO - 
============================================================
2025-05-23 21:35:32,802 - scn_phase_space_process - INFO - 数据处理流程全部完成!
2025-05-23 21:35:32,803 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:35:32,803 - scn_phase_space_process - INFO - 数据源信息:
2025-05-23 21:35:32,803 - scn_phase_space_process - INFO -   - 文件: datasets/EMtrace01.xlsx
2025-05-23 21:35:32,804 - scn_phase_space_process - INFO -   - 格式: Excel
2025-05-23 21:35:32,804 - scn_phase_space_process - INFO -   - 处理器: ExcelCalciumDataProcessor
2025-05-23 21:35:32,805 - scn_phase_space_process - INFO - 
生成的文件:
2025-05-23 21:35:32,805 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/nodes.csv
2025-05-23 21:35:32,805 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/edges.csv
2025-05-23 21:35:32,806 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/graphs.csv
2025-05-23 21:35:32,806 - scn_phase_space_process - INFO - 
处理结果:
2025-05-23 21:35:32,806 - scn_phase_space_process - INFO -   - 总样本数量: 100
2025-05-23 21:35:32,807 - scn_phase_space_process - INFO -   - 轨迹长度: 170
2025-05-23 21:35:32,807 - scn_phase_space_process - INFO -   - 嵌入维度: 3
2025-05-23 21:35:32,807 - scn_phase_space_process - INFO - 
下一步操作:
2025-05-23 21:35:32,808 - scn_phase_space_process - INFO -   1. 检查生成的CSV文件质量
2025-05-23 21:35:32,808 - scn_phase_space_process - INFO -   2. 运行训练: python main.py 或 python run.py --train
2025-05-23 21:35:32,809 - scn_phase_space_process - INFO -   3. 查看训练结果: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results
2025-05-23 21:35:32,809 - __main__ - INFO - ✓ 数据处理完成
2025-05-23 21:35:32,809 - __main__ - INFO - 操作成功完成
2025-05-23 21:35:35,520 - __main__ - INFO - ============================================================
2025-05-23 21:35:35,521 - __main__ - INFO - 开始模型训练流程
2025-05-23 21:35:35,521 - __main__ - INFO - ============================================================
2025-05-23 21:35:40,051 - main - INFO - ================================================================================
2025-05-23 21:35:40,051 - main - INFO - 🧠 脑网络状态分类器 - 先进版本
2025-05-23 21:35:40,051 - main - INFO - ================================================================================
2025-05-23 21:35:40,051 - main - INFO - 使用设备: cuda
2025-05-23 21:35:40,052 - main - INFO - 📊 加载数据集...
2025-05-23 21:35:40,106 - main - INFO - 数据集加载完成 - 训练集: 60, 验证集: 20, 测试集: 20
2025-05-23 21:35:40,106 - main - INFO - 🏗️  创建先进模型...
2025-05-23 21:35:40,182 - main - INFO - 创建先进模型，参数总数: 67550
2025-05-23 21:35:40,301 - main - INFO - 🚀 开始训练...
2025-05-23 21:35:40,302 - main - INFO - 🚀 开始先进训练流程...
2025-05-23 21:35:40,496 - main - ERROR - ❌ 训练过程中发生错误: mat1 and mat2 shapes cannot be multiplied (170x32 and 64x8)
2025-05-23 21:35:40,498 - main - ERROR - Traceback (most recent call last):
  File "D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\main.py", line 457, in main
    train_history = trainer.train(train_loader, val_loader, config.NUM_EPOCHS)
  File "D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\main.py", line 331, in train
    train_loss, train_acc = self.train_epoch(train_loader, epoch)
  File "D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\main.py", line 259, in train_epoch
    outputs, embeddings = self.model(data, return_embeddings=True)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\model.py", line 743, in forward
    x = self.graph_transformer(x, edge_index, temporal_length=self.temporal_window)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\model.py", line 227, in forward
    x = gat_layer(x, edge_index)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\model.py", line 138, in forward
    head_out = gat_layer(x, edge_index)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch_geometric\nn\conv\gat_conv.py", line 302, in forward
    x_src = x_dst = self.lin(x).view(-1, H, C)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch_geometric\nn\dense\linear.py", line 147, in forward
    return F.linear(x, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (170x32 and 64x8)

2025-05-23 21:35:40,499 - __main__ - ERROR - ✗ 模型训练失败: cannot unpack non-iterable int object
2025-05-23 21:35:40,499 - __main__ - ERROR - 操作失败
2025-05-23 21:36:09,973 - __main__ - INFO - ============================================================
2025-05-23 21:36:09,973 - __main__ - INFO - 开始数据处理流程
2025-05-23 21:36:09,973 - __main__ - INFO - ============================================================
2025-05-23 21:36:11,060 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:36:11,060 - scn_phase_space_process - INFO - 3D SCN数据处理流程 - Python版本
2025-05-23 21:36:11,060 - scn_phase_space_process - INFO - 增强版本：支持Excel和MAT格式
2025-05-23 21:36:11,060 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:36:11,061 - scn_phase_space_process - INFO - 输出目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets
2025-05-23 21:36:11,061 - scn_phase_space_process - INFO - 
步骤1: 智能数据加载
2025-05-23 21:36:11,061 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:36:11,061 - scn_phase_space_process - INFO - 正在检测和加载数据文件: datasets/EMtrace01.xlsx
2025-05-23 21:36:11,062 - scn_phase_space_process - INFO - 检测到文件格式: excel
2025-05-23 21:36:11,062 - scn_phase_space_process - INFO - 使用Excel数据处理器加载钙离子数据...
2025-05-23 21:36:11,062 - excel_data_processor - INFO - 正在加载Excel数据文件: datasets\EMtrace01.xlsx
2025-05-23 21:36:12,058 - excel_data_processor - INFO - ✓ 成功加载数据: 2999 个时间点, 43 个神经元
2025-05-23 21:36:12,058 - excel_data_processor - INFO - 神经元列: ['n1', 'n2', 'n3', 'n4', 'n5', 'n6', 'n7', 'n8', 'n9', 'n10']...
2025-05-23 21:36:12,058 - excel_data_processor - INFO - 开始预处理钙离子数据...
2025-05-23 21:36:12,063 - excel_data_processor - WARNING - 检测并处理了 247 个异常值
2025-05-23 21:36:12,064 - excel_data_processor - INFO - 执行Z-score标准化...
2025-05-23 21:36:12,067 - excel_data_processor - INFO - ✓ 数据预处理完成: (2999, 43) -> (2999, 43)
2025-05-23 21:36:12,067 - excel_data_processor - INFO - 转换数据为SCN处理格式...
2025-05-23 21:36:12,067 - excel_data_processor - INFO - 分段参数: 段长度=340, 步长=170
2025-05-23 21:36:12,068 - excel_data_processor - INFO - ✓ 转换完成: 10 个神经元, 平均每个神经元 10.0 个时间段
2025-05-23 21:36:12,069 - scn_phase_space_process - INFO - 数据加载信息:
2025-05-23 21:36:12,069 - scn_phase_space_process - INFO -   文件路径: datasets\EMtrace01.xlsx
2025-05-23 21:36:12,070 - scn_phase_space_process - INFO -   时间点数量: 2999
2025-05-23 21:36:12,070 - scn_phase_space_process - INFO -   神经元数量: 43
2025-05-23 21:36:12,070 - scn_phase_space_process - INFO -   数据形状: (2999, 43)
2025-05-23 21:36:12,070 - scn_phase_space_process - INFO -   时间戳范围: 1 - 2999
2025-05-23 21:36:12,070 - scn_phase_space_process - INFO -   神经元ID: ['n1', 'n2', 'n3', 'n4', 'n5', '...']
2025-05-23 21:36:12,071 - scn_phase_space_process - INFO -   缺失值数量: 0
2025-05-23 21:36:12,071 - scn_phase_space_process - INFO -   数据范围: -1.358 - 4.895
2025-05-23 21:36:12,071 - scn_phase_space_process - INFO -   数据均值: -0.000
2025-05-23 21:36:12,072 - scn_phase_space_process - INFO -   数据标准差: 0.578
2025-05-23 21:36:12,072 - scn_phase_space_process - INFO -   数据格式: Excel
2025-05-23 21:36:12,072 - scn_phase_space_process - INFO -   处理器: ExcelCalciumDataProcessor
2025-05-23 21:36:12,072 - scn_phase_space_process - INFO - 
步骤2: 相空间重构
2025-05-23 21:36:12,072 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:36:12,072 - scn_phase_space_process - INFO - 数据维度: 10 个细胞, 10 个时间线
2025-05-23 21:36:12,074 - scn_phase_space_process - INFO - 开始处理钙信号数据...
2025-05-23 21:36:16,673 - scn_phase_space_process - INFO - ✓ 相空间重构完成
2025-05-23 21:36:16,673 - scn_phase_space_process - INFO - 
步骤3: 数据裁剪
2025-05-23 21:36:16,673 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:36:16,673 - scn_phase_space_process - INFO - 开始裁剪数据到统一长度: 170
2025-05-23 21:36:16,674 - scn_phase_space_process - INFO - ✓ 数据裁剪完成
2025-05-23 21:36:16,674 - scn_phase_space_process - INFO - 
步骤4: 构建图数据集
2025-05-23 21:36:16,674 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:36:16,674 - scn_phase_space_process - INFO - 有效样本数量: 100
2025-05-23 21:36:16,675 - scn_phase_space_process - INFO - 生成 nodes.csv 文件...
2025-05-23 21:36:16,675 - scn_phase_space_process - INFO - 转换节点特征格式...
2025-05-23 21:36:16,749 - scn_phase_space_process - INFO - ✓ nodes.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\nodes.csv
2025-05-23 21:36:16,749 - scn_phase_space_process - INFO - 生成 edges.csv 文件...
2025-05-23 21:36:16,761 - scn_phase_space_process - INFO - ✓ edges.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\edges.csv
2025-05-23 21:36:16,762 - scn_phase_space_process - INFO - 生成 graphs.csv 文件...
2025-05-23 21:36:16,762 - scn_phase_space_process - INFO - 外部模块不可用，使用内置的改进标签生成方法...
2025-05-23 21:36:16,951 - scn_phase_space_process - INFO - 使用内置的改进标签生成方法...
2025-05-23 21:36:16,952 - scn_phase_space_process - INFO - 处理 100 个有效样本
2025-05-23 21:36:17,000 - scn_phase_space_process - INFO - 特征矩阵形状: (100, 14)
2025-05-23 21:36:17,001 - scn_phase_space_process - INFO - PCA降维: 14 -> 8
2025-05-23 21:36:17,164 - scn_phase_space_process - INFO - 聚类质量 - 轮廓系数: 0.224
2025-05-23 21:36:17,164 - scn_phase_space_process - INFO - 改进标签分布: {np.int32(0): np.int64(21), np.int32(1): np.int64(28), np.int32(2): np.int64(13), np.int32(3): np.int64(13), np.int32(4): np.int64(9), np.int32(5): np.int64(16)}
2025-05-23 21:36:17,165 - scn_phase_space_process - INFO - 最终标签分布: {np.int32(0): np.int64(21), np.int32(1): np.int64(28), np.int32(2): np.int64(13), np.int32(3): np.int64(13), np.int32(4): np.int64(9), np.int32(5): np.int64(16)}
2025-05-23 21:36:17,167 - scn_phase_space_process - INFO - ✓ graphs.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\graphs.csv
2025-05-23 21:36:17,167 - scn_phase_space_process - INFO - 
============================================================
2025-05-23 21:36:17,167 - scn_phase_space_process - INFO - 数据处理流程全部完成!
2025-05-23 21:36:17,168 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:36:17,168 - scn_phase_space_process - INFO - 数据源信息:
2025-05-23 21:36:17,168 - scn_phase_space_process - INFO -   - 文件: datasets/EMtrace01.xlsx
2025-05-23 21:36:17,169 - scn_phase_space_process - INFO -   - 格式: Excel
2025-05-23 21:36:17,169 - scn_phase_space_process - INFO -   - 处理器: ExcelCalciumDataProcessor
2025-05-23 21:36:17,169 - scn_phase_space_process - INFO - 
生成的文件:
2025-05-23 21:36:17,170 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/nodes.csv
2025-05-23 21:36:17,170 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/edges.csv
2025-05-23 21:36:17,170 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/graphs.csv
2025-05-23 21:36:17,171 - scn_phase_space_process - INFO - 
处理结果:
2025-05-23 21:36:17,171 - scn_phase_space_process - INFO -   - 总样本数量: 100
2025-05-23 21:36:17,172 - scn_phase_space_process - INFO -   - 轨迹长度: 170
2025-05-23 21:36:17,172 - scn_phase_space_process - INFO -   - 嵌入维度: 3
2025-05-23 21:36:17,172 - scn_phase_space_process - INFO - 
下一步操作:
2025-05-23 21:36:17,173 - scn_phase_space_process - INFO -   1. 检查生成的CSV文件质量
2025-05-23 21:36:17,173 - scn_phase_space_process - INFO -   2. 运行训练: python main.py 或 python run.py --train
2025-05-23 21:36:17,173 - scn_phase_space_process - INFO -   3. 查看训练结果: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results
2025-05-23 21:36:17,174 - __main__ - INFO - ✓ 数据处理完成
2025-05-23 21:36:17,174 - __main__ - INFO - 操作成功完成
2025-05-23 21:36:19,434 - __main__ - INFO - ============================================================
2025-05-23 21:36:19,434 - __main__ - INFO - 开始模型训练流程
2025-05-23 21:36:19,434 - __main__ - INFO - ============================================================
2025-05-23 21:36:24,220 - main - INFO - ================================================================================
2025-05-23 21:36:24,220 - main - INFO - 🧠 脑网络状态分类器 - 先进版本
2025-05-23 21:36:24,220 - main - INFO - ================================================================================
2025-05-23 21:36:24,221 - main - INFO - 使用设备: cuda
2025-05-23 21:36:24,221 - main - INFO - 📊 加载数据集...
2025-05-23 21:36:24,275 - main - INFO - 数据集加载完成 - 训练集: 60, 验证集: 20, 测试集: 20
2025-05-23 21:36:24,276 - main - INFO - 🏗️  创建先进模型...
2025-05-23 21:36:24,347 - main - INFO - 创建先进模型，参数总数: 67550
2025-05-23 21:36:24,457 - main - INFO - 🚀 开始训练...
2025-05-23 21:36:24,457 - main - INFO - 🚀 开始先进训练流程...
2025-05-23 21:36:24,641 - main - ERROR - ❌ 训练过程中发生错误: mat1 and mat2 shapes cannot be multiplied (170x32 and 64x8)
2025-05-23 21:36:24,643 - main - ERROR - Traceback (most recent call last):
  File "D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\main.py", line 457, in main
    train_history = trainer.train(train_loader, val_loader, config.NUM_EPOCHS)
  File "D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\main.py", line 331, in train
    train_loss, train_acc = self.train_epoch(train_loader, epoch)
  File "D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\main.py", line 259, in train_epoch
    outputs, embeddings = self.model(data, return_embeddings=True)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\model.py", line 747, in forward
    x = self.graph_transformer(x, edge_index, temporal_length=self.temporal_window)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\model.py", line 231, in forward
    x = gat_layer(x, edge_index)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\model.py", line 138, in forward
    head_out = gat_layer(x, edge_index)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch_geometric\nn\conv\gat_conv.py", line 302, in forward
    x_src = x_dst = self.lin(x).view(-1, H, C)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch_geometric\nn\dense\linear.py", line 147, in forward
    return F.linear(x, self.weight, self.bias)
RuntimeError: mat1 and mat2 shapes cannot be multiplied (170x32 and 64x8)

2025-05-23 21:36:24,644 - __main__ - ERROR - ✗ 模型训练失败: cannot unpack non-iterable int object
2025-05-23 21:36:24,645 - __main__ - ERROR - 操作失败
2025-05-23 21:38:35,542 - __main__ - INFO - ============================================================
2025-05-23 21:38:35,543 - __main__ - INFO - 开始数据处理流程
2025-05-23 21:38:35,543 - __main__ - INFO - ============================================================
2025-05-23 21:38:36,507 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:38:36,508 - scn_phase_space_process - INFO - 3D SCN数据处理流程 - Python版本
2025-05-23 21:38:36,508 - scn_phase_space_process - INFO - 增强版本：支持Excel和MAT格式
2025-05-23 21:38:36,508 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:38:36,508 - scn_phase_space_process - INFO - 输出目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets
2025-05-23 21:38:36,509 - scn_phase_space_process - INFO - 
步骤1: 智能数据加载
2025-05-23 21:38:36,509 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:38:36,509 - scn_phase_space_process - INFO - 正在检测和加载数据文件: datasets/EMtrace01.xlsx
2025-05-23 21:38:36,509 - scn_phase_space_process - INFO - 检测到文件格式: excel
2025-05-23 21:38:36,510 - scn_phase_space_process - INFO - 使用Excel数据处理器加载钙离子数据...
2025-05-23 21:38:36,510 - excel_data_processor - INFO - 正在加载Excel数据文件: datasets\EMtrace01.xlsx
2025-05-23 21:38:37,384 - excel_data_processor - INFO - ✓ 成功加载数据: 2999 个时间点, 43 个神经元
2025-05-23 21:38:37,384 - excel_data_processor - INFO - 神经元列: ['n1', 'n2', 'n3', 'n4', 'n5', 'n6', 'n7', 'n8', 'n9', 'n10']...
2025-05-23 21:38:37,385 - excel_data_processor - INFO - 开始预处理钙离子数据...
2025-05-23 21:38:37,389 - excel_data_processor - WARNING - 检测并处理了 247 个异常值
2025-05-23 21:38:37,389 - excel_data_processor - INFO - 执行Z-score标准化...
2025-05-23 21:38:37,392 - excel_data_processor - INFO - ✓ 数据预处理完成: (2999, 43) -> (2999, 43)
2025-05-23 21:38:37,392 - excel_data_processor - INFO - 转换数据为SCN处理格式...
2025-05-23 21:38:37,392 - excel_data_processor - INFO - 分段参数: 段长度=340, 步长=170
2025-05-23 21:38:37,392 - excel_data_processor - INFO - ✓ 转换完成: 10 个神经元, 平均每个神经元 10.0 个时间段
2025-05-23 21:38:37,394 - scn_phase_space_process - INFO - 数据加载信息:
2025-05-23 21:38:37,394 - scn_phase_space_process - INFO -   文件路径: datasets\EMtrace01.xlsx
2025-05-23 21:38:37,395 - scn_phase_space_process - INFO -   时间点数量: 2999
2025-05-23 21:38:37,395 - scn_phase_space_process - INFO -   神经元数量: 43
2025-05-23 21:38:37,395 - scn_phase_space_process - INFO -   数据形状: (2999, 43)
2025-05-23 21:38:37,395 - scn_phase_space_process - INFO -   时间戳范围: 1 - 2999
2025-05-23 21:38:37,396 - scn_phase_space_process - INFO -   神经元ID: ['n1', 'n2', 'n3', 'n4', 'n5', '...']
2025-05-23 21:38:37,396 - scn_phase_space_process - INFO -   缺失值数量: 0
2025-05-23 21:38:37,396 - scn_phase_space_process - INFO -   数据范围: -1.358 - 4.895
2025-05-23 21:38:37,396 - scn_phase_space_process - INFO -   数据均值: -0.000
2025-05-23 21:38:37,396 - scn_phase_space_process - INFO -   数据标准差: 0.578
2025-05-23 21:38:37,396 - scn_phase_space_process - INFO -   数据格式: Excel
2025-05-23 21:38:37,396 - scn_phase_space_process - INFO -   处理器: ExcelCalciumDataProcessor
2025-05-23 21:38:37,397 - scn_phase_space_process - INFO - 
步骤2: 相空间重构
2025-05-23 21:38:37,397 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:38:37,397 - scn_phase_space_process - INFO - 数据维度: 10 个细胞, 10 个时间线
2025-05-23 21:38:37,397 - scn_phase_space_process - INFO - 开始处理钙信号数据...
2025-05-23 21:38:41,843 - scn_phase_space_process - INFO - ✓ 相空间重构完成
2025-05-23 21:38:41,843 - scn_phase_space_process - INFO - 
步骤3: 数据裁剪
2025-05-23 21:38:41,843 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:38:41,843 - scn_phase_space_process - INFO - 开始裁剪数据到统一长度: 170
2025-05-23 21:38:41,844 - scn_phase_space_process - INFO - ✓ 数据裁剪完成
2025-05-23 21:38:41,844 - scn_phase_space_process - INFO - 
步骤4: 构建图数据集
2025-05-23 21:38:41,844 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:38:41,845 - scn_phase_space_process - INFO - 有效样本数量: 100
2025-05-23 21:38:41,845 - scn_phase_space_process - INFO - 生成 nodes.csv 文件...
2025-05-23 21:38:41,845 - scn_phase_space_process - INFO - 转换节点特征格式...
2025-05-23 21:38:41,916 - scn_phase_space_process - INFO - ✓ nodes.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\nodes.csv
2025-05-23 21:38:41,917 - scn_phase_space_process - INFO - 生成 edges.csv 文件...
2025-05-23 21:38:41,929 - scn_phase_space_process - INFO - ✓ edges.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\edges.csv
2025-05-23 21:38:41,929 - scn_phase_space_process - INFO - 生成 graphs.csv 文件...
2025-05-23 21:38:41,930 - scn_phase_space_process - INFO - 外部模块不可用，使用内置的改进标签生成方法...
2025-05-23 21:38:42,110 - scn_phase_space_process - INFO - 使用内置的改进标签生成方法...
2025-05-23 21:38:42,111 - scn_phase_space_process - INFO - 处理 100 个有效样本
2025-05-23 21:38:42,157 - scn_phase_space_process - INFO - 特征矩阵形状: (100, 14)
2025-05-23 21:38:42,159 - scn_phase_space_process - INFO - PCA降维: 14 -> 8
2025-05-23 21:38:42,306 - scn_phase_space_process - INFO - 聚类质量 - 轮廓系数: 0.224
2025-05-23 21:38:42,307 - scn_phase_space_process - INFO - 改进标签分布: {np.int32(0): np.int64(21), np.int32(1): np.int64(28), np.int32(2): np.int64(13), np.int32(3): np.int64(13), np.int32(4): np.int64(9), np.int32(5): np.int64(16)}
2025-05-23 21:38:42,308 - scn_phase_space_process - INFO - 最终标签分布: {np.int32(0): np.int64(21), np.int32(1): np.int64(28), np.int32(2): np.int64(13), np.int32(3): np.int64(13), np.int32(4): np.int64(9), np.int32(5): np.int64(16)}
2025-05-23 21:38:42,309 - scn_phase_space_process - INFO - ✓ graphs.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\graphs.csv
2025-05-23 21:38:42,309 - scn_phase_space_process - INFO - 
============================================================
2025-05-23 21:38:42,310 - scn_phase_space_process - INFO - 数据处理流程全部完成!
2025-05-23 21:38:42,310 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:38:42,311 - scn_phase_space_process - INFO - 数据源信息:
2025-05-23 21:38:42,311 - scn_phase_space_process - INFO -   - 文件: datasets/EMtrace01.xlsx
2025-05-23 21:38:42,311 - scn_phase_space_process - INFO -   - 格式: Excel
2025-05-23 21:38:42,311 - scn_phase_space_process - INFO -   - 处理器: ExcelCalciumDataProcessor
2025-05-23 21:38:42,311 - scn_phase_space_process - INFO - 
生成的文件:
2025-05-23 21:38:42,311 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/nodes.csv
2025-05-23 21:38:42,311 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/edges.csv
2025-05-23 21:38:42,311 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/graphs.csv
2025-05-23 21:38:42,313 - scn_phase_space_process - INFO - 
处理结果:
2025-05-23 21:38:42,313 - scn_phase_space_process - INFO -   - 总样本数量: 100
2025-05-23 21:38:42,313 - scn_phase_space_process - INFO -   - 轨迹长度: 170
2025-05-23 21:38:42,314 - scn_phase_space_process - INFO -   - 嵌入维度: 3
2025-05-23 21:38:42,314 - scn_phase_space_process - INFO - 
下一步操作:
2025-05-23 21:38:42,314 - scn_phase_space_process - INFO -   1. 检查生成的CSV文件质量
2025-05-23 21:38:42,315 - scn_phase_space_process - INFO -   2. 运行训练: python main.py 或 python run.py --train
2025-05-23 21:38:42,315 - scn_phase_space_process - INFO -   3. 查看训练结果: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results
2025-05-23 21:38:42,316 - __main__ - INFO - ✓ 数据处理完成
2025-05-23 21:38:42,316 - __main__ - INFO - 操作成功完成
2025-05-23 21:38:44,181 - __main__ - INFO - ============================================================
2025-05-23 21:38:44,181 - __main__ - INFO - 开始模型训练流程
2025-05-23 21:38:44,181 - __main__ - INFO - ============================================================
2025-05-23 21:38:48,612 - main - INFO - ================================================================================
2025-05-23 21:38:48,613 - main - INFO - 🧠 脑网络状态分类器 - 先进版本
2025-05-23 21:38:48,613 - main - INFO - ================================================================================
2025-05-23 21:38:48,613 - main - INFO - 使用设备: cuda
2025-05-23 21:38:48,613 - main - INFO - 📊 加载数据集...
2025-05-23 21:38:48,665 - main - INFO - 数据集加载完成 - 训练集: 60, 验证集: 20, 测试集: 20
2025-05-23 21:38:48,665 - main - INFO - 🏗️  创建先进模型...
2025-05-23 21:38:48,706 - main - INFO - 创建改进模型，参数总数: 790726
2025-05-23 21:38:48,706 - main - INFO - 使用MultiLayerGCN + 先进训练技术的组合
2025-05-23 21:38:48,794 - main - INFO - 🚀 开始训练...
2025-05-23 21:38:48,794 - main - INFO - 🚀 开始先进训练流程...
2025-05-23 21:38:48,796 - main - ERROR - ❌ 训练过程中发生错误: MultiLayerGCN.forward() missing 1 required positional argument: 'x'
2025-05-23 21:38:48,797 - main - ERROR - Traceback (most recent call last):
  File "D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\main.py", line 454, in main
    train_history = trainer.train(train_loader, val_loader, config.NUM_EPOCHS)
  File "D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\main.py", line 331, in train
    train_loss, train_acc = self.train_epoch(train_loader, epoch)
  File "D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\main.py", line 271, in train_epoch
    outputs = self.model(data)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\module.py", line 1739, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "C:\Users\nanqipro\.conda\envs\brain\lib\site-packages\torch\nn\modules\module.py", line 1750, in _call_impl
    return forward_call(*args, **kwargs)
TypeError: MultiLayerGCN.forward() missing 1 required positional argument: 'x'

2025-05-23 21:38:48,798 - __main__ - ERROR - ✗ 模型训练失败: cannot unpack non-iterable int object
2025-05-23 21:38:48,798 - __main__ - ERROR - 操作失败
2025-05-23 21:40:02,030 - __main__ - INFO - ============================================================
2025-05-23 21:40:02,031 - __main__ - INFO - 开始完整的处理和训练流程
2025-05-23 21:40:02,031 - __main__ - INFO - ============================================================
2025-05-23 21:40:02,031 - __main__ - INFO - ============================================================
2025-05-23 21:40:02,031 - __main__ - INFO - 开始数据处理流程
2025-05-23 21:40:02,031 - __main__ - INFO - ============================================================
2025-05-23 21:40:03,078 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:40:03,078 - scn_phase_space_process - INFO - 3D SCN数据处理流程 - Python版本
2025-05-23 21:40:03,079 - scn_phase_space_process - INFO - 增强版本：支持Excel和MAT格式
2025-05-23 21:40:03,079 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:40:03,079 - scn_phase_space_process - INFO - 输出目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets
2025-05-23 21:40:03,080 - scn_phase_space_process - INFO - 
步骤1: 智能数据加载
2025-05-23 21:40:03,080 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:40:03,080 - scn_phase_space_process - INFO - 正在检测和加载数据文件: datasets/EMtrace01.xlsx
2025-05-23 21:40:03,081 - scn_phase_space_process - INFO - 检测到文件格式: excel
2025-05-23 21:40:03,081 - scn_phase_space_process - INFO - 使用Excel数据处理器加载钙离子数据...
2025-05-23 21:40:03,081 - excel_data_processor - INFO - 正在加载Excel数据文件: datasets\EMtrace01.xlsx
2025-05-23 21:40:04,053 - excel_data_processor - INFO - ✓ 成功加载数据: 2999 个时间点, 43 个神经元
2025-05-23 21:40:04,054 - excel_data_processor - INFO - 神经元列: ['n1', 'n2', 'n3', 'n4', 'n5', 'n6', 'n7', 'n8', 'n9', 'n10']...
2025-05-23 21:40:04,054 - excel_data_processor - INFO - 开始预处理钙离子数据...
2025-05-23 21:40:04,060 - excel_data_processor - WARNING - 检测并处理了 247 个异常值
2025-05-23 21:40:04,060 - excel_data_processor - INFO - 执行Z-score标准化...
2025-05-23 21:40:04,063 - excel_data_processor - INFO - ✓ 数据预处理完成: (2999, 43) -> (2999, 43)
2025-05-23 21:40:04,063 - excel_data_processor - INFO - 转换数据为SCN处理格式...
2025-05-23 21:40:04,063 - excel_data_processor - INFO - 分段参数: 段长度=340, 步长=170
2025-05-23 21:40:04,064 - excel_data_processor - INFO - ✓ 转换完成: 10 个神经元, 平均每个神经元 10.0 个时间段
2025-05-23 21:40:04,065 - scn_phase_space_process - INFO - 数据加载信息:
2025-05-23 21:40:04,065 - scn_phase_space_process - INFO -   文件路径: datasets\EMtrace01.xlsx
2025-05-23 21:40:04,066 - scn_phase_space_process - INFO -   时间点数量: 2999
2025-05-23 21:40:04,066 - scn_phase_space_process - INFO -   神经元数量: 43
2025-05-23 21:40:04,066 - scn_phase_space_process - INFO -   数据形状: (2999, 43)
2025-05-23 21:40:04,067 - scn_phase_space_process - INFO -   时间戳范围: 1 - 2999
2025-05-23 21:40:04,067 - scn_phase_space_process - INFO -   神经元ID: ['n1', 'n2', 'n3', 'n4', 'n5', '...']
2025-05-23 21:40:04,067 - scn_phase_space_process - INFO -   缺失值数量: 0
2025-05-23 21:40:04,067 - scn_phase_space_process - INFO -   数据范围: -1.358 - 4.895
2025-05-23 21:40:04,068 - scn_phase_space_process - INFO -   数据均值: -0.000
2025-05-23 21:40:04,068 - scn_phase_space_process - INFO -   数据标准差: 0.578
2025-05-23 21:40:04,068 - scn_phase_space_process - INFO -   数据格式: Excel
2025-05-23 21:40:04,069 - scn_phase_space_process - INFO -   处理器: ExcelCalciumDataProcessor
2025-05-23 21:40:04,069 - scn_phase_space_process - INFO - 
步骤2: 相空间重构
2025-05-23 21:40:04,069 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:40:04,069 - scn_phase_space_process - INFO - 数据维度: 10 个细胞, 10 个时间线
2025-05-23 21:40:04,070 - scn_phase_space_process - INFO - 开始处理钙信号数据...
2025-05-23 21:40:08,744 - scn_phase_space_process - INFO - ✓ 相空间重构完成
2025-05-23 21:40:08,745 - scn_phase_space_process - INFO - 
步骤3: 数据裁剪
2025-05-23 21:40:08,745 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:40:08,745 - scn_phase_space_process - INFO - 开始裁剪数据到统一长度: 170
2025-05-23 21:40:08,745 - scn_phase_space_process - INFO - ✓ 数据裁剪完成
2025-05-23 21:40:08,746 - scn_phase_space_process - INFO - 
步骤4: 构建图数据集
2025-05-23 21:40:08,746 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:40:08,746 - scn_phase_space_process - INFO - 有效样本数量: 100
2025-05-23 21:40:08,747 - scn_phase_space_process - INFO - 生成 nodes.csv 文件...
2025-05-23 21:40:08,748 - scn_phase_space_process - INFO - 转换节点特征格式...
2025-05-23 21:40:08,823 - scn_phase_space_process - INFO - ✓ nodes.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\nodes.csv
2025-05-23 21:40:08,823 - scn_phase_space_process - INFO - 生成 edges.csv 文件...
2025-05-23 21:40:08,836 - scn_phase_space_process - INFO - ✓ edges.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\edges.csv
2025-05-23 21:40:08,837 - scn_phase_space_process - INFO - 生成 graphs.csv 文件...
2025-05-23 21:40:08,837 - scn_phase_space_process - INFO - 外部模块不可用，使用内置的改进标签生成方法...
2025-05-23 21:40:09,036 - scn_phase_space_process - INFO - 使用内置的改进标签生成方法...
2025-05-23 21:40:09,037 - scn_phase_space_process - INFO - 处理 100 个有效样本
2025-05-23 21:40:09,090 - scn_phase_space_process - INFO - 特征矩阵形状: (100, 14)
2025-05-23 21:40:09,092 - scn_phase_space_process - INFO - PCA降维: 14 -> 8
2025-05-23 21:40:09,282 - scn_phase_space_process - INFO - 聚类质量 - 轮廓系数: 0.224
2025-05-23 21:40:09,282 - scn_phase_space_process - INFO - 改进标签分布: {np.int32(0): np.int64(21), np.int32(1): np.int64(28), np.int32(2): np.int64(13), np.int32(3): np.int64(13), np.int32(4): np.int64(9), np.int32(5): np.int64(16)}
2025-05-23 21:40:09,283 - scn_phase_space_process - INFO - 最终标签分布: {np.int32(0): np.int64(21), np.int32(1): np.int64(28), np.int32(2): np.int64(13), np.int32(3): np.int64(13), np.int32(4): np.int64(9), np.int32(5): np.int64(16)}
2025-05-23 21:40:09,285 - scn_phase_space_process - INFO - ✓ graphs.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\graphs.csv
2025-05-23 21:40:09,285 - scn_phase_space_process - INFO - 
============================================================
2025-05-23 21:40:09,286 - scn_phase_space_process - INFO - 数据处理流程全部完成!
2025-05-23 21:40:09,286 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:40:09,286 - scn_phase_space_process - INFO - 数据源信息:
2025-05-23 21:40:09,287 - scn_phase_space_process - INFO -   - 文件: datasets/EMtrace01.xlsx
2025-05-23 21:40:09,287 - scn_phase_space_process - INFO -   - 格式: Excel
2025-05-23 21:40:09,287 - scn_phase_space_process - INFO -   - 处理器: ExcelCalciumDataProcessor
2025-05-23 21:40:09,288 - scn_phase_space_process - INFO - 
生成的文件:
2025-05-23 21:40:09,288 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/nodes.csv
2025-05-23 21:40:09,288 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/edges.csv
2025-05-23 21:40:09,289 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/graphs.csv
2025-05-23 21:40:09,289 - scn_phase_space_process - INFO - 
处理结果:
2025-05-23 21:40:09,290 - scn_phase_space_process - INFO -   - 总样本数量: 100
2025-05-23 21:40:09,290 - scn_phase_space_process - INFO -   - 轨迹长度: 170
2025-05-23 21:40:09,290 - scn_phase_space_process - INFO -   - 嵌入维度: 3
2025-05-23 21:40:09,290 - scn_phase_space_process - INFO - 
下一步操作:
2025-05-23 21:40:09,291 - scn_phase_space_process - INFO -   1. 检查生成的CSV文件质量
2025-05-23 21:40:09,291 - scn_phase_space_process - INFO -   2. 运行训练: python main.py 或 python run.py --train
2025-05-23 21:40:09,291 - scn_phase_space_process - INFO -   3. 查看训练结果: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results
2025-05-23 21:40:09,292 - __main__ - INFO - ✓ 数据处理完成
2025-05-23 21:40:09,292 - __main__ - INFO - ============================================================
2025-05-23 21:40:09,292 - __main__ - INFO - 开始模型训练流程
2025-05-23 21:40:09,292 - __main__ - INFO - ============================================================
2025-05-23 21:40:12,739 - main - INFO - ================================================================================
2025-05-23 21:40:12,739 - main - INFO - 🧠 脑网络状态分类器 - 先进版本
2025-05-23 21:40:12,740 - main - INFO - ================================================================================
2025-05-23 21:40:12,740 - main - INFO - 使用设备: cuda
2025-05-23 21:40:12,740 - main - INFO - 📊 加载数据集...
2025-05-23 21:40:12,869 - main - INFO - 数据集加载完成 - 训练集: 60, 验证集: 20, 测试集: 20
2025-05-23 21:40:12,870 - main - INFO - 🏗️  创建先进模型...
2025-05-23 21:40:12,913 - main - INFO - 创建改进模型，参数总数: 790726
2025-05-23 21:40:12,914 - main - INFO - 使用MultiLayerGCN + 先进训练技术的组合
2025-05-23 21:40:13,005 - main - INFO - 🚀 开始训练...
2025-05-23 21:40:13,006 - main - INFO - 🚀 开始先进训练流程...
2025-05-23 21:40:13,962 - main - INFO - Epoch   0 | Train Loss: 2.4466 | Train Acc: 0.2167 | Val Loss: 2.5909 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:40:13,963 - main - ERROR - ❌ 训练过程中发生错误: EarlyStopping.__call__() missing 1 required positional argument: 'model'
2025-05-23 21:40:13,963 - main - ERROR - Traceback (most recent call last):
  File "D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\main.py", line 454, in main
    train_history = trainer.train(train_loader, val_loader, config.NUM_EPOCHS)
  File "D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\main.py", line 360, in train
    if self.early_stopping(val_loss, self.model):
TypeError: EarlyStopping.__call__() missing 1 required positional argument: 'model'

2025-05-23 21:40:13,964 - __main__ - ERROR - ✗ 模型训练失败: cannot unpack non-iterable int object
2025-05-23 21:40:13,964 - __main__ - ERROR - 模型训练失败
2025-05-23 21:40:13,964 - __main__ - ERROR - 操作失败
2025-05-23 21:40:31,077 - __main__ - INFO - ============================================================
2025-05-23 21:40:31,077 - __main__ - INFO - 开始完整的处理和训练流程
2025-05-23 21:40:31,077 - __main__ - INFO - ============================================================
2025-05-23 21:40:31,077 - __main__ - INFO - ============================================================
2025-05-23 21:40:31,078 - __main__ - INFO - 开始数据处理流程
2025-05-23 21:40:31,078 - __main__ - INFO - ============================================================
2025-05-23 21:40:32,238 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:40:32,238 - scn_phase_space_process - INFO - 3D SCN数据处理流程 - Python版本
2025-05-23 21:40:32,239 - scn_phase_space_process - INFO - 增强版本：支持Excel和MAT格式
2025-05-23 21:40:32,239 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:40:32,240 - scn_phase_space_process - INFO - 输出目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets
2025-05-23 21:40:32,240 - scn_phase_space_process - INFO - 
步骤1: 智能数据加载
2025-05-23 21:40:32,240 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:40:32,240 - scn_phase_space_process - INFO - 正在检测和加载数据文件: datasets/EMtrace01.xlsx
2025-05-23 21:40:32,240 - scn_phase_space_process - INFO - 检测到文件格式: excel
2025-05-23 21:40:32,241 - scn_phase_space_process - INFO - 使用Excel数据处理器加载钙离子数据...
2025-05-23 21:40:32,241 - excel_data_processor - INFO - 正在加载Excel数据文件: datasets\EMtrace01.xlsx
2025-05-23 21:40:33,285 - excel_data_processor - INFO - ✓ 成功加载数据: 2999 个时间点, 43 个神经元
2025-05-23 21:40:33,285 - excel_data_processor - INFO - 神经元列: ['n1', 'n2', 'n3', 'n4', 'n5', 'n6', 'n7', 'n8', 'n9', 'n10']...
2025-05-23 21:40:33,285 - excel_data_processor - INFO - 开始预处理钙离子数据...
2025-05-23 21:40:33,293 - excel_data_processor - WARNING - 检测并处理了 247 个异常值
2025-05-23 21:40:33,294 - excel_data_processor - INFO - 执行Z-score标准化...
2025-05-23 21:40:33,297 - excel_data_processor - INFO - ✓ 数据预处理完成: (2999, 43) -> (2999, 43)
2025-05-23 21:40:33,297 - excel_data_processor - INFO - 转换数据为SCN处理格式...
2025-05-23 21:40:33,297 - excel_data_processor - INFO - 分段参数: 段长度=340, 步长=170
2025-05-23 21:40:33,298 - excel_data_processor - INFO - ✓ 转换完成: 10 个神经元, 平均每个神经元 10.0 个时间段
2025-05-23 21:40:33,300 - scn_phase_space_process - INFO - 数据加载信息:
2025-05-23 21:40:33,301 - scn_phase_space_process - INFO -   文件路径: datasets\EMtrace01.xlsx
2025-05-23 21:40:33,301 - scn_phase_space_process - INFO -   时间点数量: 2999
2025-05-23 21:40:33,301 - scn_phase_space_process - INFO -   神经元数量: 43
2025-05-23 21:40:33,301 - scn_phase_space_process - INFO -   数据形状: (2999, 43)
2025-05-23 21:40:33,302 - scn_phase_space_process - INFO -   时间戳范围: 1 - 2999
2025-05-23 21:40:33,302 - scn_phase_space_process - INFO -   神经元ID: ['n1', 'n2', 'n3', 'n4', 'n5', '...']
2025-05-23 21:40:33,304 - scn_phase_space_process - INFO -   缺失值数量: 0
2025-05-23 21:40:33,304 - scn_phase_space_process - INFO -   数据范围: -1.358 - 4.895
2025-05-23 21:40:33,305 - scn_phase_space_process - INFO -   数据均值: -0.000
2025-05-23 21:40:33,305 - scn_phase_space_process - INFO -   数据标准差: 0.578
2025-05-23 21:40:33,305 - scn_phase_space_process - INFO -   数据格式: Excel
2025-05-23 21:40:33,306 - scn_phase_space_process - INFO -   处理器: ExcelCalciumDataProcessor
2025-05-23 21:40:33,306 - scn_phase_space_process - INFO - 
步骤2: 相空间重构
2025-05-23 21:40:33,307 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:40:33,307 - scn_phase_space_process - INFO - 数据维度: 10 个细胞, 10 个时间线
2025-05-23 21:40:33,307 - scn_phase_space_process - INFO - 开始处理钙信号数据...
2025-05-23 21:40:38,098 - scn_phase_space_process - INFO - ✓ 相空间重构完成
2025-05-23 21:40:38,099 - scn_phase_space_process - INFO - 
步骤3: 数据裁剪
2025-05-23 21:40:38,099 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:40:38,099 - scn_phase_space_process - INFO - 开始裁剪数据到统一长度: 170
2025-05-23 21:40:38,099 - scn_phase_space_process - INFO - ✓ 数据裁剪完成
2025-05-23 21:40:38,100 - scn_phase_space_process - INFO - 
步骤4: 构建图数据集
2025-05-23 21:40:38,100 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:40:38,100 - scn_phase_space_process - INFO - 有效样本数量: 100
2025-05-23 21:40:38,100 - scn_phase_space_process - INFO - 生成 nodes.csv 文件...
2025-05-23 21:40:38,100 - scn_phase_space_process - INFO - 转换节点特征格式...
2025-05-23 21:40:38,177 - scn_phase_space_process - INFO - ✓ nodes.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\nodes.csv
2025-05-23 21:40:38,177 - scn_phase_space_process - INFO - 生成 edges.csv 文件...
2025-05-23 21:40:38,189 - scn_phase_space_process - INFO - ✓ edges.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\edges.csv
2025-05-23 21:40:38,190 - scn_phase_space_process - INFO - 生成 graphs.csv 文件...
2025-05-23 21:40:38,190 - scn_phase_space_process - INFO - 外部模块不可用，使用内置的改进标签生成方法...
2025-05-23 21:40:38,388 - scn_phase_space_process - INFO - 使用内置的改进标签生成方法...
2025-05-23 21:40:38,388 - scn_phase_space_process - INFO - 处理 100 个有效样本
2025-05-23 21:40:38,438 - scn_phase_space_process - INFO - 特征矩阵形状: (100, 14)
2025-05-23 21:40:38,439 - scn_phase_space_process - INFO - PCA降维: 14 -> 8
2025-05-23 21:40:38,598 - scn_phase_space_process - INFO - 聚类质量 - 轮廓系数: 0.224
2025-05-23 21:40:38,598 - scn_phase_space_process - INFO - 改进标签分布: {np.int32(0): np.int64(21), np.int32(1): np.int64(28), np.int32(2): np.int64(13), np.int32(3): np.int64(13), np.int32(4): np.int64(9), np.int32(5): np.int64(16)}
2025-05-23 21:40:38,599 - scn_phase_space_process - INFO - 最终标签分布: {np.int32(0): np.int64(21), np.int32(1): np.int64(28), np.int32(2): np.int64(13), np.int32(3): np.int64(13), np.int32(4): np.int64(9), np.int32(5): np.int64(16)}
2025-05-23 21:40:38,601 - scn_phase_space_process - INFO - ✓ graphs.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\graphs.csv
2025-05-23 21:40:38,601 - scn_phase_space_process - INFO - 
============================================================
2025-05-23 21:40:38,601 - scn_phase_space_process - INFO - 数据处理流程全部完成!
2025-05-23 21:40:38,602 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:40:38,602 - scn_phase_space_process - INFO - 数据源信息:
2025-05-23 21:40:38,602 - scn_phase_space_process - INFO -   - 文件: datasets/EMtrace01.xlsx
2025-05-23 21:40:38,603 - scn_phase_space_process - INFO -   - 格式: Excel
2025-05-23 21:40:38,603 - scn_phase_space_process - INFO -   - 处理器: ExcelCalciumDataProcessor
2025-05-23 21:40:38,603 - scn_phase_space_process - INFO - 
生成的文件:
2025-05-23 21:40:38,604 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/nodes.csv
2025-05-23 21:40:38,604 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/edges.csv
2025-05-23 21:40:38,604 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/graphs.csv
2025-05-23 21:40:38,605 - scn_phase_space_process - INFO - 
处理结果:
2025-05-23 21:40:38,605 - scn_phase_space_process - INFO -   - 总样本数量: 100
2025-05-23 21:40:38,605 - scn_phase_space_process - INFO -   - 轨迹长度: 170
2025-05-23 21:40:38,606 - scn_phase_space_process - INFO -   - 嵌入维度: 3
2025-05-23 21:40:38,606 - scn_phase_space_process - INFO - 
下一步操作:
2025-05-23 21:40:38,607 - scn_phase_space_process - INFO -   1. 检查生成的CSV文件质量
2025-05-23 21:40:38,607 - scn_phase_space_process - INFO -   2. 运行训练: python main.py 或 python run.py --train
2025-05-23 21:40:38,607 - scn_phase_space_process - INFO -   3. 查看训练结果: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results
2025-05-23 21:40:38,608 - __main__ - INFO - ✓ 数据处理完成
2025-05-23 21:40:38,608 - __main__ - INFO - ============================================================
2025-05-23 21:40:38,608 - __main__ - INFO - 开始模型训练流程
2025-05-23 21:40:38,609 - __main__ - INFO - ============================================================
2025-05-23 21:40:42,341 - main - INFO - ================================================================================
2025-05-23 21:40:42,341 - main - INFO - 🧠 脑网络状态分类器 - 先进版本
2025-05-23 21:40:42,341 - main - INFO - ================================================================================
2025-05-23 21:40:42,341 - main - INFO - 使用设备: cuda
2025-05-23 21:40:42,342 - main - INFO - 📊 加载数据集...
2025-05-23 21:40:42,465 - main - INFO - 数据集加载完成 - 训练集: 60, 验证集: 20, 测试集: 20
2025-05-23 21:40:42,466 - main - INFO - 🏗️  创建先进模型...
2025-05-23 21:40:42,506 - main - INFO - 创建改进模型，参数总数: 790726
2025-05-23 21:40:42,506 - main - INFO - 使用MultiLayerGCN + 先进训练技术的组合
2025-05-23 21:40:42,595 - main - INFO - 🚀 开始训练...
2025-05-23 21:40:42,595 - main - INFO - 🚀 开始先进训练流程...
2025-05-23 21:40:43,459 - main - INFO - Epoch   0 | Train Loss: 2.1352 | Train Acc: 0.1500 | Val Loss: 1.3112 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:40:44,040 - main - INFO - Epoch   1 | Train Loss: 2.3319 | Train Acc: 0.1833 | Val Loss: 1.6026 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:40:44,582 - main - INFO - Epoch   2 | Train Loss: 2.0324 | Train Acc: 0.1833 | Val Loss: 1.8728 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:40:45,161 - main - INFO - Epoch   3 | Train Loss: 2.0762 | Train Acc: 0.2000 | Val Loss: 1.6001 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:40:45,770 - main - INFO - Epoch   4 | Train Loss: 1.5873 | Train Acc: 0.3167 | Val Loss: 1.3004 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:40:46,373 - main - INFO - Epoch   5 | Train Loss: 1.8078 | Train Acc: 0.2167 | Val Loss: 1.1890 | Val Acc: 0.3000 | Val Balanced Acc: 0.2000 | LR: 0.001000
2025-05-23 21:40:46,967 - main - INFO - Epoch   6 | Train Loss: 1.7451 | Train Acc: 0.2167 | Val Loss: 1.1942 | Val Acc: 0.2000 | Val Balanced Acc: 0.1333 | LR: 0.001000
2025-05-23 21:40:47,577 - main - INFO - Epoch   7 | Train Loss: 1.5509 | Train Acc: 0.2500 | Val Loss: 1.3767 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:40:48,168 - main - INFO - Epoch   8 | Train Loss: 1.7240 | Train Acc: 0.2167 | Val Loss: 1.2164 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:40:48,774 - main - INFO - Epoch   9 | Train Loss: 1.5210 | Train Acc: 0.2500 | Val Loss: 1.2477 | Val Acc: 0.3000 | Val Balanced Acc: 0.2000 | LR: 0.001000
2025-05-23 21:40:49,391 - main - INFO - Epoch  10 | Train Loss: 1.6889 | Train Acc: 0.2000 | Val Loss: 1.4226 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:40:55,958 - main - INFO - Epoch  20 | Train Loss: 1.4097 | Train Acc: 0.2667 | Val Loss: 1.2619 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:40:59,055 - main - INFO - 早停触发，停止训练。最佳验证准确率: 0.3500
2025-05-23 21:40:59,056 - main - INFO - 恢复最佳模型，验证准确率: 0.3500
2025-05-23 21:40:59,056 - main - INFO - 🔍 测试最终性能...
2025-05-23 21:40:59,151 - main - INFO - ============================================================
2025-05-23 21:40:59,151 - main - INFO - 📊 最终结果:
2025-05-23 21:40:59,152 - main - INFO - 测试准确率: 0.2500
2025-05-23 21:40:59,152 - main - INFO - 平衡准确率: 0.1667
2025-05-23 21:40:59,152 - main - INFO - 测试损失: 1.4817
2025-05-23 21:40:59,153 - main - INFO - ============================================================
2025-05-23 21:40:59,160 - main - INFO - ✅ 模型和结果已保存
2025-05-23 21:40:59,160 - __main__ - ERROR - ✗ 模型训练失败: cannot unpack non-iterable float object
2025-05-23 21:40:59,161 - __main__ - ERROR - 模型训练失败
2025-05-23 21:40:59,161 - __main__ - ERROR - 操作失败
2025-05-23 21:42:00,552 - __main__ - INFO - ============================================================
2025-05-23 21:42:00,552 - __main__ - INFO - 开始完整的处理和训练流程
2025-05-23 21:42:00,553 - __main__ - INFO - ============================================================
2025-05-23 21:42:00,553 - __main__ - INFO - ============================================================
2025-05-23 21:42:00,553 - __main__ - INFO - 开始数据处理流程
2025-05-23 21:42:00,553 - __main__ - INFO - ============================================================
2025-05-23 21:42:01,665 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:42:01,666 - scn_phase_space_process - INFO - 3D SCN数据处理流程 - Python版本
2025-05-23 21:42:01,666 - scn_phase_space_process - INFO - 增强版本：支持Excel和MAT格式
2025-05-23 21:42:01,666 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:42:01,667 - scn_phase_space_process - INFO - 输出目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets
2025-05-23 21:42:01,667 - scn_phase_space_process - INFO - 
步骤1: 智能数据加载
2025-05-23 21:42:01,667 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:42:01,667 - scn_phase_space_process - INFO - 正在检测和加载数据文件: datasets/EMtrace01.xlsx
2025-05-23 21:42:01,667 - scn_phase_space_process - INFO - 检测到文件格式: excel
2025-05-23 21:42:01,668 - scn_phase_space_process - INFO - 使用Excel数据处理器加载钙离子数据...
2025-05-23 21:42:01,668 - excel_data_processor - INFO - 正在加载Excel数据文件: datasets\EMtrace01.xlsx
2025-05-23 21:42:02,616 - excel_data_processor - INFO - ✓ 成功加载数据: 2999 个时间点, 43 个神经元
2025-05-23 21:42:02,616 - excel_data_processor - INFO - 神经元列: ['n1', 'n2', 'n3', 'n4', 'n5', 'n6', 'n7', 'n8', 'n9', 'n10']...
2025-05-23 21:42:02,617 - excel_data_processor - INFO - 开始预处理钙离子数据...
2025-05-23 21:42:02,622 - excel_data_processor - WARNING - 检测并处理了 247 个异常值
2025-05-23 21:42:02,622 - excel_data_processor - INFO - 执行Z-score标准化...
2025-05-23 21:42:02,625 - excel_data_processor - INFO - ✓ 数据预处理完成: (2999, 43) -> (2999, 43)
2025-05-23 21:42:02,626 - excel_data_processor - INFO - 转换数据为SCN处理格式...
2025-05-23 21:42:02,626 - excel_data_processor - INFO - 分段参数: 段长度=340, 步长=170
2025-05-23 21:42:02,626 - excel_data_processor - INFO - ✓ 转换完成: 10 个神经元, 平均每个神经元 10.0 个时间段
2025-05-23 21:42:02,628 - scn_phase_space_process - INFO - 数据加载信息:
2025-05-23 21:42:02,628 - scn_phase_space_process - INFO -   文件路径: datasets\EMtrace01.xlsx
2025-05-23 21:42:02,629 - scn_phase_space_process - INFO -   时间点数量: 2999
2025-05-23 21:42:02,629 - scn_phase_space_process - INFO -   神经元数量: 43
2025-05-23 21:42:02,629 - scn_phase_space_process - INFO -   数据形状: (2999, 43)
2025-05-23 21:42:02,630 - scn_phase_space_process - INFO -   时间戳范围: 1 - 2999
2025-05-23 21:42:02,630 - scn_phase_space_process - INFO -   神经元ID: ['n1', 'n2', 'n3', 'n4', 'n5', '...']
2025-05-23 21:42:02,630 - scn_phase_space_process - INFO -   缺失值数量: 0
2025-05-23 21:42:02,630 - scn_phase_space_process - INFO -   数据范围: -1.358 - 4.895
2025-05-23 21:42:02,631 - scn_phase_space_process - INFO -   数据均值: -0.000
2025-05-23 21:42:02,631 - scn_phase_space_process - INFO -   数据标准差: 0.578
2025-05-23 21:42:02,631 - scn_phase_space_process - INFO -   数据格式: Excel
2025-05-23 21:42:02,631 - scn_phase_space_process - INFO -   处理器: ExcelCalciumDataProcessor
2025-05-23 21:42:02,631 - scn_phase_space_process - INFO - 
步骤2: 相空间重构
2025-05-23 21:42:02,632 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:42:02,632 - scn_phase_space_process - INFO - 数据维度: 10 个细胞, 10 个时间线
2025-05-23 21:42:02,632 - scn_phase_space_process - INFO - 开始处理钙信号数据...
2025-05-23 21:42:07,341 - scn_phase_space_process - INFO - ✓ 相空间重构完成
2025-05-23 21:42:07,342 - scn_phase_space_process - INFO - 
步骤3: 数据裁剪
2025-05-23 21:42:07,342 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:42:07,342 - scn_phase_space_process - INFO - 开始裁剪数据到统一长度: 170
2025-05-23 21:42:07,342 - scn_phase_space_process - INFO - ✓ 数据裁剪完成
2025-05-23 21:42:07,343 - scn_phase_space_process - INFO - 
步骤4: 构建图数据集
2025-05-23 21:42:07,343 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:42:07,343 - scn_phase_space_process - INFO - 有效样本数量: 100
2025-05-23 21:42:07,343 - scn_phase_space_process - INFO - 生成 nodes.csv 文件...
2025-05-23 21:42:07,343 - scn_phase_space_process - INFO - 转换节点特征格式...
2025-05-23 21:42:07,419 - scn_phase_space_process - INFO - ✓ nodes.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\nodes.csv
2025-05-23 21:42:07,419 - scn_phase_space_process - INFO - 生成 edges.csv 文件...
2025-05-23 21:42:07,431 - scn_phase_space_process - INFO - ✓ edges.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\edges.csv
2025-05-23 21:42:07,431 - scn_phase_space_process - INFO - 生成 graphs.csv 文件...
2025-05-23 21:42:07,432 - scn_phase_space_process - INFO - 外部模块不可用，使用内置的改进标签生成方法...
2025-05-23 21:42:07,648 - scn_phase_space_process - INFO - 使用内置的改进标签生成方法...
2025-05-23 21:42:07,648 - scn_phase_space_process - INFO - 处理 100 个有效样本
2025-05-23 21:42:07,702 - scn_phase_space_process - INFO - 特征矩阵形状: (100, 14)
2025-05-23 21:42:07,703 - scn_phase_space_process - INFO - PCA降维: 14 -> 8
2025-05-23 21:42:07,890 - scn_phase_space_process - INFO - 聚类质量 - 轮廓系数: 0.224
2025-05-23 21:42:07,891 - scn_phase_space_process - INFO - 改进标签分布: {np.int32(0): np.int64(21), np.int32(1): np.int64(28), np.int32(2): np.int64(13), np.int32(3): np.int64(13), np.int32(4): np.int64(9), np.int32(5): np.int64(16)}
2025-05-23 21:42:07,892 - scn_phase_space_process - INFO - 最终标签分布: {np.int32(0): np.int64(21), np.int32(1): np.int64(28), np.int32(2): np.int64(13), np.int32(3): np.int64(13), np.int32(4): np.int64(9), np.int32(5): np.int64(16)}
2025-05-23 21:42:07,893 - scn_phase_space_process - INFO - ✓ graphs.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\graphs.csv
2025-05-23 21:42:07,894 - scn_phase_space_process - INFO - 
============================================================
2025-05-23 21:42:07,894 - scn_phase_space_process - INFO - 数据处理流程全部完成!
2025-05-23 21:42:07,894 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:42:07,895 - scn_phase_space_process - INFO - 数据源信息:
2025-05-23 21:42:07,895 - scn_phase_space_process - INFO -   - 文件: datasets/EMtrace01.xlsx
2025-05-23 21:42:07,895 - scn_phase_space_process - INFO -   - 格式: Excel
2025-05-23 21:42:07,896 - scn_phase_space_process - INFO -   - 处理器: ExcelCalciumDataProcessor
2025-05-23 21:42:07,896 - scn_phase_space_process - INFO - 
生成的文件:
2025-05-23 21:42:07,896 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/nodes.csv
2025-05-23 21:42:07,897 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/edges.csv
2025-05-23 21:42:07,897 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/graphs.csv
2025-05-23 21:42:07,897 - scn_phase_space_process - INFO - 
处理结果:
2025-05-23 21:42:07,898 - scn_phase_space_process - INFO -   - 总样本数量: 100
2025-05-23 21:42:07,898 - scn_phase_space_process - INFO -   - 轨迹长度: 170
2025-05-23 21:42:07,898 - scn_phase_space_process - INFO -   - 嵌入维度: 3
2025-05-23 21:42:07,899 - scn_phase_space_process - INFO - 
下一步操作:
2025-05-23 21:42:07,899 - scn_phase_space_process - INFO -   1. 检查生成的CSV文件质量
2025-05-23 21:42:07,899 - scn_phase_space_process - INFO -   2. 运行训练: python main.py 或 python run.py --train
2025-05-23 21:42:07,900 - scn_phase_space_process - INFO -   3. 查看训练结果: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results
2025-05-23 21:42:07,900 - __main__ - INFO - ✓ 数据处理完成
2025-05-23 21:42:07,900 - __main__ - INFO - ============================================================
2025-05-23 21:42:07,900 - __main__ - INFO - 开始模型训练流程
2025-05-23 21:42:07,900 - __main__ - INFO - ============================================================
2025-05-23 21:42:11,287 - main - INFO - ================================================================================
2025-05-23 21:42:11,287 - main - INFO - 🧠 脑网络状态分类器 - 先进版本
2025-05-23 21:42:11,288 - main - INFO - ================================================================================
2025-05-23 21:42:11,288 - main - INFO - 使用设备: cuda
2025-05-23 21:42:11,288 - main - INFO - 📊 加载数据集...
2025-05-23 21:42:11,414 - main - INFO - 数据集加载完成 - 训练集: 60, 验证集: 20, 测试集: 20
2025-05-23 21:42:11,415 - main - INFO - 🏗️  创建先进模型...
2025-05-23 21:42:11,455 - main - INFO - 创建改进模型，参数总数: 790726
2025-05-23 21:42:11,455 - main - INFO - 使用MultiLayerGCN + 先进训练技术的组合
2025-05-23 21:42:11,543 - main - INFO - 🚀 开始训练...
2025-05-23 21:42:11,543 - main - INFO - 🚀 开始先进训练流程...
2025-05-23 21:42:12,459 - main - INFO - Epoch   0 | Train Loss: 2.6201 | Train Acc: 0.1833 | Val Loss: 1.6320 | Val Acc: 0.1500 | Val Balanced Acc: 0.1222 | LR: 0.001000
2025-05-23 21:42:13,102 - main - INFO - Epoch   1 | Train Loss: 2.2427 | Train Acc: 0.2333 | Val Loss: 1.5060 | Val Acc: 0.0500 | Val Balanced Acc: 0.0556 | LR: 0.001000
2025-05-23 21:42:13,759 - main - INFO - Epoch   2 | Train Loss: 2.4089 | Train Acc: 0.2500 | Val Loss: 1.4254 | Val Acc: 0.3000 | Val Balanced Acc: 0.2222 | LR: 0.001000
2025-05-23 21:42:14,427 - main - INFO - Epoch   3 | Train Loss: 1.7502 | Train Acc: 0.2000 | Val Loss: 1.7707 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:42:15,086 - main - INFO - Epoch   4 | Train Loss: 1.4870 | Train Acc: 0.3167 | Val Loss: 1.5106 | Val Acc: 0.3000 | Val Balanced Acc: 0.2000 | LR: 0.001000
2025-05-23 21:42:15,734 - main - INFO - Epoch   5 | Train Loss: 1.6627 | Train Acc: 0.2167 | Val Loss: 1.2145 | Val Acc: 0.3000 | Val Balanced Acc: 0.2000 | LR: 0.001000
2025-05-23 21:42:16,396 - main - INFO - Epoch   6 | Train Loss: 1.6226 | Train Acc: 0.2167 | Val Loss: 1.3799 | Val Acc: 0.3000 | Val Balanced Acc: 0.3333 | LR: 0.001000
2025-05-23 21:42:17,069 - main - INFO - Epoch   7 | Train Loss: 1.8090 | Train Acc: 0.2333 | Val Loss: 1.3578 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:42:17,760 - main - INFO - Epoch   8 | Train Loss: 1.6625 | Train Acc: 0.3000 | Val Loss: 1.2785 | Val Acc: 0.3000 | Val Balanced Acc: 0.3333 | LR: 0.001000
2025-05-23 21:42:18,442 - main - INFO - Epoch   9 | Train Loss: 1.4530 | Train Acc: 0.2833 | Val Loss: 1.2974 | Val Acc: 0.3500 | Val Balanced Acc: 0.2333 | LR: 0.001000
2025-05-23 21:42:19,120 - main - INFO - Epoch  10 | Train Loss: 1.8471 | Train Acc: 0.3333 | Val Loss: 1.1420 | Val Acc: 0.3500 | Val Balanced Acc: 0.2333 | LR: 0.001000
2025-05-23 21:42:25,870 - main - INFO - Epoch  20 | Train Loss: 1.4442 | Train Acc: 0.1833 | Val Loss: 1.2883 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:42:32,867 - main - INFO - Epoch  30 | Train Loss: 0.9384 | Train Acc: 0.4000 | Val Loss: 1.2225 | Val Acc: 0.3500 | Val Balanced Acc: 0.2333 | LR: 0.000500
2025-05-23 21:42:32,868 - main - INFO - 早停触发，停止训练。最佳验证准确率: 0.4000
2025-05-23 21:42:32,869 - main - INFO - 恢复最佳模型，验证准确率: 0.4000
2025-05-23 21:42:32,869 - main - INFO - 🔍 测试最终性能...
2025-05-23 21:42:32,977 - main - INFO - ============================================================
2025-05-23 21:42:32,977 - main - INFO - 📊 最终结果:
2025-05-23 21:42:32,978 - main - INFO - 测试准确率: 0.2500
2025-05-23 21:42:32,978 - main - INFO - 平衡准确率: 0.2111
2025-05-23 21:42:32,978 - main - INFO - 测试损失: 2.1906
2025-05-23 21:42:32,978 - main - INFO - ============================================================
2025-05-23 21:42:32,985 - main - INFO - ✅ 模型和结果已保存
2025-05-23 21:42:32,986 - __main__ - ERROR - ✗ 模型训练失败: cannot unpack non-iterable float object
2025-05-23 21:42:32,986 - __main__ - ERROR - 模型训练失败
2025-05-23 21:42:32,986 - __main__ - ERROR - 操作失败
2025-05-23 21:44:45,467 - __main__ - INFO - ============================================================
2025-05-23 21:44:45,467 - __main__ - INFO - 开始模型训练流程
2025-05-23 21:44:45,467 - __main__ - INFO - ============================================================
2025-05-23 21:44:49,817 - main - INFO - ================================================================================
2025-05-23 21:44:49,817 - main - INFO - 🧠 脑网络状态分类器 - 先进版本
2025-05-23 21:44:49,817 - main - INFO - ================================================================================
2025-05-23 21:44:49,818 - main - INFO - 使用设备: cuda
2025-05-23 21:44:49,818 - main - INFO - 📊 加载数据集...
2025-05-23 21:44:49,869 - main - INFO - 数据集加载完成 - 训练集: 60, 验证集: 20, 测试集: 20
2025-05-23 21:44:49,869 - main - INFO - 🏗️  创建先进模型...
2025-05-23 21:44:49,909 - main - INFO - 创建改进模型，参数总数: 790726
2025-05-23 21:44:49,909 - main - INFO - 使用MultiLayerGCN + 先进训练技术的组合
2025-05-23 21:44:49,999 - main - INFO - 🚀 开始训练...
2025-05-23 21:44:49,999 - main - INFO - 🚀 开始先进训练流程...
2025-05-23 21:44:50,868 - main - INFO - Epoch   0 | Train Loss: 2.2867 | Train Acc: 0.1833 | Val Loss: 1.5192 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:44:51,476 - main - INFO - Epoch   1 | Train Loss: 1.9610 | Train Acc: 0.2333 | Val Loss: 1.3059 | Val Acc: 0.1500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:44:52,065 - main - INFO - Epoch   2 | Train Loss: 1.7946 | Train Acc: 0.2500 | Val Loss: 1.5183 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:44:52,636 - main - INFO - Epoch   3 | Train Loss: 1.7610 | Train Acc: 0.2333 | Val Loss: 1.5378 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:44:53,259 - main - INFO - Epoch   4 | Train Loss: 1.7982 | Train Acc: 0.2167 | Val Loss: 1.3217 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:44:53,850 - main - INFO - Epoch   5 | Train Loss: 1.8875 | Train Acc: 0.2500 | Val Loss: 1.1704 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:44:54,451 - main - INFO - Epoch   6 | Train Loss: 1.6618 | Train Acc: 0.3667 | Val Loss: 1.7359 | Val Acc: 0.2000 | Val Balanced Acc: 0.1333 | LR: 0.001000
2025-05-23 21:44:55,014 - main - INFO - Epoch   7 | Train Loss: 1.9757 | Train Acc: 0.2500 | Val Loss: 1.6206 | Val Acc: 0.2000 | Val Balanced Acc: 0.1333 | LR: 0.001000
2025-05-23 21:44:55,571 - main - INFO - Epoch   8 | Train Loss: 1.7583 | Train Acc: 0.2167 | Val Loss: 1.5561 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:44:56,147 - main - INFO - Epoch   9 | Train Loss: 1.9381 | Train Acc: 0.1167 | Val Loss: 1.2748 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:44:56,768 - main - INFO - Epoch  10 | Train Loss: 1.3858 | Train Acc: 0.2500 | Val Loss: 1.5088 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:45:02,649 - main - INFO - Epoch  20 | Train Loss: 1.5307 | Train Acc: 0.4000 | Val Loss: 1.1860 | Val Acc: 0.3500 | Val Balanced Acc: 0.3333 | LR: 0.001000
2025-05-23 21:45:08,570 - main - INFO - Epoch  30 | Train Loss: 1.0905 | Train Acc: 0.4500 | Val Loss: 1.3933 | Val Acc: 0.3500 | Val Balanced Acc: 0.2333 | LR: 0.001000
2025-05-23 21:45:13,328 - main - INFO - 早停触发，停止训练。最佳验证准确率: 0.5000
2025-05-23 21:45:13,329 - main - INFO - 恢复最佳模型，验证准确率: 0.5000
2025-05-23 21:45:13,330 - main - INFO - 🔍 测试最终性能...
2025-05-23 21:45:13,420 - main - INFO - ============================================================
2025-05-23 21:45:13,420 - main - INFO - 📊 最终结果:
2025-05-23 21:45:13,421 - main - INFO - 测试准确率: 0.2000
2025-05-23 21:45:13,421 - main - INFO - 平衡准确率: 0.2750
2025-05-23 21:45:13,421 - main - INFO - 测试损失: 3.7496
2025-05-23 21:45:13,421 - main - INFO - ============================================================
2025-05-23 21:45:13,429 - main - INFO - ✅ 模型和结果已保存
2025-05-23 21:45:13,429 - __main__ - INFO - ✓ 模型训练完成
2025-05-23 21:45:13,430 - __main__ - INFO - 最终测试准确率: 0.2000
2025-05-23 21:45:13,430 - __main__ - INFO - 操作成功完成
2025-05-23 21:46:49,275 - __main__ - INFO - ============================================================
2025-05-23 21:46:49,275 - __main__ - INFO - 开始完整的处理和训练流程
2025-05-23 21:46:49,276 - __main__ - INFO - ============================================================
2025-05-23 21:46:49,276 - __main__ - INFO - ============================================================
2025-05-23 21:46:49,276 - __main__ - INFO - 开始数据处理流程
2025-05-23 21:46:49,276 - __main__ - INFO - ============================================================
2025-05-23 21:46:50,255 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:46:50,255 - scn_phase_space_process - INFO - 3D SCN数据处理流程 - Python版本
2025-05-23 21:46:50,255 - scn_phase_space_process - INFO - 增强版本：支持Excel和MAT格式
2025-05-23 21:46:50,256 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:46:50,256 - scn_phase_space_process - INFO - 输出目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets
2025-05-23 21:46:50,256 - scn_phase_space_process - INFO - 
步骤1: 智能数据加载
2025-05-23 21:46:50,257 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:46:50,257 - scn_phase_space_process - INFO - 正在检测和加载数据文件: datasets/EMtrace01.xlsx
2025-05-23 21:46:50,258 - scn_phase_space_process - INFO - 检测到文件格式: excel
2025-05-23 21:46:50,258 - scn_phase_space_process - INFO - 使用Excel数据处理器加载钙离子数据...
2025-05-23 21:46:50,258 - excel_data_processor - INFO - 正在加载Excel数据文件: datasets\EMtrace01.xlsx
2025-05-23 21:46:51,145 - excel_data_processor - INFO - ✓ 成功加载数据: 2999 个时间点, 43 个神经元
2025-05-23 21:46:51,145 - excel_data_processor - INFO - 神经元列: ['n1', 'n2', 'n3', 'n4', 'n5', 'n6', 'n7', 'n8', 'n9', 'n10']...
2025-05-23 21:46:51,145 - excel_data_processor - INFO - 开始预处理钙离子数据...
2025-05-23 21:46:51,151 - excel_data_processor - WARNING - 检测并处理了 247 个异常值
2025-05-23 21:46:51,151 - excel_data_processor - INFO - 执行Z-score标准化...
2025-05-23 21:46:51,154 - excel_data_processor - INFO - ✓ 数据预处理完成: (2999, 43) -> (2999, 43)
2025-05-23 21:46:51,154 - excel_data_processor - INFO - 转换数据为SCN处理格式...
2025-05-23 21:46:51,154 - excel_data_processor - INFO - 分段参数: 段长度=340, 步长=170
2025-05-23 21:46:51,154 - excel_data_processor - INFO - ✓ 转换完成: 10 个神经元, 平均每个神经元 10.0 个时间段
2025-05-23 21:46:51,156 - scn_phase_space_process - INFO - 数据加载信息:
2025-05-23 21:46:51,156 - scn_phase_space_process - INFO -   文件路径: datasets\EMtrace01.xlsx
2025-05-23 21:46:51,156 - scn_phase_space_process - INFO -   时间点数量: 2999
2025-05-23 21:46:51,157 - scn_phase_space_process - INFO -   神经元数量: 43
2025-05-23 21:46:51,157 - scn_phase_space_process - INFO -   数据形状: (2999, 43)
2025-05-23 21:46:51,157 - scn_phase_space_process - INFO -   时间戳范围: 1 - 2999
2025-05-23 21:46:51,157 - scn_phase_space_process - INFO -   神经元ID: ['n1', 'n2', 'n3', 'n4', 'n5', '...']
2025-05-23 21:46:51,157 - scn_phase_space_process - INFO -   缺失值数量: 0
2025-05-23 21:46:51,158 - scn_phase_space_process - INFO -   数据范围: -1.358 - 4.895
2025-05-23 21:46:51,158 - scn_phase_space_process - INFO -   数据均值: -0.000
2025-05-23 21:46:51,158 - scn_phase_space_process - INFO -   数据标准差: 0.578
2025-05-23 21:46:51,158 - scn_phase_space_process - INFO -   数据格式: Excel
2025-05-23 21:46:51,158 - scn_phase_space_process - INFO -   处理器: ExcelCalciumDataProcessor
2025-05-23 21:46:51,159 - scn_phase_space_process - INFO - 
步骤2: 相空间重构
2025-05-23 21:46:51,159 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:46:51,159 - scn_phase_space_process - INFO - 数据维度: 10 个细胞, 10 个时间线
2025-05-23 21:46:51,159 - scn_phase_space_process - INFO - 开始处理钙信号数据...
2025-05-23 21:46:55,680 - scn_phase_space_process - INFO - ✓ 相空间重构完成
2025-05-23 21:46:55,680 - scn_phase_space_process - INFO - 
步骤3: 数据裁剪
2025-05-23 21:46:55,681 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:46:55,681 - scn_phase_space_process - INFO - 开始裁剪数据到统一长度: 170
2025-05-23 21:46:55,681 - scn_phase_space_process - INFO - ✓ 数据裁剪完成
2025-05-23 21:46:55,681 - scn_phase_space_process - INFO - 
步骤4: 构建图数据集
2025-05-23 21:46:55,681 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:46:55,681 - scn_phase_space_process - INFO - 有效样本数量: 100
2025-05-23 21:46:55,682 - scn_phase_space_process - INFO - 生成 nodes.csv 文件...
2025-05-23 21:46:55,682 - scn_phase_space_process - INFO - 转换节点特征格式...
2025-05-23 21:46:55,753 - scn_phase_space_process - INFO - ✓ nodes.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\nodes.csv
2025-05-23 21:46:55,753 - scn_phase_space_process - INFO - 生成 edges.csv 文件...
2025-05-23 21:46:55,764 - scn_phase_space_process - INFO - ✓ edges.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\edges.csv
2025-05-23 21:46:55,764 - scn_phase_space_process - INFO - 生成 graphs.csv 文件...
2025-05-23 21:46:55,765 - scn_phase_space_process - INFO - 外部模块不可用，使用内置的改进标签生成方法...
2025-05-23 21:46:55,947 - scn_phase_space_process - INFO - 使用内置的改进标签生成方法...
2025-05-23 21:46:55,948 - scn_phase_space_process - INFO - 处理 100 个有效样本
2025-05-23 21:46:55,999 - scn_phase_space_process - INFO - 特征矩阵形状: (100, 14)
2025-05-23 21:46:56,000 - scn_phase_space_process - INFO - PCA降维: 14 -> 8
2025-05-23 21:46:56,155 - scn_phase_space_process - INFO - 聚类质量 - 轮廓系数: 0.224
2025-05-23 21:46:56,156 - scn_phase_space_process - INFO - 改进标签分布: {np.int32(0): np.int64(21), np.int32(1): np.int64(28), np.int32(2): np.int64(13), np.int32(3): np.int64(13), np.int32(4): np.int64(9), np.int32(5): np.int64(16)}
2025-05-23 21:46:56,156 - scn_phase_space_process - INFO - 最终标签分布: {np.int32(0): np.int64(21), np.int32(1): np.int64(28), np.int32(2): np.int64(13), np.int32(3): np.int64(13), np.int32(4): np.int64(9), np.int32(5): np.int64(16)}
2025-05-23 21:46:56,158 - scn_phase_space_process - INFO - ✓ graphs.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\graphs.csv
2025-05-23 21:46:56,159 - scn_phase_space_process - INFO - 
============================================================
2025-05-23 21:46:56,159 - scn_phase_space_process - INFO - 数据处理流程全部完成!
2025-05-23 21:46:56,160 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:46:56,160 - scn_phase_space_process - INFO - 数据源信息:
2025-05-23 21:46:56,160 - scn_phase_space_process - INFO -   - 文件: datasets/EMtrace01.xlsx
2025-05-23 21:46:56,161 - scn_phase_space_process - INFO -   - 格式: Excel
2025-05-23 21:46:56,161 - scn_phase_space_process - INFO -   - 处理器: ExcelCalciumDataProcessor
2025-05-23 21:46:56,161 - scn_phase_space_process - INFO - 
生成的文件:
2025-05-23 21:46:56,162 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/nodes.csv
2025-05-23 21:46:56,162 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/edges.csv
2025-05-23 21:46:56,163 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/graphs.csv
2025-05-23 21:46:56,163 - scn_phase_space_process - INFO - 
处理结果:
2025-05-23 21:46:56,163 - scn_phase_space_process - INFO -   - 总样本数量: 100
2025-05-23 21:46:56,164 - scn_phase_space_process - INFO -   - 轨迹长度: 170
2025-05-23 21:46:56,164 - scn_phase_space_process - INFO -   - 嵌入维度: 3
2025-05-23 21:46:56,165 - scn_phase_space_process - INFO - 
下一步操作:
2025-05-23 21:46:56,165 - scn_phase_space_process - INFO -   1. 检查生成的CSV文件质量
2025-05-23 21:46:56,165 - scn_phase_space_process - INFO -   2. 运行训练: python main.py 或 python run.py --train
2025-05-23 21:46:56,166 - scn_phase_space_process - INFO -   3. 查看训练结果: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results
2025-05-23 21:46:56,166 - __main__ - INFO - ✓ 数据处理完成
2025-05-23 21:46:56,166 - __main__ - INFO - ============================================================
2025-05-23 21:46:56,166 - __main__ - INFO - 开始模型训练流程
2025-05-23 21:46:56,166 - __main__ - INFO - ============================================================
2025-05-23 21:46:59,823 - main - INFO - ================================================================================
2025-05-23 21:46:59,823 - main - INFO - 🧠 脑网络状态分类器 - 先进版本
2025-05-23 21:46:59,823 - main - INFO - ================================================================================
2025-05-23 21:46:59,824 - main - INFO - 使用设备: cuda
2025-05-23 21:46:59,824 - main - INFO - 📊 加载数据集...
2025-05-23 21:46:59,949 - main - INFO - 数据集加载完成 - 训练集: 60, 验证集: 20, 测试集: 20
2025-05-23 21:46:59,950 - main - INFO - 🏗️  创建先进模型...
2025-05-23 21:46:59,992 - main - INFO - 创建改进模型，参数总数: 790726
2025-05-23 21:46:59,993 - main - INFO - 使用MultiLayerGCN + 先进训练技术的组合
2025-05-23 21:47:00,081 - main - INFO - 🚀 开始训练...
2025-05-23 21:47:00,082 - main - INFO - 🚀 开始先进训练流程...
2025-05-23 21:47:00,957 - main - INFO - Epoch   0 | Train Loss: 2.2031 | Train Acc: 0.2667 | Val Loss: 1.9500 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:47:01,548 - main - INFO - Epoch   1 | Train Loss: 2.0307 | Train Acc: 0.2667 | Val Loss: 1.7477 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:47:02,091 - main - INFO - Epoch   2 | Train Loss: 1.8430 | Train Acc: 0.2000 | Val Loss: 1.5254 | Val Acc: 0.2500 | Val Balanced Acc: 0.1750 | LR: 0.001000
2025-05-23 21:47:02,629 - main - INFO - Epoch   3 | Train Loss: 1.9626 | Train Acc: 0.2500 | Val Loss: 1.3984 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:47:03,171 - main - INFO - Epoch   4 | Train Loss: 2.0821 | Train Acc: 0.2500 | Val Loss: 1.9370 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:47:03,699 - main - INFO - Epoch   5 | Train Loss: 1.8498 | Train Acc: 0.2167 | Val Loss: 1.3260 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:47:04,236 - main - INFO - Epoch   6 | Train Loss: 1.8162 | Train Acc: 0.1833 | Val Loss: 1.3024 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:47:04,777 - main - INFO - Epoch   7 | Train Loss: 1.6604 | Train Acc: 0.2333 | Val Loss: 1.2904 | Val Acc: 0.3000 | Val Balanced Acc: 0.2000 | LR: 0.001000
2025-05-23 21:47:05,328 - main - INFO - Epoch   8 | Train Loss: 1.7778 | Train Acc: 0.1833 | Val Loss: 1.2653 | Val Acc: 0.1500 | Val Balanced Acc: 0.1000 | LR: 0.001000
2025-05-23 21:47:05,876 - main - INFO - Epoch   9 | Train Loss: 1.7924 | Train Acc: 0.1833 | Val Loss: 1.4095 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:47:06,467 - main - INFO - Epoch  10 | Train Loss: 1.4074 | Train Acc: 0.3167 | Val Loss: 1.2982 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:47:12,122 - main - INFO - Epoch  20 | Train Loss: 1.3102 | Train Acc: 0.2333 | Val Loss: 1.2308 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:47:17,575 - main - INFO - Epoch  30 | Train Loss: 1.2606 | Train Acc: 0.2500 | Val Loss: 1.5719 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:47:23,574 - main - INFO - Epoch  40 | Train Loss: 0.9470 | Train Acc: 0.2833 | Val Loss: 1.5139 | Val Acc: 0.2000 | Val Balanced Acc: 0.1333 | LR: 0.000500
2025-05-23 21:47:24,166 - main - INFO - 早停触发，停止训练。最佳验证准确率: 0.3500
2025-05-23 21:47:24,167 - main - INFO - 恢复最佳模型，验证准确率: 0.3500
2025-05-23 21:47:24,168 - main - INFO - 🔍 测试最终性能...
2025-05-23 21:47:24,256 - main - INFO - ============================================================
2025-05-23 21:47:24,257 - main - INFO - 📊 最终结果:
2025-05-23 21:47:24,257 - main - INFO - 测试准确率: 0.3000
2025-05-23 21:47:24,257 - main - INFO - 平衡准确率: 0.2611
2025-05-23 21:47:24,258 - main - INFO - 测试损失: 1.4889
2025-05-23 21:47:24,258 - main - INFO - ============================================================
2025-05-23 21:47:24,265 - main - INFO - ✅ 模型和结果已保存
2025-05-23 21:47:24,266 - __main__ - INFO - ✓ 模型训练完成
2025-05-23 21:47:24,266 - __main__ - INFO - 最终测试准确率: 0.3000
2025-05-23 21:47:24,266 - __main__ - INFO - ============================================================
2025-05-23 21:47:24,267 - __main__ - INFO - 完整流程执行成功!
2025-05-23 21:47:24,267 - __main__ - INFO - ============================================================
2025-05-23 21:47:24,267 - __main__ - INFO - 操作成功完成
2025-05-23 21:50:47,553 - __main__ - INFO - ============================================================
2025-05-23 21:50:47,553 - __main__ - INFO - 当前配置参数
2025-05-23 21:50:47,554 - __main__ - INFO - ============================================================
2025-05-23 21:50:47,554 - __main__ - INFO - 
数据处理配置:
2025-05-23 21:50:47,555 - __main__ - INFO -   帧率: 0.67 Hz
2025-05-23 21:50:47,555 - __main__ - INFO -   嵌入维度: 3
2025-05-23 21:50:47,555 - __main__ - INFO -   轨迹长度: 170
2025-05-23 21:50:47,555 - __main__ - INFO -   最大处理细胞数: 10
2025-05-23 21:50:47,555 - __main__ - INFO - 
模型配置:
2025-05-23 21:50:47,555 - __main__ - INFO -   隐藏层维度: 32
2025-05-23 21:50:47,556 - __main__ - INFO -   GCN层数: 3
2025-05-23 21:50:47,556 - __main__ - INFO -   分类类别数: 6
2025-05-23 21:50:47,556 - __main__ - INFO -   Dropout率: 0.5
2025-05-23 21:50:47,556 - __main__ - INFO - 
训练配置:
2025-05-23 21:50:47,556 - __main__ - INFO -   训练轮数: 160
2025-05-23 21:50:47,556 - __main__ - INFO -   学习率: 0.001
2025-05-23 21:50:47,556 - __main__ - INFO -   批次大小: 1
2025-05-23 21:50:47,556 - __main__ - INFO -   计算设备: cuda
2025-05-23 21:50:47,556 - __main__ - INFO -   使用早停: 是
2025-05-23 21:50:47,556 - __main__ - INFO -   早停耐心值: 50
2025-05-23 21:50:47,556 - __main__ - INFO -   早停最小改进: 0.001
2025-05-23 21:50:47,556 - __main__ - INFO - 
文件路径:
2025-05-23 21:50:47,557 - __main__ - INFO -   输入数据: datasets/EMtrace01.xlsx
2025-05-23 21:50:47,557 - __main__ - INFO -   数据目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets
2025-05-23 21:50:47,557 - __main__ - INFO -   结果目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results
2025-05-23 21:50:47,557 - __main__ - INFO - 操作成功完成
2025-05-23 21:51:19,212 - __main__ - INFO - ============================================================
2025-05-23 21:51:19,212 - __main__ - INFO - 开始完整的处理和训练流程
2025-05-23 21:51:19,212 - __main__ - INFO - ============================================================
2025-05-23 21:51:19,212 - __main__ - INFO - ============================================================
2025-05-23 21:51:19,212 - __main__ - INFO - 开始数据处理流程
2025-05-23 21:51:19,213 - __main__ - INFO - ============================================================
2025-05-23 21:51:20,271 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:51:20,271 - scn_phase_space_process - INFO - 3D SCN数据处理流程 - Python版本
2025-05-23 21:51:20,272 - scn_phase_space_process - INFO - 增强版本：支持Excel和MAT格式
2025-05-23 21:51:20,272 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:51:20,272 - scn_phase_space_process - INFO - 输出目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets
2025-05-23 21:51:20,273 - scn_phase_space_process - INFO - 
步骤1: 智能数据加载
2025-05-23 21:51:20,273 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:51:20,273 - scn_phase_space_process - INFO - 正在检测和加载数据文件: datasets/EMtrace01.xlsx
2025-05-23 21:51:20,273 - scn_phase_space_process - INFO - 检测到文件格式: excel
2025-05-23 21:51:20,274 - scn_phase_space_process - INFO - 使用Excel数据处理器加载钙离子数据...
2025-05-23 21:51:20,274 - excel_data_processor - INFO - 正在加载Excel数据文件: datasets\EMtrace01.xlsx
2025-05-23 21:51:21,223 - excel_data_processor - INFO - ✓ 成功加载数据: 2999 个时间点, 43 个神经元
2025-05-23 21:51:21,223 - excel_data_processor - INFO - 神经元列: ['n1', 'n2', 'n3', 'n4', 'n5', 'n6', 'n7', 'n8', 'n9', 'n10']...
2025-05-23 21:51:21,223 - excel_data_processor - INFO - 开始预处理钙离子数据...
2025-05-23 21:51:21,229 - excel_data_processor - WARNING - 检测并处理了 247 个异常值
2025-05-23 21:51:21,230 - excel_data_processor - INFO - 执行Z-score标准化...
2025-05-23 21:51:21,233 - excel_data_processor - INFO - ✓ 数据预处理完成: (2999, 43) -> (2999, 43)
2025-05-23 21:51:21,234 - excel_data_processor - INFO - 转换数据为SCN处理格式...
2025-05-23 21:51:21,234 - excel_data_processor - INFO - 分段参数: 段长度=340, 步长=170
2025-05-23 21:51:21,235 - excel_data_processor - INFO - ✓ 转换完成: 10 个神经元, 平均每个神经元 10.0 个时间段
2025-05-23 21:51:21,236 - scn_phase_space_process - INFO - 数据加载信息:
2025-05-23 21:51:21,237 - scn_phase_space_process - INFO -   文件路径: datasets\EMtrace01.xlsx
2025-05-23 21:51:21,237 - scn_phase_space_process - INFO -   时间点数量: 2999
2025-05-23 21:51:21,237 - scn_phase_space_process - INFO -   神经元数量: 43
2025-05-23 21:51:21,238 - scn_phase_space_process - INFO -   数据形状: (2999, 43)
2025-05-23 21:51:21,238 - scn_phase_space_process - INFO -   时间戳范围: 1 - 2999
2025-05-23 21:51:21,238 - scn_phase_space_process - INFO -   神经元ID: ['n1', 'n2', 'n3', 'n4', 'n5', '...']
2025-05-23 21:51:21,239 - scn_phase_space_process - INFO -   缺失值数量: 0
2025-05-23 21:51:21,239 - scn_phase_space_process - INFO -   数据范围: -1.358 - 4.895
2025-05-23 21:51:21,240 - scn_phase_space_process - INFO -   数据均值: -0.000
2025-05-23 21:51:21,240 - scn_phase_space_process - INFO -   数据标准差: 0.578
2025-05-23 21:51:21,241 - scn_phase_space_process - INFO -   数据格式: Excel
2025-05-23 21:51:21,241 - scn_phase_space_process - INFO -   处理器: ExcelCalciumDataProcessor
2025-05-23 21:51:21,241 - scn_phase_space_process - INFO - 
步骤2: 相空间重构
2025-05-23 21:51:21,241 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:51:21,242 - scn_phase_space_process - INFO - 数据维度: 10 个细胞, 10 个时间线
2025-05-23 21:51:21,242 - scn_phase_space_process - INFO - 开始处理钙信号数据...
2025-05-23 21:51:26,012 - scn_phase_space_process - INFO - ✓ 相空间重构完成
2025-05-23 21:51:26,012 - scn_phase_space_process - INFO - 
步骤3: 数据裁剪
2025-05-23 21:51:26,012 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:51:26,012 - scn_phase_space_process - INFO - 开始裁剪数据到统一长度: 170
2025-05-23 21:51:26,013 - scn_phase_space_process - INFO - ✓ 数据裁剪完成
2025-05-23 21:51:26,013 - scn_phase_space_process - INFO - 
步骤4: 构建图数据集
2025-05-23 21:51:26,013 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:51:26,013 - scn_phase_space_process - INFO - 有效样本数量: 100
2025-05-23 21:51:26,013 - scn_phase_space_process - INFO - 生成 nodes.csv 文件...
2025-05-23 21:51:26,014 - scn_phase_space_process - INFO - 转换节点特征格式...
2025-05-23 21:51:26,089 - scn_phase_space_process - INFO - ✓ nodes.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\nodes.csv
2025-05-23 21:51:26,089 - scn_phase_space_process - INFO - 生成 edges.csv 文件...
2025-05-23 21:51:26,101 - scn_phase_space_process - INFO - ✓ edges.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\edges.csv
2025-05-23 21:51:26,101 - scn_phase_space_process - INFO - 生成 graphs.csv 文件...
2025-05-23 21:51:26,102 - scn_phase_space_process - INFO - 外部模块不可用，使用内置的改进标签生成方法...
2025-05-23 21:51:26,312 - scn_phase_space_process - INFO - 使用内置的改进标签生成方法...
2025-05-23 21:51:26,312 - scn_phase_space_process - INFO - 处理 100 个有效样本
2025-05-23 21:51:26,364 - scn_phase_space_process - INFO - 特征矩阵形状: (100, 14)
2025-05-23 21:51:26,366 - scn_phase_space_process - INFO - PCA降维: 14 -> 8
2025-05-23 21:51:26,602 - scn_phase_space_process - INFO - 聚类质量 - 轮廓系数: 0.224
2025-05-23 21:51:26,602 - scn_phase_space_process - INFO - 改进标签分布: {np.int32(0): np.int64(21), np.int32(1): np.int64(28), np.int32(2): np.int64(13), np.int32(3): np.int64(13), np.int32(4): np.int64(9), np.int32(5): np.int64(16)}
2025-05-23 21:51:26,603 - scn_phase_space_process - INFO - 最终标签分布: {np.int32(0): np.int64(21), np.int32(1): np.int64(28), np.int32(2): np.int64(13), np.int32(3): np.int64(13), np.int32(4): np.int64(9), np.int32(5): np.int64(16)}
2025-05-23 21:51:26,605 - scn_phase_space_process - INFO - ✓ graphs.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\graphs.csv
2025-05-23 21:51:26,605 - scn_phase_space_process - INFO - 
============================================================
2025-05-23 21:51:26,605 - scn_phase_space_process - INFO - 数据处理流程全部完成!
2025-05-23 21:51:26,606 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:51:26,606 - scn_phase_space_process - INFO - 数据源信息:
2025-05-23 21:51:26,606 - scn_phase_space_process - INFO -   - 文件: datasets/EMtrace01.xlsx
2025-05-23 21:51:26,606 - scn_phase_space_process - INFO -   - 格式: Excel
2025-05-23 21:51:26,607 - scn_phase_space_process - INFO -   - 处理器: ExcelCalciumDataProcessor
2025-05-23 21:51:26,607 - scn_phase_space_process - INFO - 
生成的文件:
2025-05-23 21:51:26,608 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/nodes.csv
2025-05-23 21:51:26,608 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/edges.csv
2025-05-23 21:51:26,608 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/graphs.csv
2025-05-23 21:51:26,608 - scn_phase_space_process - INFO - 
处理结果:
2025-05-23 21:51:26,609 - scn_phase_space_process - INFO -   - 总样本数量: 100
2025-05-23 21:51:26,609 - scn_phase_space_process - INFO -   - 轨迹长度: 170
2025-05-23 21:51:26,610 - scn_phase_space_process - INFO -   - 嵌入维度: 3
2025-05-23 21:51:26,610 - scn_phase_space_process - INFO - 
下一步操作:
2025-05-23 21:51:26,610 - scn_phase_space_process - INFO -   1. 检查生成的CSV文件质量
2025-05-23 21:51:26,610 - scn_phase_space_process - INFO -   2. 运行训练: python main.py 或 python run.py --train
2025-05-23 21:51:26,611 - scn_phase_space_process - INFO -   3. 查看训练结果: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results
2025-05-23 21:51:26,611 - __main__ - INFO - ✓ 数据处理完成
2025-05-23 21:51:26,611 - __main__ - INFO - ============================================================
2025-05-23 21:51:26,611 - __main__ - INFO - 开始模型训练流程
2025-05-23 21:51:26,612 - __main__ - INFO - ============================================================
2025-05-23 21:51:29,944 - main - INFO - ================================================================================
2025-05-23 21:51:29,944 - main - INFO - 🧠 脑网络状态分类器 - 先进版本
2025-05-23 21:51:29,944 - main - INFO - ================================================================================
2025-05-23 21:51:29,944 - main - INFO - 使用设备: cuda
2025-05-23 21:51:29,945 - main - INFO - 📊 加载数据集...
2025-05-23 21:51:30,072 - main - INFO - 数据集加载完成 - 训练集: 60, 验证集: 20, 测试集: 20
2025-05-23 21:51:30,073 - main - INFO - 🏗️  创建先进模型...
2025-05-23 21:51:30,117 - main - INFO - 创建改进模型，参数总数: 790726
2025-05-23 21:51:30,117 - main - INFO - 使用MultiLayerGCN + 先进训练技术的组合
2025-05-23 21:51:30,205 - main - INFO - ✓ 早停机制已禁用
2025-05-23 21:51:30,205 - main - INFO - 🚀 开始训练...
2025-05-23 21:51:30,205 - main - INFO - 🚀 开始先进训练流程...
2025-05-23 21:51:31,129 - main - INFO - Epoch   0 | Train Loss: 2.7084 | Train Acc: 0.1667 | Val Loss: 1.4940 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:51:31,818 - main - INFO - Epoch   1 | Train Loss: 2.2669 | Train Acc: 0.1167 | Val Loss: 1.4308 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:51:32,648 - main - INFO - Epoch   2 | Train Loss: 1.9341 | Train Acc: 0.3000 | Val Loss: 1.6348 | Val Acc: 0.2500 | Val Balanced Acc: 0.2667 | LR: 0.001000
2025-05-23 21:51:33,327 - main - INFO - Epoch   3 | Train Loss: 2.0716 | Train Acc: 0.2000 | Val Loss: 1.4611 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:51:33,956 - main - INFO - Epoch   4 | Train Loss: 2.0759 | Train Acc: 0.2500 | Val Loss: 1.5600 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:51:34,625 - main - INFO - Epoch   5 | Train Loss: 1.9241 | Train Acc: 0.1667 | Val Loss: 1.3651 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:51:35,319 - main - INFO - Epoch   6 | Train Loss: 1.8506 | Train Acc: 0.2000 | Val Loss: 1.4228 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:51:35,990 - main - INFO - Epoch   7 | Train Loss: 1.7031 | Train Acc: 0.3000 | Val Loss: 1.5205 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:51:36,682 - main - INFO - Epoch   8 | Train Loss: 1.8591 | Train Acc: 0.2333 | Val Loss: 1.3149 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:51:37,341 - main - INFO - Epoch   9 | Train Loss: 1.5201 | Train Acc: 0.3000 | Val Loss: 1.4416 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:51:38,034 - main - INFO - Epoch  10 | Train Loss: 1.6719 | Train Acc: 0.3000 | Val Loss: 1.3846 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:51:44,751 - main - INFO - Epoch  20 | Train Loss: 1.3056 | Train Acc: 0.2667 | Val Loss: 1.3262 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:51:51,716 - main - INFO - Epoch  30 | Train Loss: 1.4094 | Train Acc: 0.2667 | Val Loss: 1.2466 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:51:58,653 - main - INFO - Epoch  40 | Train Loss: 1.2065 | Train Acc: 0.3500 | Val Loss: 1.4240 | Val Acc: 0.3000 | Val Balanced Acc: 0.2000 | LR: 0.001000
2025-05-23 21:52:05,919 - main - INFO - Epoch  50 | Train Loss: 1.1300 | Train Acc: 0.3833 | Val Loss: 1.1887 | Val Acc: 0.4000 | Val Balanced Acc: 0.4000 | LR: 0.001000
2025-05-23 21:52:12,811 - main - INFO - Epoch  60 | Train Loss: 0.9001 | Train Acc: 0.3833 | Val Loss: 1.9667 | Val Acc: 0.2000 | Val Balanced Acc: 0.1333 | LR: 0.001000
2025-05-23 21:52:19,601 - main - INFO - Epoch  70 | Train Loss: 0.8932 | Train Acc: 0.4500 | Val Loss: 2.0022 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.000500
2025-05-23 21:52:26,108 - main - INFO - Epoch  80 | Train Loss: 0.7789 | Train Acc: 0.4667 | Val Loss: 2.6440 | Val Acc: 0.2500 | Val Balanced Acc: 0.3000 | LR: 0.000500
2025-05-23 21:52:32,695 - main - INFO - Epoch  90 | Train Loss: 0.5989 | Train Acc: 0.5833 | Val Loss: 2.5812 | Val Acc: 0.1500 | Val Balanced Acc: 0.1000 | LR: 0.000250
2025-05-23 21:52:39,080 - main - INFO - Epoch 100 | Train Loss: 0.5667 | Train Acc: 0.5833 | Val Loss: 3.2251 | Val Acc: 0.2000 | Val Balanced Acc: 0.1333 | LR: 0.000125
2025-05-23 21:52:45,510 - main - INFO - Epoch 110 | Train Loss: 0.5053 | Train Acc: 0.6333 | Val Loss: 3.3138 | Val Acc: 0.2500 | Val Balanced Acc: 0.3222 | LR: 0.000125
2025-05-23 21:52:51,378 - main - INFO - Epoch 120 | Train Loss: 0.5150 | Train Acc: 0.5833 | Val Loss: 3.9175 | Val Acc: 0.2000 | Val Balanced Acc: 0.1556 | LR: 0.000063
2025-05-23 21:52:57,049 - main - INFO - Epoch 130 | Train Loss: 0.5507 | Train Acc: 0.6167 | Val Loss: 3.5004 | Val Acc: 0.1500 | Val Balanced Acc: 0.1222 | LR: 0.000031
2025-05-23 21:53:02,384 - main - INFO - Epoch 140 | Train Loss: 0.4314 | Train Acc: 0.7167 | Val Loss: 3.6359 | Val Acc: 0.1000 | Val Balanced Acc: 0.0889 | LR: 0.000031
2025-05-23 21:53:08,118 - main - INFO - Epoch 150 | Train Loss: 0.4757 | Train Acc: 0.6500 | Val Loss: 3.5616 | Val Acc: 0.1000 | Val Balanced Acc: 0.0889 | LR: 0.000016
2025-05-23 21:53:13,258 - main - INFO - 恢复最佳模型，验证准确率: 0.4500
2025-05-23 21:53:13,258 - main - INFO - 🔍 测试最终性能...
2025-05-23 21:53:13,361 - main - INFO - ============================================================
2025-05-23 21:53:13,362 - main - INFO - 📊 最终结果:
2025-05-23 21:53:13,362 - main - INFO - 测试准确率: 0.2500
2025-05-23 21:53:13,362 - main - INFO - 平衡准确率: 0.3222
2025-05-23 21:53:13,362 - main - INFO - 测试损失: 3.0922
2025-05-23 21:53:13,362 - main - INFO - ============================================================
2025-05-23 21:53:13,370 - main - INFO - ✅ 模型和结果已保存
2025-05-23 21:53:13,371 - __main__ - INFO - ✓ 模型训练完成
2025-05-23 21:53:13,371 - __main__ - INFO - 最终测试准确率: 0.2500
2025-05-23 21:53:13,371 - __main__ - INFO - ============================================================
2025-05-23 21:53:13,371 - __main__ - INFO - 完整流程执行成功!
2025-05-23 21:53:13,371 - __main__ - INFO - ============================================================
2025-05-23 21:53:13,371 - __main__ - INFO - 操作成功完成
2025-05-23 21:54:06,103 - __main__ - INFO - ============================================================
2025-05-23 21:54:06,104 - __main__ - INFO - 开始完整的处理和训练流程
2025-05-23 21:54:06,104 - __main__ - INFO - ============================================================
2025-05-23 21:54:06,104 - __main__ - INFO - ============================================================
2025-05-23 21:54:06,104 - __main__ - INFO - 开始数据处理流程
2025-05-23 21:54:06,104 - __main__ - INFO - ============================================================
2025-05-23 21:54:07,132 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:54:07,132 - scn_phase_space_process - INFO - 3D SCN数据处理流程 - Python版本
2025-05-23 21:54:07,133 - scn_phase_space_process - INFO - 增强版本：支持Excel和MAT格式
2025-05-23 21:54:07,133 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:54:07,134 - scn_phase_space_process - INFO - 输出目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets
2025-05-23 21:54:07,134 - scn_phase_space_process - INFO - 
步骤1: 智能数据加载
2025-05-23 21:54:07,134 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:54:07,135 - scn_phase_space_process - INFO - 正在检测和加载数据文件: datasets/EMtrace01.xlsx
2025-05-23 21:54:07,135 - scn_phase_space_process - INFO - 检测到文件格式: excel
2025-05-23 21:54:07,135 - scn_phase_space_process - INFO - 使用Excel数据处理器加载钙离子数据...
2025-05-23 21:54:07,135 - excel_data_processor - INFO - 正在加载Excel数据文件: datasets\EMtrace01.xlsx
2025-05-23 21:54:08,106 - excel_data_processor - INFO - ✓ 成功加载数据: 2999 个时间点, 43 个神经元
2025-05-23 21:54:08,106 - excel_data_processor - INFO - 神经元列: ['n1', 'n2', 'n3', 'n4', 'n5', 'n6', 'n7', 'n8', 'n9', 'n10']...
2025-05-23 21:54:08,106 - excel_data_processor - INFO - 开始预处理钙离子数据...
2025-05-23 21:54:08,112 - excel_data_processor - WARNING - 检测并处理了 247 个异常值
2025-05-23 21:54:08,112 - excel_data_processor - INFO - 执行Z-score标准化...
2025-05-23 21:54:08,115 - excel_data_processor - INFO - ✓ 数据预处理完成: (2999, 43) -> (2999, 43)
2025-05-23 21:54:08,115 - excel_data_processor - INFO - 转换数据为SCN处理格式...
2025-05-23 21:54:08,115 - excel_data_processor - INFO - 分段参数: 段长度=340, 步长=170
2025-05-23 21:54:08,116 - excel_data_processor - INFO - ✓ 转换完成: 10 个神经元, 平均每个神经元 10.0 个时间段
2025-05-23 21:54:08,118 - scn_phase_space_process - INFO - 数据加载信息:
2025-05-23 21:54:08,118 - scn_phase_space_process - INFO -   文件路径: datasets\EMtrace01.xlsx
2025-05-23 21:54:08,118 - scn_phase_space_process - INFO -   时间点数量: 2999
2025-05-23 21:54:08,118 - scn_phase_space_process - INFO -   神经元数量: 43
2025-05-23 21:54:08,119 - scn_phase_space_process - INFO -   数据形状: (2999, 43)
2025-05-23 21:54:08,119 - scn_phase_space_process - INFO -   时间戳范围: 1 - 2999
2025-05-23 21:54:08,119 - scn_phase_space_process - INFO -   神经元ID: ['n1', 'n2', 'n3', 'n4', 'n5', '...']
2025-05-23 21:54:08,119 - scn_phase_space_process - INFO -   缺失值数量: 0
2025-05-23 21:54:08,119 - scn_phase_space_process - INFO -   数据范围: -1.358 - 4.895
2025-05-23 21:54:08,120 - scn_phase_space_process - INFO -   数据均值: -0.000
2025-05-23 21:54:08,120 - scn_phase_space_process - INFO -   数据标准差: 0.578
2025-05-23 21:54:08,120 - scn_phase_space_process - INFO -   数据格式: Excel
2025-05-23 21:54:08,121 - scn_phase_space_process - INFO -   处理器: ExcelCalciumDataProcessor
2025-05-23 21:54:08,121 - scn_phase_space_process - INFO - 
步骤2: 相空间重构
2025-05-23 21:54:08,121 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:54:08,122 - scn_phase_space_process - INFO - 数据维度: 10 个细胞, 10 个时间线
2025-05-23 21:54:08,122 - scn_phase_space_process - INFO - 开始处理钙信号数据...
2025-05-23 21:54:12,696 - scn_phase_space_process - INFO - ✓ 相空间重构完成
2025-05-23 21:54:12,696 - scn_phase_space_process - INFO - 
步骤3: 数据裁剪
2025-05-23 21:54:12,696 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:54:12,697 - scn_phase_space_process - INFO - 开始裁剪数据到统一长度: 170
2025-05-23 21:54:12,697 - scn_phase_space_process - INFO - ✓ 数据裁剪完成
2025-05-23 21:54:12,697 - scn_phase_space_process - INFO - 
步骤4: 构建图数据集
2025-05-23 21:54:12,697 - scn_phase_space_process - INFO - ------------------------------
2025-05-23 21:54:12,698 - scn_phase_space_process - INFO - 有效样本数量: 100
2025-05-23 21:54:12,698 - scn_phase_space_process - INFO - 生成 nodes.csv 文件...
2025-05-23 21:54:12,698 - scn_phase_space_process - INFO - 转换节点特征格式...
2025-05-23 21:54:12,772 - scn_phase_space_process - INFO - ✓ nodes.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\nodes.csv
2025-05-23 21:54:12,772 - scn_phase_space_process - INFO - 生成 edges.csv 文件...
2025-05-23 21:54:12,786 - scn_phase_space_process - INFO - ✓ edges.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\edges.csv
2025-05-23 21:54:12,786 - scn_phase_space_process - INFO - 生成 graphs.csv 文件...
2025-05-23 21:54:12,787 - scn_phase_space_process - INFO - 外部模块不可用，使用内置的改进标签生成方法...
2025-05-23 21:54:12,984 - scn_phase_space_process - INFO - 使用内置的改进标签生成方法...
2025-05-23 21:54:12,984 - scn_phase_space_process - INFO - 处理 100 个有效样本
2025-05-23 21:54:13,035 - scn_phase_space_process - INFO - 特征矩阵形状: (100, 14)
2025-05-23 21:54:13,036 - scn_phase_space_process - INFO - PCA降维: 14 -> 8
2025-05-23 21:54:13,196 - scn_phase_space_process - INFO - 聚类质量 - 轮廓系数: 0.224
2025-05-23 21:54:13,197 - scn_phase_space_process - INFO - 改进标签分布: {np.int32(0): np.int64(21), np.int32(1): np.int64(28), np.int32(2): np.int64(13), np.int32(3): np.int64(13), np.int32(4): np.int64(9), np.int32(5): np.int64(16)}
2025-05-23 21:54:13,197 - scn_phase_space_process - INFO - 最终标签分布: {np.int32(0): np.int64(21), np.int32(1): np.int64(28), np.int32(2): np.int64(13), np.int32(3): np.int64(13), np.int32(4): np.int64(9), np.int32(5): np.int64(16)}
2025-05-23 21:54:13,199 - scn_phase_space_process - INFO - ✓ graphs.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\graphs.csv
2025-05-23 21:54:13,200 - scn_phase_space_process - INFO - 
============================================================
2025-05-23 21:54:13,200 - scn_phase_space_process - INFO - 数据处理流程全部完成!
2025-05-23 21:54:13,200 - scn_phase_space_process - INFO - ============================================================
2025-05-23 21:54:13,201 - scn_phase_space_process - INFO - 数据源信息:
2025-05-23 21:54:13,201 - scn_phase_space_process - INFO -   - 文件: datasets/EMtrace01.xlsx
2025-05-23 21:54:13,202 - scn_phase_space_process - INFO -   - 格式: Excel
2025-05-23 21:54:13,202 - scn_phase_space_process - INFO -   - 处理器: ExcelCalciumDataProcessor
2025-05-23 21:54:13,202 - scn_phase_space_process - INFO - 
生成的文件:
2025-05-23 21:54:13,203 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/nodes.csv
2025-05-23 21:54:13,203 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/edges.csv
2025-05-23 21:54:13,203 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/graphs.csv
2025-05-23 21:54:13,204 - scn_phase_space_process - INFO - 
处理结果:
2025-05-23 21:54:13,204 - scn_phase_space_process - INFO -   - 总样本数量: 100
2025-05-23 21:54:13,204 - scn_phase_space_process - INFO -   - 轨迹长度: 170
2025-05-23 21:54:13,205 - scn_phase_space_process - INFO -   - 嵌入维度: 3
2025-05-23 21:54:13,205 - scn_phase_space_process - INFO - 
下一步操作:
2025-05-23 21:54:13,205 - scn_phase_space_process - INFO -   1. 检查生成的CSV文件质量
2025-05-23 21:54:13,206 - scn_phase_space_process - INFO -   2. 运行训练: python main.py 或 python run.py --train
2025-05-23 21:54:13,206 - scn_phase_space_process - INFO -   3. 查看训练结果: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results
2025-05-23 21:54:13,206 - __main__ - INFO - ✓ 数据处理完成
2025-05-23 21:54:13,207 - __main__ - INFO - ============================================================
2025-05-23 21:54:13,207 - __main__ - INFO - 开始模型训练流程
2025-05-23 21:54:13,207 - __main__ - INFO - ============================================================
2025-05-23 21:54:17,028 - main - INFO - ================================================================================
2025-05-23 21:54:17,028 - main - INFO - 🧠 脑网络状态分类器 - 先进版本
2025-05-23 21:54:17,028 - main - INFO - ================================================================================
2025-05-23 21:54:17,029 - main - INFO - 使用设备: cuda
2025-05-23 21:54:17,029 - main - INFO - 📊 加载数据集...
2025-05-23 21:54:17,153 - main - INFO - 数据集加载完成 - 训练集: 60, 验证集: 20, 测试集: 20
2025-05-23 21:54:17,153 - main - INFO - 🏗️  创建先进模型...
2025-05-23 21:54:17,195 - main - INFO - 创建改进模型，参数总数: 790726
2025-05-23 21:54:17,195 - main - INFO - 使用MultiLayerGCN + 先进训练技术的组合
2025-05-23 21:54:17,282 - main - INFO - ✓ 早停机制已启用 - 耐心值: 50, 最小改进: 0.001
2025-05-23 21:54:17,283 - main - INFO - 🚀 开始训练...
2025-05-23 21:54:17,283 - main - INFO - 🚀 开始先进训练流程...
2025-05-23 21:54:18,134 - main - INFO - Epoch   0 | Train Loss: 2.5957 | Train Acc: 0.2167 | Val Loss: 1.9250 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:54:18,853 - main - INFO - Epoch   1 | Train Loss: 2.4562 | Train Acc: 0.2167 | Val Loss: 1.3719 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:54:19,467 - main - INFO - Epoch   2 | Train Loss: 1.9189 | Train Acc: 0.3000 | Val Loss: 1.8063 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:54:20,043 - main - INFO - Epoch   3 | Train Loss: 1.8057 | Train Acc: 0.2000 | Val Loss: 1.2986 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:54:20,629 - main - INFO - Epoch   4 | Train Loss: 1.9081 | Train Acc: 0.2333 | Val Loss: 1.7178 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:54:21,219 - main - INFO - Epoch   5 | Train Loss: 1.6686 | Train Acc: 0.2833 | Val Loss: 1.4093 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:54:21,835 - main - INFO - Epoch   6 | Train Loss: 1.8239 | Train Acc: 0.2500 | Val Loss: 1.4403 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:54:22,422 - main - INFO - Epoch   7 | Train Loss: 1.6532 | Train Acc: 0.2167 | Val Loss: 1.6497 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:54:23,010 - main - INFO - Epoch   8 | Train Loss: 1.7204 | Train Acc: 0.2333 | Val Loss: 1.0983 | Val Acc: 0.3000 | Val Balanced Acc: 0.2000 | LR: 0.001000
2025-05-23 21:54:23,617 - main - INFO - Epoch   9 | Train Loss: 1.5778 | Train Acc: 0.2500 | Val Loss: 1.1486 | Val Acc: 0.3000 | Val Balanced Acc: 0.3000 | LR: 0.001000
2025-05-23 21:54:24,218 - main - INFO - Epoch  10 | Train Loss: 1.4525 | Train Acc: 0.3500 | Val Loss: 1.4224 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:54:30,281 - main - INFO - Epoch  20 | Train Loss: 1.3001 | Train Acc: 0.3333 | Val Loss: 1.3487 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:54:36,433 - main - INFO - Epoch  30 | Train Loss: 1.2057 | Train Acc: 0.3167 | Val Loss: 1.2165 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-23 21:54:42,764 - main - INFO - Epoch  40 | Train Loss: 0.9507 | Train Acc: 0.4667 | Val Loss: 1.2706 | Val Acc: 0.2500 | Val Balanced Acc: 0.3222 | LR: 0.001000
2025-05-23 21:54:49,181 - main - INFO - Epoch  50 | Train Loss: 0.7026 | Train Acc: 0.6833 | Val Loss: 2.2181 | Val Acc: 0.4000 | Val Balanced Acc: 0.4944 | LR: 0.000500
2025-05-23 21:54:55,557 - main - INFO - Epoch  60 | Train Loss: 0.4010 | Train Acc: 0.7333 | Val Loss: 2.4793 | Val Acc: 0.3500 | Val Balanced Acc: 0.4611 | LR: 0.000250
2025-05-23 21:55:02,073 - main - INFO - Epoch  70 | Train Loss: 0.3566 | Train Acc: 0.8167 | Val Loss: 3.3251 | Val Acc: 0.3500 | Val Balanced Acc: 0.3889 | LR: 0.000250
2025-05-23 21:55:05,353 - main - INFO - 早停触发，停止训练。最佳验证准确率: 0.5000
2025-05-23 21:55:05,354 - main - INFO - 恢复最佳模型，验证准确率: 0.5000
2025-05-23 21:55:05,355 - main - INFO - 🔍 测试最终性能...
2025-05-23 21:55:05,458 - main - INFO - ============================================================
2025-05-23 21:55:05,459 - main - INFO - 📊 最终结果:
2025-05-23 21:55:05,459 - main - INFO - 测试准确率: 0.2500
2025-05-23 21:55:05,459 - main - INFO - 平衡准确率: 0.3750
2025-05-23 21:55:05,459 - main - INFO - 测试损失: 4.1814
2025-05-23 21:55:05,460 - main - INFO - ============================================================
2025-05-23 21:55:05,468 - main - INFO - ✅ 模型和结果已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results\advanced_brain_classifier.pth
2025-05-23 21:55:05,468 - __main__ - INFO - ✓ 模型训练完成
2025-05-23 21:55:05,468 - __main__ - INFO - 最终测试准确率: 0.2500
2025-05-23 21:55:05,469 - __main__ - INFO - ============================================================
2025-05-23 21:55:05,469 - __main__ - INFO - 完整流程执行成功!
2025-05-23 21:55:05,469 - __main__ - INFO - ============================================================
2025-05-23 21:55:05,469 - __main__ - INFO - 操作成功完成
2025-05-24 11:43:21,740 - __main__ - INFO - ============================================================
2025-05-24 11:43:21,741 - __main__ - INFO - 开始完整的处理和训练流程
2025-05-24 11:43:21,741 - __main__ - INFO - ============================================================
2025-05-24 11:43:21,742 - __main__ - INFO - ============================================================
2025-05-24 11:43:21,742 - __main__ - INFO - 开始数据处理流程
2025-05-24 11:43:21,742 - __main__ - INFO - ============================================================
2025-05-24 11:43:24,084 - numexpr.utils - INFO - Note: NumExpr detected 16 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-05-24 11:43:24,084 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-05-24 11:43:28,015 - scn_phase_space_process - INFO - ============================================================
2025-05-24 11:43:28,016 - scn_phase_space_process - INFO - 3D SCN数据处理流程 - Python版本
2025-05-24 11:43:28,016 - scn_phase_space_process - INFO - 增强版本：支持Excel和MAT格式
2025-05-24 11:43:28,016 - scn_phase_space_process - INFO - ============================================================
2025-05-24 11:43:28,017 - scn_phase_space_process - INFO - 输出目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets
2025-05-24 11:43:28,017 - scn_phase_space_process - INFO - 
步骤1: 智能数据加载
2025-05-24 11:43:28,017 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 11:43:28,017 - scn_phase_space_process - INFO - 正在检测和加载数据文件: datasets/EMtrace01.xlsx
2025-05-24 11:43:28,017 - scn_phase_space_process - INFO - 检测到文件格式: excel
2025-05-24 11:43:28,018 - scn_phase_space_process - INFO - 使用Excel数据处理器加载钙离子数据...
2025-05-24 11:43:28,018 - excel_data_processor - INFO - 正在加载Excel数据文件: datasets\EMtrace01.xlsx
2025-05-24 11:43:29,549 - excel_data_processor - INFO - ✓ 成功加载数据: 2999 个时间点, 43 个神经元
2025-05-24 11:43:29,549 - excel_data_processor - INFO - 神经元列: ['n1', 'n2', 'n3', 'n4', 'n5', 'n6', 'n7', 'n8', 'n9', 'n10']...
2025-05-24 11:43:29,549 - excel_data_processor - INFO - 开始预处理钙离子数据...
2025-05-24 11:43:29,556 - excel_data_processor - WARNING - 检测并处理了 247 个异常值
2025-05-24 11:43:29,556 - excel_data_processor - INFO - 执行Z-score标准化...
2025-05-24 11:43:29,559 - excel_data_processor - INFO - ✓ 数据预处理完成: (2999, 43) -> (2999, 43)
2025-05-24 11:43:29,560 - excel_data_processor - INFO - 转换数据为SCN处理格式...
2025-05-24 11:43:29,560 - excel_data_processor - INFO - 分段参数: 段长度=340, 步长=170
2025-05-24 11:43:29,560 - excel_data_processor - INFO - ✓ 转换完成: 10 个神经元, 平均每个神经元 10.0 个时间段
2025-05-24 11:43:29,562 - scn_phase_space_process - INFO - 数据加载信息:
2025-05-24 11:43:29,563 - scn_phase_space_process - INFO -   文件路径: datasets\EMtrace01.xlsx
2025-05-24 11:43:29,563 - scn_phase_space_process - INFO -   时间点数量: 2999
2025-05-24 11:43:29,563 - scn_phase_space_process - INFO -   神经元数量: 43
2025-05-24 11:43:29,563 - scn_phase_space_process - INFO -   数据形状: (2999, 43)
2025-05-24 11:43:29,564 - scn_phase_space_process - INFO -   时间戳范围: 1 - 2999
2025-05-24 11:43:29,564 - scn_phase_space_process - INFO -   神经元ID: ['n1', 'n2', 'n3', 'n4', 'n5', '...']
2025-05-24 11:43:29,564 - scn_phase_space_process - INFO -   缺失值数量: 0
2025-05-24 11:43:29,564 - scn_phase_space_process - INFO -   数据范围: -1.358 - 4.895
2025-05-24 11:43:29,565 - scn_phase_space_process - INFO -   数据均值: -0.000
2025-05-24 11:43:29,565 - scn_phase_space_process - INFO -   数据标准差: 0.578
2025-05-24 11:43:29,565 - scn_phase_space_process - INFO -   数据格式: Excel
2025-05-24 11:43:29,565 - scn_phase_space_process - INFO -   处理器: ExcelCalciumDataProcessor
2025-05-24 11:43:29,566 - scn_phase_space_process - INFO - 
步骤2: 相空间重构
2025-05-24 11:43:29,566 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 11:43:29,566 - scn_phase_space_process - INFO - 数据维度: 10 个细胞, 10 个时间线
2025-05-24 11:43:29,566 - scn_phase_space_process - INFO - 开始处理钙信号数据...
2025-05-24 11:43:33,837 - scn_phase_space_process - INFO - ✓ 相空间重构完成
2025-05-24 11:43:33,838 - scn_phase_space_process - INFO - 
步骤3: 数据裁剪
2025-05-24 11:43:33,838 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 11:43:33,838 - scn_phase_space_process - INFO - 开始裁剪数据到统一长度: 170
2025-05-24 11:43:33,838 - scn_phase_space_process - INFO - ✓ 数据裁剪完成
2025-05-24 11:43:33,838 - scn_phase_space_process - INFO - 
步骤4: 构建图数据集
2025-05-24 11:43:33,839 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 11:43:33,839 - scn_phase_space_process - INFO - 有效样本数量: 100
2025-05-24 11:43:33,840 - scn_phase_space_process - INFO - 生成 nodes.csv 文件...
2025-05-24 11:43:33,840 - scn_phase_space_process - INFO - 转换节点特征格式...
2025-05-24 11:43:33,923 - scn_phase_space_process - INFO - ✓ nodes.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\nodes.csv
2025-05-24 11:43:33,924 - scn_phase_space_process - INFO - 生成 edges.csv 文件...
2025-05-24 11:43:33,940 - scn_phase_space_process - INFO - ✓ edges.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\edges.csv
2025-05-24 11:43:33,940 - scn_phase_space_process - INFO - 生成 graphs.csv 文件...
2025-05-24 11:43:33,940 - scn_phase_space_process - INFO - 外部模块不可用，使用内置的改进标签生成方法...
2025-05-24 11:43:35,954 - scn_phase_space_process - INFO - 使用内置的改进标签生成方法...
2025-05-24 11:43:35,954 - scn_phase_space_process - INFO - 处理 100 个有效样本
2025-05-24 11:43:36,007 - scn_phase_space_process - INFO - 特征矩阵形状: (100, 14)
2025-05-24 11:43:36,022 - scn_phase_space_process - INFO - PCA降维: 14 -> 8
2025-05-24 11:43:36,375 - scn_phase_space_process - INFO - 聚类质量 - 轮廓系数: 0.240
2025-05-24 11:43:36,375 - scn_phase_space_process - INFO - 改进标签分布: {0: 33, 1: 26, 2: 18, 3: 23}
2025-05-24 11:43:36,375 - scn_phase_space_process - INFO - 最终标签分布: {0: 33, 1: 26, 2: 18, 3: 23}
2025-05-24 11:43:36,378 - scn_phase_space_process - INFO - ✓ graphs.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\graphs.csv
2025-05-24 11:43:36,378 - scn_phase_space_process - INFO - 
============================================================
2025-05-24 11:43:36,378 - scn_phase_space_process - INFO - 数据处理流程全部完成!
2025-05-24 11:43:36,378 - scn_phase_space_process - INFO - ============================================================
2025-05-24 11:43:36,379 - scn_phase_space_process - INFO - 数据源信息:
2025-05-24 11:43:36,379 - scn_phase_space_process - INFO -   - 文件: datasets/EMtrace01.xlsx
2025-05-24 11:43:36,380 - scn_phase_space_process - INFO -   - 格式: Excel
2025-05-24 11:43:36,380 - scn_phase_space_process - INFO -   - 处理器: ExcelCalciumDataProcessor
2025-05-24 11:43:36,380 - scn_phase_space_process - INFO - 
生成的文件:
2025-05-24 11:43:36,381 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/nodes.csv
2025-05-24 11:43:36,381 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/edges.csv
2025-05-24 11:43:36,381 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/graphs.csv
2025-05-24 11:43:36,381 - scn_phase_space_process - INFO - 
处理结果:
2025-05-24 11:43:36,381 - scn_phase_space_process - INFO -   - 总样本数量: 100
2025-05-24 11:43:36,381 - scn_phase_space_process - INFO -   - 轨迹长度: 170
2025-05-24 11:43:36,382 - scn_phase_space_process - INFO -   - 嵌入维度: 3
2025-05-24 11:43:36,382 - scn_phase_space_process - INFO - 
下一步操作:
2025-05-24 11:43:36,383 - scn_phase_space_process - INFO -   1. 检查生成的CSV文件质量
2025-05-24 11:43:36,383 - scn_phase_space_process - INFO -   2. 运行训练: python main.py 或 python run.py --train
2025-05-24 11:43:36,383 - scn_phase_space_process - INFO -   3. 查看训练结果: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results
2025-05-24 11:43:36,384 - __main__ - INFO - ✓ 数据处理完成
2025-05-24 11:43:36,384 - __main__ - INFO - ============================================================
2025-05-24 11:43:36,384 - __main__ - INFO - 开始模型训练流程
2025-05-24 11:43:36,384 - __main__ - INFO - ============================================================
2025-05-24 11:43:37,240 - __main__ - ERROR - ✗ 模型训练失败: No module named 'torch_geometric'
2025-05-24 11:43:37,240 - __main__ - ERROR - 模型训练失败
2025-05-24 11:43:37,240 - __main__ - ERROR - 操作失败
2025-05-24 11:45:43,247 - __main__ - INFO - ============================================================
2025-05-24 11:45:43,248 - __main__ - INFO - 开始完整的处理和训练流程
2025-05-24 11:45:43,248 - __main__ - INFO - ============================================================
2025-05-24 11:45:43,248 - __main__ - INFO - ============================================================
2025-05-24 11:45:43,248 - __main__ - INFO - 开始数据处理流程
2025-05-24 11:45:43,248 - __main__ - INFO - ============================================================
2025-05-24 11:45:43,681 - numexpr.utils - INFO - Note: NumExpr detected 16 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-05-24 11:45:43,681 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-05-24 11:45:44,524 - scn_phase_space_process - INFO - ============================================================
2025-05-24 11:45:44,524 - scn_phase_space_process - INFO - 3D SCN数据处理流程 - Python版本
2025-05-24 11:45:44,524 - scn_phase_space_process - INFO - 增强版本：支持Excel和MAT格式
2025-05-24 11:45:44,524 - scn_phase_space_process - INFO - ============================================================
2025-05-24 11:45:44,525 - scn_phase_space_process - INFO - 输出目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets
2025-05-24 11:45:44,525 - scn_phase_space_process - INFO - 
步骤1: 智能数据加载
2025-05-24 11:45:44,525 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 11:45:44,526 - scn_phase_space_process - INFO - 正在检测和加载数据文件: datasets/EMtrace01.xlsx
2025-05-24 11:45:44,526 - scn_phase_space_process - INFO - 检测到文件格式: excel
2025-05-24 11:45:44,526 - scn_phase_space_process - INFO - 使用Excel数据处理器加载钙离子数据...
2025-05-24 11:45:44,527 - excel_data_processor - INFO - 正在加载Excel数据文件: datasets\EMtrace01.xlsx
2025-05-24 11:45:45,599 - excel_data_processor - INFO - ✓ 成功加载数据: 2999 个时间点, 43 个神经元
2025-05-24 11:45:45,599 - excel_data_processor - INFO - 神经元列: ['n1', 'n2', 'n3', 'n4', 'n5', 'n6', 'n7', 'n8', 'n9', 'n10']...
2025-05-24 11:45:45,599 - excel_data_processor - INFO - 开始预处理钙离子数据...
2025-05-24 11:45:45,604 - excel_data_processor - WARNING - 检测并处理了 247 个异常值
2025-05-24 11:45:45,605 - excel_data_processor - INFO - 执行Z-score标准化...
2025-05-24 11:45:45,609 - excel_data_processor - INFO - ✓ 数据预处理完成: (2999, 43) -> (2999, 43)
2025-05-24 11:45:45,609 - excel_data_processor - INFO - 转换数据为SCN处理格式...
2025-05-24 11:45:45,609 - excel_data_processor - INFO - 分段参数: 段长度=340, 步长=170
2025-05-24 11:45:45,610 - excel_data_processor - INFO - ✓ 转换完成: 10 个神经元, 平均每个神经元 10.0 个时间段
2025-05-24 11:45:45,612 - scn_phase_space_process - INFO - 数据加载信息:
2025-05-24 11:45:45,612 - scn_phase_space_process - INFO -   文件路径: datasets\EMtrace01.xlsx
2025-05-24 11:45:45,612 - scn_phase_space_process - INFO -   时间点数量: 2999
2025-05-24 11:45:45,613 - scn_phase_space_process - INFO -   神经元数量: 43
2025-05-24 11:45:45,613 - scn_phase_space_process - INFO -   数据形状: (2999, 43)
2025-05-24 11:45:45,613 - scn_phase_space_process - INFO -   时间戳范围: 1 - 2999
2025-05-24 11:45:45,613 - scn_phase_space_process - INFO -   神经元ID: ['n1', 'n2', 'n3', 'n4', 'n5', '...']
2025-05-24 11:45:45,613 - scn_phase_space_process - INFO -   缺失值数量: 0
2025-05-24 11:45:45,614 - scn_phase_space_process - INFO -   数据范围: -1.358 - 4.895
2025-05-24 11:45:45,614 - scn_phase_space_process - INFO -   数据均值: -0.000
2025-05-24 11:45:45,614 - scn_phase_space_process - INFO -   数据标准差: 0.578
2025-05-24 11:45:45,615 - scn_phase_space_process - INFO -   数据格式: Excel
2025-05-24 11:45:45,615 - scn_phase_space_process - INFO -   处理器: ExcelCalciumDataProcessor
2025-05-24 11:45:45,615 - scn_phase_space_process - INFO - 
步骤2: 相空间重构
2025-05-24 11:45:45,616 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 11:45:45,616 - scn_phase_space_process - INFO - 数据维度: 10 个细胞, 10 个时间线
2025-05-24 11:45:45,616 - scn_phase_space_process - INFO - 开始处理钙信号数据...
2025-05-24 11:45:49,893 - scn_phase_space_process - INFO - ✓ 相空间重构完成
2025-05-24 11:45:49,893 - scn_phase_space_process - INFO - 
步骤3: 数据裁剪
2025-05-24 11:45:49,894 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 11:45:49,894 - scn_phase_space_process - INFO - 开始裁剪数据到统一长度: 170
2025-05-24 11:45:49,894 - scn_phase_space_process - INFO - ✓ 数据裁剪完成
2025-05-24 11:45:49,894 - scn_phase_space_process - INFO - 
步骤4: 构建图数据集
2025-05-24 11:45:49,895 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 11:45:49,895 - scn_phase_space_process - INFO - 有效样本数量: 100
2025-05-24 11:45:49,895 - scn_phase_space_process - INFO - 生成 nodes.csv 文件...
2025-05-24 11:45:49,895 - scn_phase_space_process - INFO - 转换节点特征格式...
2025-05-24 11:45:49,976 - scn_phase_space_process - INFO - ✓ nodes.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\nodes.csv
2025-05-24 11:45:49,976 - scn_phase_space_process - INFO - 生成 edges.csv 文件...
2025-05-24 11:45:49,992 - scn_phase_space_process - INFO - ✓ edges.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\edges.csv
2025-05-24 11:45:49,992 - scn_phase_space_process - INFO - 生成 graphs.csv 文件...
2025-05-24 11:45:49,993 - scn_phase_space_process - INFO - 外部模块不可用，使用内置的改进标签生成方法...
2025-05-24 11:45:50,574 - scn_phase_space_process - INFO - 使用内置的改进标签生成方法...
2025-05-24 11:45:50,575 - scn_phase_space_process - INFO - 处理 100 个有效样本
2025-05-24 11:45:50,613 - scn_phase_space_process - INFO - 特征矩阵形状: (100, 14)
2025-05-24 11:45:50,616 - scn_phase_space_process - INFO - PCA降维: 14 -> 8
2025-05-24 11:45:50,921 - scn_phase_space_process - INFO - 聚类质量 - 轮廓系数: 0.225
2025-05-24 11:45:50,921 - scn_phase_space_process - INFO - 改进标签分布: {0: 6, 1: 26, 2: 24, 3: 19, 4: 23, 5: 2}
2025-05-24 11:45:50,921 - scn_phase_space_process - INFO - 最终标签分布: {0: 6, 1: 26, 2: 24, 3: 19, 4: 23, 5: 2}
2025-05-24 11:45:50,924 - scn_phase_space_process - INFO - ✓ graphs.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\graphs.csv
2025-05-24 11:45:50,924 - scn_phase_space_process - INFO - 
============================================================
2025-05-24 11:45:50,925 - scn_phase_space_process - INFO - 数据处理流程全部完成!
2025-05-24 11:45:50,925 - scn_phase_space_process - INFO - ============================================================
2025-05-24 11:45:50,925 - scn_phase_space_process - INFO - 数据源信息:
2025-05-24 11:45:50,925 - scn_phase_space_process - INFO -   - 文件: datasets/EMtrace01.xlsx
2025-05-24 11:45:50,926 - scn_phase_space_process - INFO -   - 格式: Excel
2025-05-24 11:45:50,926 - scn_phase_space_process - INFO -   - 处理器: ExcelCalciumDataProcessor
2025-05-24 11:45:50,926 - scn_phase_space_process - INFO - 
生成的文件:
2025-05-24 11:45:50,926 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/nodes.csv
2025-05-24 11:45:50,927 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/edges.csv
2025-05-24 11:45:50,927 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/graphs.csv
2025-05-24 11:45:50,927 - scn_phase_space_process - INFO - 
处理结果:
2025-05-24 11:45:50,928 - scn_phase_space_process - INFO -   - 总样本数量: 100
2025-05-24 11:45:50,928 - scn_phase_space_process - INFO -   - 轨迹长度: 170
2025-05-24 11:45:50,928 - scn_phase_space_process - INFO -   - 嵌入维度: 3
2025-05-24 11:45:50,928 - scn_phase_space_process - INFO - 
下一步操作:
2025-05-24 11:45:50,928 - scn_phase_space_process - INFO -   1. 检查生成的CSV文件质量
2025-05-24 11:45:50,928 - scn_phase_space_process - INFO -   2. 运行训练: python main.py 或 python run.py --train
2025-05-24 11:45:50,929 - scn_phase_space_process - INFO -   3. 查看训练结果: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results
2025-05-24 11:45:50,929 - __main__ - INFO - ✓ 数据处理完成
2025-05-24 11:45:50,930 - __main__ - INFO - ============================================================
2025-05-24 11:45:50,930 - __main__ - INFO - 开始模型训练流程
2025-05-24 11:45:50,930 - __main__ - INFO - ============================================================
2025-05-24 11:45:51,656 - __main__ - ERROR - ✗ 模型训练失败: No module named 'torch_geometric'
2025-05-24 11:45:51,656 - __main__ - ERROR - 模型训练失败
2025-05-24 11:45:51,657 - __main__ - ERROR - 操作失败
2025-05-24 11:52:17,331 - __main__ - INFO - ============================================================
2025-05-24 11:52:17,332 - __main__ - INFO - 开始数据处理流程
2025-05-24 11:52:17,332 - __main__ - INFO - ============================================================
2025-05-24 11:52:17,532 - numexpr.utils - INFO - Note: NumExpr detected 16 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-05-24 11:52:17,532 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-05-24 11:52:18,325 - scn_phase_space_process - INFO - ============================================================
2025-05-24 11:52:18,325 - scn_phase_space_process - INFO - 3D SCN数据处理流程 - Python版本
2025-05-24 11:52:18,325 - scn_phase_space_process - INFO - 增强版本：支持Excel和MAT格式
2025-05-24 11:52:18,326 - scn_phase_space_process - INFO - ============================================================
2025-05-24 11:52:18,326 - scn_phase_space_process - INFO - 输出目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets
2025-05-24 11:52:18,326 - scn_phase_space_process - INFO - 
步骤1: 智能数据加载
2025-05-24 11:52:18,327 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 11:52:18,327 - scn_phase_space_process - INFO - 正在检测和加载数据文件: datasets/EMtrace01.xlsx
2025-05-24 11:52:18,327 - scn_phase_space_process - INFO - 检测到文件格式: excel
2025-05-24 11:52:18,328 - scn_phase_space_process - INFO - 使用Excel数据处理器加载钙离子数据...
2025-05-24 11:52:18,328 - excel_data_processor - INFO - 正在加载Excel数据文件: datasets\EMtrace01.xlsx
2025-05-24 11:52:19,413 - excel_data_processor - INFO - ✓ 成功加载数据: 2999 个时间点, 43 个神经元
2025-05-24 11:52:19,413 - excel_data_processor - INFO - 神经元列: ['n1', 'n2', 'n3', 'n4', 'n5', 'n6', 'n7', 'n8', 'n9', 'n10']...
2025-05-24 11:52:19,413 - excel_data_processor - INFO - 开始预处理钙离子数据...
2025-05-24 11:52:19,419 - excel_data_processor - WARNING - 检测并处理了 247 个异常值
2025-05-24 11:52:19,419 - excel_data_processor - INFO - 执行Z-score标准化...
2025-05-24 11:52:19,422 - excel_data_processor - INFO - ✓ 数据预处理完成: (2999, 43) -> (2999, 43)
2025-05-24 11:52:19,422 - excel_data_processor - INFO - 转换数据为SCN处理格式...
2025-05-24 11:52:19,422 - excel_data_processor - INFO - 分段参数: 段长度=340, 步长=170
2025-05-24 11:52:19,422 - excel_data_processor - INFO - ✓ 转换完成: 10 个神经元, 平均每个神经元 10.0 个时间段
2025-05-24 11:52:19,425 - scn_phase_space_process - INFO - 数据加载信息:
2025-05-24 11:52:19,425 - scn_phase_space_process - INFO -   文件路径: datasets\EMtrace01.xlsx
2025-05-24 11:52:19,425 - scn_phase_space_process - INFO -   时间点数量: 2999
2025-05-24 11:52:19,425 - scn_phase_space_process - INFO -   神经元数量: 43
2025-05-24 11:52:19,426 - scn_phase_space_process - INFO -   数据形状: (2999, 43)
2025-05-24 11:52:19,426 - scn_phase_space_process - INFO -   时间戳范围: 1 - 2999
2025-05-24 11:52:19,426 - scn_phase_space_process - INFO -   神经元ID: ['n1', 'n2', 'n3', 'n4', 'n5', '...']
2025-05-24 11:52:19,426 - scn_phase_space_process - INFO -   缺失值数量: 0
2025-05-24 11:52:19,427 - scn_phase_space_process - INFO -   数据范围: -1.358 - 4.895
2025-05-24 11:52:19,427 - scn_phase_space_process - INFO -   数据均值: -0.000
2025-05-24 11:52:19,427 - scn_phase_space_process - INFO -   数据标准差: 0.578
2025-05-24 11:52:19,427 - scn_phase_space_process - INFO -   数据格式: Excel
2025-05-24 11:52:19,427 - scn_phase_space_process - INFO -   处理器: ExcelCalciumDataProcessor
2025-05-24 11:52:19,427 - scn_phase_space_process - INFO - 
步骤2: 相空间重构
2025-05-24 11:52:19,427 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 11:52:19,428 - scn_phase_space_process - INFO - 数据维度: 10 个细胞, 10 个时间线
2025-05-24 11:52:19,428 - scn_phase_space_process - INFO - 开始处理钙信号数据...
2025-05-24 11:52:23,670 - scn_phase_space_process - INFO - ✓ 相空间重构完成
2025-05-24 11:52:23,670 - scn_phase_space_process - INFO - 
步骤3: 数据裁剪
2025-05-24 11:52:23,670 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 11:52:23,670 - scn_phase_space_process - INFO - 开始裁剪数据到统一长度: 170
2025-05-24 11:52:23,671 - scn_phase_space_process - INFO - ✓ 数据裁剪完成
2025-05-24 11:52:23,671 - scn_phase_space_process - INFO - 
步骤4: 构建图数据集
2025-05-24 11:52:23,671 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 11:52:23,671 - scn_phase_space_process - INFO - 有效样本数量: 100
2025-05-24 11:52:23,672 - scn_phase_space_process - INFO - 生成 nodes.csv 文件...
2025-05-24 11:52:23,672 - scn_phase_space_process - INFO - 转换节点特征格式...
2025-05-24 11:52:23,745 - scn_phase_space_process - INFO - ✓ nodes.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\nodes.csv
2025-05-24 11:52:23,746 - scn_phase_space_process - INFO - 生成 edges.csv 文件...
2025-05-24 11:52:23,760 - scn_phase_space_process - INFO - ✓ edges.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\edges.csv
2025-05-24 11:52:23,760 - scn_phase_space_process - INFO - 生成 graphs.csv 文件...
2025-05-24 11:52:23,761 - scn_phase_space_process - INFO - 外部模块不可用，使用内置的改进标签生成方法...
2025-05-24 11:52:24,323 - scn_phase_space_process - INFO - 使用内置的改进标签生成方法...
2025-05-24 11:52:24,323 - scn_phase_space_process - INFO - 处理 100 个有效样本
2025-05-24 11:52:24,361 - scn_phase_space_process - INFO - 特征矩阵形状: (100, 14)
2025-05-24 11:52:24,363 - scn_phase_space_process - INFO - PCA降维: 14 -> 8
2025-05-24 11:52:24,682 - scn_phase_space_process - INFO - 聚类质量 - 轮廓系数: 0.225
2025-05-24 11:52:24,683 - scn_phase_space_process - INFO - 改进标签分布: {0: 6, 1: 26, 2: 24, 3: 19, 4: 23, 5: 2}
2025-05-24 11:52:24,683 - scn_phase_space_process - INFO - 最终标签分布: {0: 6, 1: 26, 2: 24, 3: 19, 4: 23, 5: 2}
2025-05-24 11:52:25,529 - scn_phase_space_process - INFO - ✓ graphs.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\graphs.csv
2025-05-24 11:52:25,529 - scn_phase_space_process - INFO - 
============================================================
2025-05-24 11:52:25,530 - scn_phase_space_process - INFO - 数据处理流程全部完成!
2025-05-24 11:52:25,530 - scn_phase_space_process - INFO - ============================================================
2025-05-24 11:52:25,530 - scn_phase_space_process - INFO - 数据源信息:
2025-05-24 11:52:25,531 - scn_phase_space_process - INFO -   - 文件: datasets/EMtrace01.xlsx
2025-05-24 11:52:25,531 - scn_phase_space_process - INFO -   - 格式: Excel
2025-05-24 11:52:25,531 - scn_phase_space_process - INFO -   - 处理器: ExcelCalciumDataProcessor
2025-05-24 11:52:25,532 - scn_phase_space_process - INFO - 
生成的文件:
2025-05-24 11:52:25,532 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/nodes.csv
2025-05-24 11:52:25,533 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/edges.csv
2025-05-24 11:52:25,535 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/graphs.csv
2025-05-24 11:52:25,536 - scn_phase_space_process - INFO - 
处理结果:
2025-05-24 11:52:25,537 - scn_phase_space_process - INFO -   - 总样本数量: 100
2025-05-24 11:52:25,539 - scn_phase_space_process - INFO -   - 轨迹长度: 170
2025-05-24 11:52:25,541 - scn_phase_space_process - INFO -   - 嵌入维度: 3
2025-05-24 11:52:25,542 - scn_phase_space_process - INFO - 
下一步操作:
2025-05-24 11:52:25,543 - scn_phase_space_process - INFO -   1. 检查生成的CSV文件质量
2025-05-24 11:52:25,544 - scn_phase_space_process - INFO -   2. 运行训练: python main.py 或 python run.py --train
2025-05-24 11:52:25,545 - scn_phase_space_process - INFO -   3. 查看训练结果: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results
2025-05-24 11:52:25,546 - __main__ - INFO - ✓ 数据处理完成
2025-05-24 11:52:25,547 - __main__ - INFO - 操作成功完成
2025-05-24 11:52:52,930 - __main__ - INFO - ============================================================
2025-05-24 11:52:52,930 - __main__ - INFO - 开始模型训练流程
2025-05-24 11:52:52,930 - __main__ - INFO - ============================================================
2025-05-24 11:52:54,680 - __main__ - ERROR - ✗ 模型训练失败: No module named 'torch_geometric'
2025-05-24 11:52:54,680 - __main__ - ERROR - 操作失败
2025-05-24 14:42:15,466 - __main__ - INFO - ============================================================
2025-05-24 14:42:15,483 - __main__ - INFO - 开始数据处理流程
2025-05-24 14:42:15,483 - __main__ - INFO - ============================================================
2025-05-24 14:42:17,693 - scn_phase_space_process - INFO - ============================================================
2025-05-24 14:42:17,693 - scn_phase_space_process - INFO - 3D SCN数据处理流程 - Python版本
2025-05-24 14:42:17,693 - scn_phase_space_process - INFO - 增强版本：支持Excel和MAT格式
2025-05-24 14:42:17,694 - scn_phase_space_process - INFO - ============================================================
2025-05-24 14:42:17,694 - scn_phase_space_process - INFO - 输出目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets
2025-05-24 14:42:17,695 - scn_phase_space_process - INFO - 
步骤1: 智能数据加载
2025-05-24 14:42:17,695 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 14:42:17,695 - scn_phase_space_process - INFO - 正在检测和加载数据文件: datasets/EMtrace01.xlsx
2025-05-24 14:42:17,695 - scn_phase_space_process - INFO - 检测到文件格式: excel
2025-05-24 14:42:17,696 - scn_phase_space_process - INFO - 使用Excel数据处理器加载钙离子数据...
2025-05-24 14:42:17,696 - excel_data_processor - INFO - 正在加载Excel数据文件: datasets\EMtrace01.xlsx
2025-05-24 14:42:18,721 - excel_data_processor - INFO - ✓ 成功加载数据: 2999 个时间点, 43 个神经元
2025-05-24 14:42:18,721 - excel_data_processor - INFO - 神经元列: ['n1', 'n2', 'n3', 'n4', 'n5', 'n6', 'n7', 'n8', 'n9', 'n10']...
2025-05-24 14:42:18,722 - excel_data_processor - INFO - 开始预处理钙离子数据...
2025-05-24 14:42:18,729 - excel_data_processor - WARNING - 检测并处理了 247 个异常值
2025-05-24 14:42:18,730 - excel_data_processor - INFO - 执行Z-score标准化...
2025-05-24 14:42:18,733 - excel_data_processor - INFO - ✓ 数据预处理完成: (2999, 43) -> (2999, 43)
2025-05-24 14:42:18,733 - excel_data_processor - INFO - 转换数据为SCN处理格式...
2025-05-24 14:42:18,733 - excel_data_processor - INFO - 分段参数: 段长度=340, 步长=170
2025-05-24 14:42:18,734 - excel_data_processor - INFO - ✓ 转换完成: 10 个神经元, 平均每个神经元 10.0 个时间段
2025-05-24 14:42:18,736 - scn_phase_space_process - INFO - 数据加载信息:
2025-05-24 14:42:18,737 - scn_phase_space_process - INFO -   文件路径: datasets\EMtrace01.xlsx
2025-05-24 14:42:18,737 - scn_phase_space_process - INFO -   时间点数量: 2999
2025-05-24 14:42:18,737 - scn_phase_space_process - INFO -   神经元数量: 43
2025-05-24 14:42:18,737 - scn_phase_space_process - INFO -   数据形状: (2999, 43)
2025-05-24 14:42:18,738 - scn_phase_space_process - INFO -   时间戳范围: 1 - 2999
2025-05-24 14:42:18,738 - scn_phase_space_process - INFO -   神经元ID: ['n1', 'n2', 'n3', 'n4', 'n5', '...']
2025-05-24 14:42:18,738 - scn_phase_space_process - INFO -   缺失值数量: 0
2025-05-24 14:42:18,738 - scn_phase_space_process - INFO -   数据范围: -1.358 - 4.895
2025-05-24 14:42:18,739 - scn_phase_space_process - INFO -   数据均值: -0.000
2025-05-24 14:42:18,740 - scn_phase_space_process - INFO -   数据标准差: 0.578
2025-05-24 14:42:18,740 - scn_phase_space_process - INFO -   数据格式: Excel
2025-05-24 14:42:18,740 - scn_phase_space_process - INFO -   处理器: ExcelCalciumDataProcessor
2025-05-24 14:42:18,740 - scn_phase_space_process - INFO - 
步骤2: 相空间重构
2025-05-24 14:42:18,741 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 14:42:18,741 - scn_phase_space_process - INFO - 数据维度: 10 个细胞, 10 个时间线
2025-05-24 14:42:18,741 - scn_phase_space_process - INFO - 开始处理钙信号数据...
2025-05-24 14:42:23,524 - scn_phase_space_process - INFO - ✓ 相空间重构完成
2025-05-24 14:42:23,524 - scn_phase_space_process - INFO - 
步骤3: 数据裁剪
2025-05-24 14:42:23,525 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 14:42:23,525 - scn_phase_space_process - INFO - 开始裁剪数据到统一长度: 170
2025-05-24 14:42:23,525 - scn_phase_space_process - INFO - ✓ 数据裁剪完成
2025-05-24 14:42:23,525 - scn_phase_space_process - INFO - 
步骤4: 构建图数据集
2025-05-24 14:42:23,526 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 14:42:23,526 - scn_phase_space_process - INFO - 有效样本数量: 100
2025-05-24 14:42:23,526 - scn_phase_space_process - INFO - 生成 nodes.csv 文件...
2025-05-24 14:42:23,527 - scn_phase_space_process - INFO - 转换节点特征格式...
2025-05-24 14:42:23,603 - scn_phase_space_process - INFO - ✓ nodes.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\nodes.csv
2025-05-24 14:42:23,604 - scn_phase_space_process - INFO - 生成 edges.csv 文件...
2025-05-24 14:42:23,632 - scn_phase_space_process - INFO - ✓ edges.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\edges.csv
2025-05-24 14:42:23,633 - scn_phase_space_process - INFO - 生成 graphs.csv 文件...
2025-05-24 14:42:23,634 - scn_phase_space_process - INFO - 外部模块不可用，使用内置的改进标签生成方法...
2025-05-24 14:42:23,983 - scn_phase_space_process - INFO - 使用内置的改进标签生成方法...
2025-05-24 14:42:23,984 - scn_phase_space_process - INFO - 处理 100 个有效样本
2025-05-24 14:42:24,042 - scn_phase_space_process - INFO - 特征矩阵形状: (100, 14)
2025-05-24 14:42:24,048 - scn_phase_space_process - INFO - PCA降维: 14 -> 8
2025-05-24 14:42:24,559 - scn_phase_space_process - INFO - 聚类质量 - 轮廓系数: 0.224
2025-05-24 14:42:24,560 - scn_phase_space_process - INFO - 改进标签分布: {np.int32(0): np.int64(21), np.int32(1): np.int64(28), np.int32(2): np.int64(13), np.int32(3): np.int64(13), np.int32(4): np.int64(9), np.int32(5): np.int64(16)}
2025-05-24 14:42:24,560 - scn_phase_space_process - INFO - 最终标签分布: {np.int32(0): np.int64(21), np.int32(1): np.int64(28), np.int32(2): np.int64(13), np.int32(3): np.int64(13), np.int32(4): np.int64(9), np.int32(5): np.int64(16)}
2025-05-24 14:42:24,563 - scn_phase_space_process - INFO - ✓ graphs.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\graphs.csv
2025-05-24 14:42:24,563 - scn_phase_space_process - INFO - 
============================================================
2025-05-24 14:42:24,564 - scn_phase_space_process - INFO - 数据处理流程全部完成!
2025-05-24 14:42:24,564 - scn_phase_space_process - INFO - ============================================================
2025-05-24 14:42:24,564 - scn_phase_space_process - INFO - 数据源信息:
2025-05-24 14:42:24,565 - scn_phase_space_process - INFO -   - 文件: datasets/EMtrace01.xlsx
2025-05-24 14:42:24,565 - scn_phase_space_process - INFO -   - 格式: Excel
2025-05-24 14:42:24,565 - scn_phase_space_process - INFO -   - 处理器: ExcelCalciumDataProcessor
2025-05-24 14:42:24,566 - scn_phase_space_process - INFO - 
生成的文件:
2025-05-24 14:42:24,566 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/nodes.csv
2025-05-24 14:42:24,566 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/edges.csv
2025-05-24 14:42:24,567 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/graphs.csv
2025-05-24 14:42:24,567 - scn_phase_space_process - INFO - 
处理结果:
2025-05-24 14:42:24,568 - scn_phase_space_process - INFO -   - 总样本数量: 100
2025-05-24 14:42:24,568 - scn_phase_space_process - INFO -   - 轨迹长度: 170
2025-05-24 14:42:24,568 - scn_phase_space_process - INFO -   - 嵌入维度: 3
2025-05-24 14:42:24,569 - scn_phase_space_process - INFO - 
下一步操作:
2025-05-24 14:42:24,569 - scn_phase_space_process - INFO -   1. 检查生成的CSV文件质量
2025-05-24 14:42:24,569 - scn_phase_space_process - INFO -   2. 运行训练: python main.py 或 python run.py --train
2025-05-24 14:42:24,569 - scn_phase_space_process - INFO -   3. 查看训练结果: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results
2025-05-24 14:42:24,570 - __main__ - INFO - ✓ 数据处理完成
2025-05-24 14:42:24,571 - __main__ - INFO - 操作成功完成
2025-05-24 15:19:53,022 - __main__ - INFO - ============================================================
2025-05-24 15:19:53,022 - __main__ - INFO - 开始数据处理流程
2025-05-24 15:19:53,022 - __main__ - INFO - ============================================================
2025-05-24 15:19:53,209 - numexpr.utils - INFO - Note: NumExpr detected 16 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-05-24 15:19:53,210 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-05-24 15:19:54,022 - scn_phase_space_process - INFO - ============================================================
2025-05-24 15:19:54,022 - scn_phase_space_process - INFO - 3D SCN数据处理流程 - Python版本
2025-05-24 15:19:54,022 - scn_phase_space_process - INFO - 增强版本：支持Excel和MAT格式
2025-05-24 15:19:54,023 - scn_phase_space_process - INFO - ============================================================
2025-05-24 15:19:54,023 - scn_phase_space_process - INFO - 输出目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets
2025-05-24 15:19:54,024 - scn_phase_space_process - INFO - 
步骤1: 智能数据加载
2025-05-24 15:19:54,024 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 15:19:54,024 - scn_phase_space_process - INFO - 正在检测和加载数据文件: datasets/EMtrace01.xlsx
2025-05-24 15:19:54,024 - scn_phase_space_process - INFO - 检测到文件格式: excel
2025-05-24 15:19:54,025 - scn_phase_space_process - INFO - 使用Excel数据处理器加载钙离子数据...
2025-05-24 15:19:54,025 - excel_data_processor - INFO - 正在加载Excel数据文件: datasets\EMtrace01.xlsx
2025-05-24 15:19:55,138 - excel_data_processor - INFO - ✓ 成功加载数据: 2999 个时间点, 43 个神经元
2025-05-24 15:19:55,138 - excel_data_processor - INFO - 神经元列: ['n1', 'n2', 'n3', 'n4', 'n5', 'n6', 'n7', 'n8', 'n9', 'n10']...
2025-05-24 15:19:55,138 - excel_data_processor - INFO - 开始预处理钙离子数据...
2025-05-24 15:19:55,144 - excel_data_processor - WARNING - 检测并处理了 247 个异常值
2025-05-24 15:19:55,144 - excel_data_processor - INFO - 执行Z-score标准化...
2025-05-24 15:19:55,146 - excel_data_processor - INFO - ✓ 数据预处理完成: (2999, 43) -> (2999, 43)
2025-05-24 15:19:55,146 - excel_data_processor - INFO - 转换数据为SCN处理格式...
2025-05-24 15:19:55,147 - excel_data_processor - INFO - 分段参数: 段长度=340, 步长=170
2025-05-24 15:19:55,148 - excel_data_processor - INFO - ✓ 转换完成: 10 个神经元, 平均每个神经元 10.0 个时间段
2025-05-24 15:19:55,149 - scn_phase_space_process - INFO - 数据加载信息:
2025-05-24 15:19:55,149 - scn_phase_space_process - INFO -   文件路径: datasets\EMtrace01.xlsx
2025-05-24 15:19:55,149 - scn_phase_space_process - INFO -   时间点数量: 2999
2025-05-24 15:19:55,150 - scn_phase_space_process - INFO -   神经元数量: 43
2025-05-24 15:19:55,150 - scn_phase_space_process - INFO -   数据形状: (2999, 43)
2025-05-24 15:19:55,150 - scn_phase_space_process - INFO -   时间戳范围: 1 - 2999
2025-05-24 15:19:55,150 - scn_phase_space_process - INFO -   神经元ID: ['n1', 'n2', 'n3', 'n4', 'n5', '...']
2025-05-24 15:19:55,150 - scn_phase_space_process - INFO -   缺失值数量: 0
2025-05-24 15:19:55,151 - scn_phase_space_process - INFO -   数据范围: -1.358 - 4.895
2025-05-24 15:19:55,151 - scn_phase_space_process - INFO -   数据均值: -0.000
2025-05-24 15:19:55,151 - scn_phase_space_process - INFO -   数据标准差: 0.578
2025-05-24 15:19:55,151 - scn_phase_space_process - INFO -   数据格式: Excel
2025-05-24 15:19:55,151 - scn_phase_space_process - INFO -   处理器: ExcelCalciumDataProcessor
2025-05-24 15:19:55,151 - scn_phase_space_process - INFO - 
步骤2: 相空间重构
2025-05-24 15:19:55,151 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 15:19:55,151 - scn_phase_space_process - INFO - 数据维度: 10 个细胞, 10 个时间线
2025-05-24 15:19:55,151 - scn_phase_space_process - INFO - 开始处理钙信号数据...
2025-05-24 15:19:59,433 - scn_phase_space_process - INFO - ✓ 相空间重构完成
2025-05-24 15:19:59,433 - scn_phase_space_process - INFO - 
步骤3: 数据裁剪
2025-05-24 15:19:59,434 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 15:19:59,434 - scn_phase_space_process - INFO - 开始裁剪数据到统一长度: 170
2025-05-24 15:19:59,434 - scn_phase_space_process - INFO - ✓ 数据裁剪完成
2025-05-24 15:19:59,434 - scn_phase_space_process - INFO - 
步骤4: 构建图数据集
2025-05-24 15:19:59,434 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 15:19:59,434 - scn_phase_space_process - INFO - 有效样本数量: 100
2025-05-24 15:19:59,435 - scn_phase_space_process - INFO - 生成 nodes.csv 文件...
2025-05-24 15:19:59,435 - scn_phase_space_process - INFO - 转换节点特征格式...
2025-05-24 15:19:59,513 - scn_phase_space_process - INFO - ✓ nodes.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\nodes.csv
2025-05-24 15:19:59,514 - scn_phase_space_process - INFO - 生成 edges.csv 文件...
2025-05-24 15:19:59,531 - scn_phase_space_process - INFO - ✓ edges.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\edges.csv
2025-05-24 15:19:59,531 - scn_phase_space_process - INFO - 生成 graphs.csv 文件...
2025-05-24 15:19:59,531 - scn_phase_space_process - INFO - 使用内置的改进标签生成方法...
2025-05-24 15:20:00,120 - scn_phase_space_process - INFO - 使用内置的改进标签生成方法...
2025-05-24 15:20:00,120 - scn_phase_space_process - INFO - 处理 100 个有效样本
2025-05-24 15:20:00,159 - scn_phase_space_process - INFO - 特征矩阵形状: (100, 14)
2025-05-24 15:20:00,161 - scn_phase_space_process - INFO - PCA降维: 14 -> 8
2025-05-24 15:20:00,500 - scn_phase_space_process - INFO - 聚类质量 - 轮廓系数: 0.225
2025-05-24 15:20:00,500 - scn_phase_space_process - INFO - 改进标签分布: {0: 6, 1: 26, 2: 24, 3: 19, 4: 23, 5: 2}
2025-05-24 15:20:00,501 - scn_phase_space_process - INFO - 最终标签分布: {0: 6, 1: 26, 2: 24, 3: 19, 4: 23, 5: 2}
2025-05-24 15:20:00,503 - scn_phase_space_process - INFO - ✓ graphs.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\graphs.csv
2025-05-24 15:20:00,504 - scn_phase_space_process - INFO - 
============================================================
2025-05-24 15:20:00,504 - scn_phase_space_process - INFO - 数据处理流程全部完成!
2025-05-24 15:20:00,504 - scn_phase_space_process - INFO - ============================================================
2025-05-24 15:20:00,504 - scn_phase_space_process - INFO - 数据源信息:
2025-05-24 15:20:00,505 - scn_phase_space_process - INFO -   - 文件: datasets/EMtrace01.xlsx
2025-05-24 15:20:00,505 - scn_phase_space_process - INFO -   - 格式: Excel
2025-05-24 15:20:00,505 - scn_phase_space_process - INFO -   - 处理器: ExcelCalciumDataProcessor
2025-05-24 15:20:00,506 - scn_phase_space_process - INFO - 
生成的文件:
2025-05-24 15:20:00,506 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/nodes.csv
2025-05-24 15:20:00,506 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/edges.csv
2025-05-24 15:20:00,506 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/graphs.csv
2025-05-24 15:20:00,507 - scn_phase_space_process - INFO - 
处理结果:
2025-05-24 15:20:00,507 - scn_phase_space_process - INFO -   - 总样本数量: 100
2025-05-24 15:20:00,507 - scn_phase_space_process - INFO -   - 轨迹长度: 170
2025-05-24 15:20:00,508 - scn_phase_space_process - INFO -   - 嵌入维度: 3
2025-05-24 15:20:00,508 - scn_phase_space_process - INFO - 
下一步操作:
2025-05-24 15:20:00,508 - scn_phase_space_process - INFO -   1. 检查生成的CSV文件质量
2025-05-24 15:20:00,508 - scn_phase_space_process - INFO -   2. 运行训练: python main.py 或 python run.py --train
2025-05-24 15:20:00,509 - scn_phase_space_process - INFO -   3. 查看训练结果: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results
2025-05-24 15:20:00,509 - __main__ - INFO - ✓ 数据处理完成
2025-05-24 15:20:00,509 - __main__ - INFO - 操作成功完成
2025-05-24 15:20:38,748 - __main__ - INFO - ============================================================
2025-05-24 15:20:38,749 - __main__ - INFO - 开始数据处理流程
2025-05-24 15:20:38,749 - __main__ - INFO - ============================================================
2025-05-24 15:20:38,931 - numexpr.utils - INFO - Note: NumExpr detected 16 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2025-05-24 15:20:38,931 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2025-05-24 15:20:39,715 - scn_phase_space_process - INFO - ============================================================
2025-05-24 15:20:39,715 - scn_phase_space_process - INFO - 3D SCN数据处理流程 - Python版本
2025-05-24 15:20:39,715 - scn_phase_space_process - INFO - 增强版本：支持Excel和MAT格式
2025-05-24 15:20:39,715 - scn_phase_space_process - INFO - ============================================================
2025-05-24 15:20:39,716 - scn_phase_space_process - INFO - 输出目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets
2025-05-24 15:20:39,716 - scn_phase_space_process - INFO - 
步骤1: 智能数据加载
2025-05-24 15:20:39,716 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 15:20:39,716 - scn_phase_space_process - INFO - 正在检测和加载数据文件: datasets/EMtrace01.xlsx
2025-05-24 15:20:39,716 - scn_phase_space_process - INFO - 检测到文件格式: excel
2025-05-24 15:20:39,716 - scn_phase_space_process - INFO - 使用Excel数据处理器加载钙离子数据...
2025-05-24 15:20:39,717 - excel_data_processor - INFO - 正在加载Excel数据文件: datasets\EMtrace01.xlsx
2025-05-24 15:20:40,755 - excel_data_processor - INFO - ✓ 成功加载数据: 2999 个时间点, 43 个神经元
2025-05-24 15:20:40,755 - excel_data_processor - INFO - 神经元列: ['n1', 'n2', 'n3', 'n4', 'n5', 'n6', 'n7', 'n8', 'n9', 'n10']...
2025-05-24 15:20:40,755 - excel_data_processor - INFO - 开始预处理钙离子数据...
2025-05-24 15:20:40,759 - excel_data_processor - WARNING - 检测并处理了 247 个异常值
2025-05-24 15:20:40,760 - excel_data_processor - INFO - 执行Z-score标准化...
2025-05-24 15:20:40,763 - excel_data_processor - INFO - ✓ 数据预处理完成: (2999, 43) -> (2999, 43)
2025-05-24 15:20:40,763 - excel_data_processor - INFO - 转换数据为SCN处理格式...
2025-05-24 15:20:40,764 - excel_data_processor - INFO - 分段参数: 段长度=340, 步长=170
2025-05-24 15:20:40,764 - excel_data_processor - INFO - ✓ 转换完成: 10 个神经元, 平均每个神经元 10.0 个时间段
2025-05-24 15:20:40,765 - scn_phase_space_process - INFO - 数据加载信息:
2025-05-24 15:20:40,766 - scn_phase_space_process - INFO -   文件路径: datasets\EMtrace01.xlsx
2025-05-24 15:20:40,766 - scn_phase_space_process - INFO -   时间点数量: 2999
2025-05-24 15:20:40,767 - scn_phase_space_process - INFO -   神经元数量: 43
2025-05-24 15:20:40,767 - scn_phase_space_process - INFO -   数据形状: (2999, 43)
2025-05-24 15:20:40,767 - scn_phase_space_process - INFO -   时间戳范围: 1 - 2999
2025-05-24 15:20:40,767 - scn_phase_space_process - INFO -   神经元ID: ['n1', 'n2', 'n3', 'n4', 'n5', '...']
2025-05-24 15:20:40,768 - scn_phase_space_process - INFO -   缺失值数量: 0
2025-05-24 15:20:40,768 - scn_phase_space_process - INFO -   数据范围: -1.358 - 4.895
2025-05-24 15:20:40,768 - scn_phase_space_process - INFO -   数据均值: -0.000
2025-05-24 15:20:40,768 - scn_phase_space_process - INFO -   数据标准差: 0.578
2025-05-24 15:20:40,768 - scn_phase_space_process - INFO -   数据格式: Excel
2025-05-24 15:20:40,769 - scn_phase_space_process - INFO -   处理器: ExcelCalciumDataProcessor
2025-05-24 15:20:40,769 - scn_phase_space_process - INFO - 
步骤2: 相空间重构
2025-05-24 15:20:40,769 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 15:20:40,769 - scn_phase_space_process - INFO - 数据维度: 10 个细胞, 10 个时间线
2025-05-24 15:20:40,769 - scn_phase_space_process - INFO - 开始处理钙信号数据...
2025-05-24 15:20:44,906 - scn_phase_space_process - INFO - ✓ 相空间重构完成
2025-05-24 15:20:44,906 - scn_phase_space_process - INFO - 
步骤3: 数据裁剪
2025-05-24 15:20:44,906 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 15:20:44,906 - scn_phase_space_process - INFO - 开始裁剪数据到统一长度: 170
2025-05-24 15:20:44,906 - scn_phase_space_process - INFO - ✓ 数据裁剪完成
2025-05-24 15:20:44,906 - scn_phase_space_process - INFO - 
步骤4: 构建图数据集
2025-05-24 15:20:44,906 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 15:20:44,906 - scn_phase_space_process - INFO - 有效样本数量: 100
2025-05-24 15:20:44,907 - scn_phase_space_process - INFO - 生成 nodes.csv 文件...
2025-05-24 15:20:44,908 - scn_phase_space_process - INFO - 转换节点特征格式...
2025-05-24 15:20:44,987 - scn_phase_space_process - INFO - ✓ nodes.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\nodes.csv
2025-05-24 15:20:44,987 - scn_phase_space_process - INFO - 生成 edges.csv 文件...
2025-05-24 15:20:45,001 - scn_phase_space_process - INFO - ✓ edges.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\edges.csv
2025-05-24 15:20:45,001 - scn_phase_space_process - INFO - 生成 graphs.csv 文件...
2025-05-24 15:20:45,002 - scn_phase_space_process - INFO - 使用内置的改进标签生成方法...
2025-05-24 15:20:45,534 - scn_phase_space_process - INFO - 使用内置的改进标签生成方法...
2025-05-24 15:20:45,535 - scn_phase_space_process - INFO - 处理 100 个有效样本
2025-05-24 15:20:45,572 - scn_phase_space_process - INFO - 特征矩阵形状: (100, 14)
2025-05-24 15:20:45,575 - scn_phase_space_process - INFO - PCA降维: 14 -> 8
2025-05-24 15:20:45,931 - scn_phase_space_process - INFO - 聚类质量 - 轮廓系数: 0.225
2025-05-24 15:20:45,932 - scn_phase_space_process - INFO - 改进标签分布: {0: 6, 1: 26, 2: 24, 3: 19, 4: 23, 5: 2}
2025-05-24 15:20:45,932 - scn_phase_space_process - INFO - 最终标签分布: {0: 6, 1: 26, 2: 24, 3: 19, 4: 23, 5: 2}
2025-05-24 15:20:45,935 - scn_phase_space_process - INFO - ✓ graphs.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\graphs.csv
2025-05-24 15:20:45,935 - scn_phase_space_process - INFO - 
============================================================
2025-05-24 15:20:45,935 - scn_phase_space_process - INFO - 数据处理流程全部完成!
2025-05-24 15:20:45,936 - scn_phase_space_process - INFO - ============================================================
2025-05-24 15:20:45,936 - scn_phase_space_process - INFO - 数据源信息:
2025-05-24 15:20:45,936 - scn_phase_space_process - INFO -   - 文件: datasets/EMtrace01.xlsx
2025-05-24 15:20:45,936 - scn_phase_space_process - INFO -   - 格式: Excel
2025-05-24 15:20:45,937 - scn_phase_space_process - INFO -   - 处理器: ExcelCalciumDataProcessor
2025-05-24 15:20:45,937 - scn_phase_space_process - INFO - 
生成的文件:
2025-05-24 15:20:45,937 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/nodes.csv
2025-05-24 15:20:45,937 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/edges.csv
2025-05-24 15:20:45,938 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/graphs.csv
2025-05-24 15:20:45,938 - scn_phase_space_process - INFO - 
处理结果:
2025-05-24 15:20:45,938 - scn_phase_space_process - INFO -   - 总样本数量: 100
2025-05-24 15:20:45,938 - scn_phase_space_process - INFO -   - 轨迹长度: 170
2025-05-24 15:20:45,939 - scn_phase_space_process - INFO -   - 嵌入维度: 3
2025-05-24 15:20:45,939 - scn_phase_space_process - INFO - 
下一步操作:
2025-05-24 15:20:45,939 - scn_phase_space_process - INFO -   1. 检查生成的CSV文件质量
2025-05-24 15:20:45,939 - scn_phase_space_process - INFO -   2. 运行训练: python main.py 或 python run.py --train
2025-05-24 15:20:45,940 - scn_phase_space_process - INFO -   3. 查看训练结果: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results
2025-05-24 15:20:45,940 - __main__ - INFO - ✓ 数据处理完成
2025-05-24 15:20:45,940 - __main__ - INFO - 操作成功完成
2025-05-24 15:22:08,471 - __main__ - INFO - ============================================================
2025-05-24 15:22:08,471 - __main__ - INFO - 开始数据处理流程
2025-05-24 15:22:08,471 - __main__ - INFO - ============================================================
2025-05-24 15:22:09,511 - scn_phase_space_process - INFO - ============================================================
2025-05-24 15:22:09,511 - scn_phase_space_process - INFO - 3D SCN数据处理流程 - Python版本
2025-05-24 15:22:09,511 - scn_phase_space_process - INFO - 增强版本：支持Excel和MAT格式
2025-05-24 15:22:09,511 - scn_phase_space_process - INFO - ============================================================
2025-05-24 15:22:09,511 - scn_phase_space_process - INFO - 输出目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets
2025-05-24 15:22:09,512 - scn_phase_space_process - INFO - 
步骤1: 智能数据加载
2025-05-24 15:22:09,512 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 15:22:09,513 - scn_phase_space_process - INFO - 正在检测和加载数据文件: datasets/EMtrace01.xlsx
2025-05-24 15:22:09,513 - scn_phase_space_process - INFO - 检测到文件格式: excel
2025-05-24 15:22:09,513 - scn_phase_space_process - INFO - 使用Excel数据处理器加载钙离子数据...
2025-05-24 15:22:09,513 - excel_data_processor - INFO - 正在加载Excel数据文件: datasets\EMtrace01.xlsx
2025-05-24 15:22:10,407 - excel_data_processor - INFO - ✓ 成功加载数据: 2999 个时间点, 43 个神经元
2025-05-24 15:22:10,407 - excel_data_processor - INFO - 神经元列: ['n1', 'n2', 'n3', 'n4', 'n5', 'n6', 'n7', 'n8', 'n9', 'n10']...
2025-05-24 15:22:10,407 - excel_data_processor - INFO - 开始预处理钙离子数据...
2025-05-24 15:22:10,412 - excel_data_processor - WARNING - 检测并处理了 247 个异常值
2025-05-24 15:22:10,412 - excel_data_processor - INFO - 执行Z-score标准化...
2025-05-24 15:22:10,416 - excel_data_processor - INFO - ✓ 数据预处理完成: (2999, 43) -> (2999, 43)
2025-05-24 15:22:10,416 - excel_data_processor - INFO - 转换数据为SCN处理格式...
2025-05-24 15:22:10,416 - excel_data_processor - INFO - 分段参数: 段长度=340, 步长=170
2025-05-24 15:22:10,417 - excel_data_processor - INFO - ✓ 转换完成: 10 个神经元, 平均每个神经元 10.0 个时间段
2025-05-24 15:22:10,419 - scn_phase_space_process - INFO - 数据加载信息:
2025-05-24 15:22:10,420 - scn_phase_space_process - INFO -   文件路径: datasets\EMtrace01.xlsx
2025-05-24 15:22:10,421 - scn_phase_space_process - INFO -   时间点数量: 2999
2025-05-24 15:22:10,421 - scn_phase_space_process - INFO -   神经元数量: 43
2025-05-24 15:22:10,422 - scn_phase_space_process - INFO -   数据形状: (2999, 43)
2025-05-24 15:22:10,422 - scn_phase_space_process - INFO -   时间戳范围: 1 - 2999
2025-05-24 15:22:10,422 - scn_phase_space_process - INFO -   神经元ID: ['n1', 'n2', 'n3', 'n4', 'n5', '...']
2025-05-24 15:22:10,423 - scn_phase_space_process - INFO -   缺失值数量: 0
2025-05-24 15:22:10,424 - scn_phase_space_process - INFO -   数据范围: -1.358 - 4.895
2025-05-24 15:22:10,424 - scn_phase_space_process - INFO -   数据均值: -0.000
2025-05-24 15:22:10,425 - scn_phase_space_process - INFO -   数据标准差: 0.578
2025-05-24 15:22:10,425 - scn_phase_space_process - INFO -   数据格式: Excel
2025-05-24 15:22:10,426 - scn_phase_space_process - INFO -   处理器: ExcelCalciumDataProcessor
2025-05-24 15:22:10,426 - scn_phase_space_process - INFO - 
步骤2: 相空间重构
2025-05-24 15:22:10,426 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 15:22:10,426 - scn_phase_space_process - INFO - 数据维度: 10 个细胞, 10 个时间线
2025-05-24 15:22:10,426 - scn_phase_space_process - INFO - 开始处理钙信号数据...
2025-05-24 15:22:14,924 - scn_phase_space_process - INFO - ✓ 相空间重构完成
2025-05-24 15:22:14,924 - scn_phase_space_process - INFO - 
步骤3: 数据裁剪
2025-05-24 15:22:14,924 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 15:22:14,925 - scn_phase_space_process - INFO - 开始裁剪数据到统一长度: 170
2025-05-24 15:22:14,926 - scn_phase_space_process - INFO - ✓ 数据裁剪完成
2025-05-24 15:22:14,926 - scn_phase_space_process - INFO - 
步骤4: 构建图数据集
2025-05-24 15:22:14,926 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 15:22:14,926 - scn_phase_space_process - INFO - 有效样本数量: 100
2025-05-24 15:22:14,927 - scn_phase_space_process - INFO - 生成 nodes.csv 文件...
2025-05-24 15:22:14,927 - scn_phase_space_process - INFO - 转换节点特征格式...
2025-05-24 15:22:15,002 - scn_phase_space_process - INFO - ✓ nodes.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\nodes.csv
2025-05-24 15:22:15,002 - scn_phase_space_process - INFO - 生成 edges.csv 文件...
2025-05-24 15:22:15,015 - scn_phase_space_process - INFO - ✓ edges.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\edges.csv
2025-05-24 15:22:15,016 - scn_phase_space_process - INFO - 生成 graphs.csv 文件...
2025-05-24 15:22:15,017 - scn_phase_space_process - INFO - 使用内置的改进标签生成方法...
2025-05-24 15:22:15,221 - scn_phase_space_process - INFO - 使用内置的改进标签生成方法...
2025-05-24 15:22:15,221 - scn_phase_space_process - INFO - 处理 100 个有效样本
2025-05-24 15:22:15,269 - scn_phase_space_process - INFO - 特征矩阵形状: (100, 14)
2025-05-24 15:22:15,270 - scn_phase_space_process - INFO - PCA降维: 14 -> 8
2025-05-24 15:22:15,419 - scn_phase_space_process - INFO - 聚类质量 - 轮廓系数: 0.224
2025-05-24 15:22:15,420 - scn_phase_space_process - INFO - 改进标签分布: {np.int32(0): np.int64(21), np.int32(1): np.int64(28), np.int32(2): np.int64(13), np.int32(3): np.int64(13), np.int32(4): np.int64(9), np.int32(5): np.int64(16)}
2025-05-24 15:22:15,421 - scn_phase_space_process - INFO - 最终标签分布: {np.int32(0): np.int64(21), np.int32(1): np.int64(28), np.int32(2): np.int64(13), np.int32(3): np.int64(13), np.int32(4): np.int64(9), np.int32(5): np.int64(16)}
2025-05-24 15:22:15,422 - scn_phase_space_process - INFO - ✓ graphs.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\graphs.csv
2025-05-24 15:22:15,423 - scn_phase_space_process - INFO - 
============================================================
2025-05-24 15:22:15,424 - scn_phase_space_process - INFO - 数据处理流程全部完成!
2025-05-24 15:22:15,424 - scn_phase_space_process - INFO - ============================================================
2025-05-24 15:22:15,424 - scn_phase_space_process - INFO - 数据源信息:
2025-05-24 15:22:15,425 - scn_phase_space_process - INFO -   - 文件: datasets/EMtrace01.xlsx
2025-05-24 15:22:15,425 - scn_phase_space_process - INFO -   - 格式: Excel
2025-05-24 15:22:15,426 - scn_phase_space_process - INFO -   - 处理器: ExcelCalciumDataProcessor
2025-05-24 15:22:15,426 - scn_phase_space_process - INFO - 
生成的文件:
2025-05-24 15:22:15,426 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/nodes.csv
2025-05-24 15:22:15,427 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/edges.csv
2025-05-24 15:22:15,427 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/graphs.csv
2025-05-24 15:22:15,428 - scn_phase_space_process - INFO - 
处理结果:
2025-05-24 15:22:15,428 - scn_phase_space_process - INFO -   - 总样本数量: 100
2025-05-24 15:22:15,428 - scn_phase_space_process - INFO -   - 轨迹长度: 170
2025-05-24 15:22:15,428 - scn_phase_space_process - INFO -   - 嵌入维度: 3
2025-05-24 15:22:15,430 - scn_phase_space_process - INFO - 
下一步操作:
2025-05-24 15:22:15,430 - scn_phase_space_process - INFO -   1. 检查生成的CSV文件质量
2025-05-24 15:22:15,430 - scn_phase_space_process - INFO -   2. 运行训练: python main.py 或 python run.py --train
2025-05-24 15:22:15,431 - scn_phase_space_process - INFO -   3. 查看训练结果: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results
2025-05-24 15:22:15,431 - __main__ - INFO - ✓ 数据处理完成
2025-05-24 15:22:15,431 - __main__ - INFO - 操作成功完成
2025-05-24 15:23:36,297 - __main__ - INFO - ============================================================
2025-05-24 15:23:36,297 - __main__ - INFO - 开始模型训练流程
2025-05-24 15:23:36,297 - __main__ - INFO - ============================================================
2025-05-24 15:23:42,422 - main - INFO - ================================================================================
2025-05-24 15:23:42,422 - main - INFO - 🧠 脑网络状态分类器 - 先进版本
2025-05-24 15:23:42,422 - main - INFO - ================================================================================
2025-05-24 15:23:42,422 - main - INFO - 使用设备: cuda
2025-05-24 15:23:42,422 - main - INFO - 📊 加载数据集...
2025-05-24 15:23:42,480 - main - INFO - 数据集加载完成 - 训练集: 60, 验证集: 20, 测试集: 20
2025-05-24 15:23:42,480 - main - INFO - 🏗️  创建先进模型...
2025-05-24 15:23:42,531 - main - INFO - 创建改进模型，参数总数: 790726
2025-05-24 15:23:42,531 - main - INFO - 使用MultiLayerGCN + 先进训练技术的组合
2025-05-24 15:23:42,628 - main - INFO - ✓ 早停机制已启用 - 耐心值: 50, 最小改进: 0.001
2025-05-24 15:23:42,628 - main - INFO - 🚀 开始训练...
2025-05-24 15:23:42,628 - main - INFO - 🚀 开始先进训练流程...
2025-05-24 15:23:43,850 - main - INFO - Epoch   0 | Train Loss: 2.2577 | Train Acc: 0.3333 | Val Loss: 2.4685 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-24 15:23:44,528 - main - INFO - Epoch   1 | Train Loss: 2.1624 | Train Acc: 0.3167 | Val Loss: 1.7692 | Val Acc: 0.3000 | Val Balanced Acc: 0.2000 | LR: 0.001000
2025-05-24 15:23:45,233 - main - INFO - Epoch   2 | Train Loss: 2.0673 | Train Acc: 0.1500 | Val Loss: 1.6399 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-24 15:23:45,881 - main - INFO - Epoch   3 | Train Loss: 1.9455 | Train Acc: 0.2500 | Val Loss: 1.5038 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-24 15:23:46,513 - main - INFO - Epoch   4 | Train Loss: 1.9525 | Train Acc: 0.2167 | Val Loss: 1.4696 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-24 15:23:47,140 - main - INFO - Epoch   5 | Train Loss: 1.8219 | Train Acc: 0.2333 | Val Loss: 1.4918 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-24 15:23:47,779 - main - INFO - Epoch   6 | Train Loss: 1.7910 | Train Acc: 0.2167 | Val Loss: 1.4747 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-24 15:23:48,409 - main - INFO - Epoch   7 | Train Loss: 1.6449 | Train Acc: 0.2833 | Val Loss: 1.3665 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-24 15:23:49,046 - main - INFO - Epoch   8 | Train Loss: 1.8075 | Train Acc: 0.1667 | Val Loss: 1.3758 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-24 15:23:49,649 - main - INFO - Epoch   9 | Train Loss: 1.5630 | Train Acc: 0.2667 | Val Loss: 1.4257 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-24 15:23:50,226 - main - INFO - Epoch  10 | Train Loss: 1.7188 | Train Acc: 0.2167 | Val Loss: 1.3183 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-24 15:23:56,494 - main - INFO - Epoch  20 | Train Loss: 1.3104 | Train Acc: 0.2333 | Val Loss: 1.4296 | Val Acc: 0.2500 | Val Balanced Acc: 0.1667 | LR: 0.001000
2025-05-24 15:24:03,264 - main - INFO - Epoch  30 | Train Loss: 1.0135 | Train Acc: 0.4167 | Val Loss: 1.3397 | Val Acc: 0.2000 | Val Balanced Acc: 0.1333 | LR: 0.001000
2025-05-24 15:24:10,458 - main - INFO - Epoch  40 | Train Loss: 0.9484 | Train Acc: 0.3667 | Val Loss: 1.5114 | Val Acc: 0.2000 | Val Balanced Acc: 0.1333 | LR: 0.000500
2025-05-24 15:24:16,960 - main - INFO - Epoch  50 | Train Loss: 0.8496 | Train Acc: 0.4000 | Val Loss: 2.1608 | Val Acc: 0.2000 | Val Balanced Acc: 0.1333 | LR: 0.000500
2025-05-24 15:24:22,906 - main - INFO - Epoch  60 | Train Loss: 0.7610 | Train Acc: 0.5167 | Val Loss: 3.0739 | Val Acc: 0.1000 | Val Balanced Acc: 0.0667 | LR: 0.000250
2025-05-24 15:24:28,694 - main - INFO - Epoch  70 | Train Loss: 0.6306 | Train Acc: 0.6667 | Val Loss: 2.6624 | Val Acc: 0.1000 | Val Balanced Acc: 0.0889 | LR: 0.000125
2025-05-24 15:24:29,401 - main - INFO - 早停触发，停止训练。最佳验证准确率: 0.3000
2025-05-24 15:24:29,402 - main - INFO - 恢复最佳模型，验证准确率: 0.3000
2025-05-24 15:24:29,402 - main - INFO - 🔍 测试最终性能...
2025-05-24 15:24:29,501 - main - INFO - ============================================================
2025-05-24 15:24:29,502 - main - INFO - 📊 最终结果:
2025-05-24 15:24:29,502 - main - INFO - 测试准确率: 0.2500
2025-05-24 15:24:29,502 - main - INFO - 平衡准确率: 0.2333
2025-05-24 15:24:29,502 - main - INFO - 测试损失: 3.0464
2025-05-24 15:24:29,503 - main - INFO - ============================================================
2025-05-24 15:24:29,512 - main - INFO - ✅ 模型和结果已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results\advanced_brain_classifier.pth
2025-05-24 15:24:29,512 - main - INFO - 📁 结果目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results
2025-05-24 15:24:29,513 - __main__ - INFO - ✓ 模型训练完成
2025-05-24 15:24:29,513 - __main__ - INFO - 最终测试准确率: 0.2500
2025-05-24 15:24:29,513 - __main__ - INFO - 操作成功完成
2025-05-24 15:29:13,363 - __main__ - INFO - ============================================================
2025-05-24 15:29:13,363 - __main__ - INFO - 开始数据处理流程
2025-05-24 15:29:13,363 - __main__ - INFO - ============================================================
2025-05-24 15:29:14,365 - scn_phase_space_process - INFO - ============================================================
2025-05-24 15:29:14,365 - scn_phase_space_process - INFO - 3D SCN数据处理流程 - Python版本
2025-05-24 15:29:14,365 - scn_phase_space_process - INFO - 增强版本：支持Excel和MAT格式
2025-05-24 15:29:14,366 - scn_phase_space_process - INFO - ============================================================
2025-05-24 15:29:14,367 - scn_phase_space_process - INFO - 输出目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets
2025-05-24 15:29:14,367 - scn_phase_space_process - INFO - 
步骤1: 智能数据加载
2025-05-24 15:29:14,367 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 15:29:14,367 - scn_phase_space_process - INFO - 正在检测和加载数据文件: datasets/EMtrace01.xlsx
2025-05-24 15:29:14,367 - scn_phase_space_process - INFO - 检测到文件格式: excel
2025-05-24 15:29:14,368 - scn_phase_space_process - INFO - 使用Excel数据处理器加载钙离子数据...
2025-05-24 15:29:14,368 - excel_data_processor - INFO - 正在加载Excel数据文件: datasets\EMtrace01.xlsx
2025-05-24 15:29:15,314 - excel_data_processor - INFO - ✓ 成功加载数据: 2999 个时间点, 43 个神经元
2025-05-24 15:29:15,314 - excel_data_processor - INFO - 神经元列: ['n1', 'n2', 'n3', 'n4', 'n5', 'n6', 'n7', 'n8', 'n9', 'n10']...
2025-05-24 15:29:15,314 - excel_data_processor - INFO - 开始预处理钙离子数据...
2025-05-24 15:29:15,318 - excel_data_processor - WARNING - 检测并处理了 247 个异常值
2025-05-24 15:29:15,319 - excel_data_processor - INFO - 执行Z-score标准化...
2025-05-24 15:29:15,321 - excel_data_processor - INFO - ✓ 数据预处理完成: (2999, 43) -> (2999, 43)
2025-05-24 15:29:15,322 - excel_data_processor - INFO - 转换数据为SCN处理格式...
2025-05-24 15:29:15,322 - excel_data_processor - INFO - 分段参数: 段长度=340, 步长=170
2025-05-24 15:29:15,322 - excel_data_processor - INFO - ✓ 转换完成: 10 个神经元, 平均每个神经元 10.0 个时间段
2025-05-24 15:29:15,324 - scn_phase_space_process - INFO - 数据加载信息:
2025-05-24 15:29:15,324 - scn_phase_space_process - INFO -   文件路径: datasets\EMtrace01.xlsx
2025-05-24 15:29:15,325 - scn_phase_space_process - INFO -   时间点数量: 2999
2025-05-24 15:29:15,325 - scn_phase_space_process - INFO -   神经元数量: 43
2025-05-24 15:29:15,325 - scn_phase_space_process - INFO -   数据形状: (2999, 43)
2025-05-24 15:29:15,326 - scn_phase_space_process - INFO -   时间戳范围: 1 - 2999
2025-05-24 15:29:15,326 - scn_phase_space_process - INFO -   神经元ID: ['n1', 'n2', 'n3', 'n4', 'n5', '...']
2025-05-24 15:29:15,326 - scn_phase_space_process - INFO -   缺失值数量: 0
2025-05-24 15:29:15,326 - scn_phase_space_process - INFO -   数据范围: -1.358 - 4.895
2025-05-24 15:29:15,327 - scn_phase_space_process - INFO -   数据均值: -0.000
2025-05-24 15:29:15,327 - scn_phase_space_process - INFO -   数据标准差: 0.578
2025-05-24 15:29:15,328 - scn_phase_space_process - INFO -   数据格式: Excel
2025-05-24 15:29:15,328 - scn_phase_space_process - INFO -   处理器: ExcelCalciumDataProcessor
2025-05-24 15:29:15,328 - scn_phase_space_process - INFO - 
步骤2: 相空间重构
2025-05-24 15:29:15,328 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 15:29:15,328 - scn_phase_space_process - INFO - 数据维度: 10 个细胞, 10 个时间线
2025-05-24 15:29:15,328 - scn_phase_space_process - INFO - 开始处理钙信号数据...
2025-05-24 15:29:19,917 - scn_phase_space_process - INFO - ✓ 相空间重构完成
2025-05-24 15:29:19,917 - scn_phase_space_process - INFO - 
步骤3: 数据裁剪
2025-05-24 15:29:19,917 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 15:29:19,918 - scn_phase_space_process - INFO - 开始裁剪数据到统一长度: 170
2025-05-24 15:29:19,918 - scn_phase_space_process - INFO - ✓ 数据裁剪完成
2025-05-24 15:29:19,918 - scn_phase_space_process - INFO - 
步骤4: 构建图数据集
2025-05-24 15:29:19,919 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 15:29:19,919 - scn_phase_space_process - INFO - 有效样本数量: 100
2025-05-24 15:29:19,919 - scn_phase_space_process - INFO - 生成 nodes.csv 文件...
2025-05-24 15:29:19,920 - scn_phase_space_process - INFO - 转换节点特征格式...
2025-05-24 15:29:19,991 - scn_phase_space_process - INFO - ✓ nodes.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\nodes.csv
2025-05-24 15:29:19,992 - scn_phase_space_process - INFO - 生成 edges.csv 文件...
2025-05-24 15:29:20,005 - scn_phase_space_process - INFO - ✓ edges.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\edges.csv
2025-05-24 15:29:20,005 - scn_phase_space_process - INFO - 生成 graphs.csv 文件...
2025-05-24 15:29:20,006 - scn_phase_space_process - INFO - 使用内置的改进标签生成方法...
2025-05-24 15:29:20,200 - scn_phase_space_process - INFO - 使用内置的改进标签生成方法...
2025-05-24 15:29:20,201 - scn_phase_space_process - INFO - 处理 100 个有效样本
2025-05-24 15:29:20,249 - scn_phase_space_process - INFO - 特征矩阵形状: (100, 14)
2025-05-24 15:29:20,251 - scn_phase_space_process - INFO - PCA降维: 14 -> 8
2025-05-24 15:29:20,404 - scn_phase_space_process - INFO - 聚类质量 - 轮廓系数: 0.237
2025-05-24 15:29:20,404 - scn_phase_space_process - INFO - 改进标签分布: {np.int32(0): np.int64(18), np.int32(1): np.int64(24), np.int32(2): np.int64(32), np.int32(3): np.int64(26)}
2025-05-24 15:29:20,406 - scn_phase_space_process - INFO - 最终标签分布: {np.int32(0): np.int64(18), np.int32(1): np.int64(24), np.int32(2): np.int64(32), np.int32(3): np.int64(26)}
2025-05-24 15:29:20,407 - scn_phase_space_process - INFO - ✓ graphs.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\graphs.csv
2025-05-24 15:29:20,407 - scn_phase_space_process - INFO - 
============================================================
2025-05-24 15:29:20,408 - scn_phase_space_process - INFO - 数据处理流程全部完成!
2025-05-24 15:29:20,409 - scn_phase_space_process - INFO - ============================================================
2025-05-24 15:29:20,409 - scn_phase_space_process - INFO - 数据源信息:
2025-05-24 15:29:20,410 - scn_phase_space_process - INFO -   - 文件: datasets/EMtrace01.xlsx
2025-05-24 15:29:20,410 - scn_phase_space_process - INFO -   - 格式: Excel
2025-05-24 15:29:20,410 - scn_phase_space_process - INFO -   - 处理器: ExcelCalciumDataProcessor
2025-05-24 15:29:20,411 - scn_phase_space_process - INFO - 
生成的文件:
2025-05-24 15:29:20,411 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/nodes.csv
2025-05-24 15:29:20,412 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/edges.csv
2025-05-24 15:29:20,412 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/graphs.csv
2025-05-24 15:29:20,412 - scn_phase_space_process - INFO - 
处理结果:
2025-05-24 15:29:20,413 - scn_phase_space_process - INFO -   - 总样本数量: 100
2025-05-24 15:29:20,413 - scn_phase_space_process - INFO -   - 轨迹长度: 170
2025-05-24 15:29:20,413 - scn_phase_space_process - INFO -   - 嵌入维度: 3
2025-05-24 15:29:20,414 - scn_phase_space_process - INFO - 
下一步操作:
2025-05-24 15:29:20,414 - scn_phase_space_process - INFO -   1. 检查生成的CSV文件质量
2025-05-24 15:29:20,414 - scn_phase_space_process - INFO -   2. 运行训练: python main.py 或 python run.py --train
2025-05-24 15:29:20,415 - scn_phase_space_process - INFO -   3. 查看训练结果: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results
2025-05-24 15:29:20,415 - __main__ - INFO - ✓ 数据处理完成
2025-05-24 15:29:20,416 - __main__ - INFO - 操作成功完成
2025-05-24 15:29:50,251 - __main__ - INFO - ============================================================
2025-05-24 15:29:50,251 - __main__ - INFO - 开始模型训练流程
2025-05-24 15:29:50,251 - __main__ - INFO - ============================================================
2025-05-24 15:29:54,704 - main - INFO - ================================================================================
2025-05-24 15:29:54,704 - main - INFO - 🧠 脑网络状态分类器 - 先进版本
2025-05-24 15:29:54,704 - main - INFO - ================================================================================
2025-05-24 15:29:54,704 - main - INFO - 使用设备: cuda
2025-05-24 15:29:54,704 - main - INFO - 📊 加载数据集...
2025-05-24 15:29:54,759 - main - INFO - 数据集加载完成 - 训练集: 60, 验证集: 20, 测试集: 20
2025-05-24 15:29:54,759 - main - INFO - 🏗️  创建先进模型...
2025-05-24 15:29:54,801 - main - INFO - 创建改进模型，参数总数: 790468
2025-05-24 15:29:54,801 - main - INFO - 使用MultiLayerGCN + 先进训练技术的组合
2025-05-24 15:29:54,888 - main - INFO - ✓ 早停机制已启用 - 耐心值: 50, 最小改进: 0.001
2025-05-24 15:29:54,888 - main - INFO - 🚀 开始训练...
2025-05-24 15:29:54,888 - main - INFO - 🚀 开始先进训练流程...
2025-05-24 15:29:55,781 - main - INFO - Epoch   0 | Train Loss: 1.9232 | Train Acc: 0.2833 | Val Loss: 0.5968 | Val Acc: 0.5000 | Val Balanced Acc: 0.3869 | LR: 0.001000
2025-05-24 15:29:56,424 - main - INFO - Epoch   1 | Train Loss: 2.0746 | Train Acc: 0.2000 | Val Loss: 1.6001 | Val Acc: 0.3000 | Val Balanced Acc: 0.2500 | LR: 0.001000
2025-05-24 15:29:57,086 - main - INFO - Epoch   2 | Train Loss: 1.4499 | Train Acc: 0.3000 | Val Loss: 1.0577 | Val Acc: 0.3000 | Val Balanced Acc: 0.2500 | LR: 0.001000
2025-05-24 15:29:57,716 - main - INFO - Epoch   3 | Train Loss: 1.3557 | Train Acc: 0.2167 | Val Loss: 1.0962 | Val Acc: 0.3000 | Val Balanced Acc: 0.2500 | LR: 0.001000
2025-05-24 15:29:58,368 - main - INFO - Epoch   4 | Train Loss: 1.3448 | Train Acc: 0.2000 | Val Loss: 1.0240 | Val Acc: 0.3000 | Val Balanced Acc: 0.2500 | LR: 0.001000
2025-05-24 15:29:59,011 - main - INFO - Epoch   5 | Train Loss: 1.3435 | Train Acc: 0.2833 | Val Loss: 0.8745 | Val Acc: 0.3500 | Val Balanced Acc: 0.2679 | LR: 0.001000
2025-05-24 15:29:59,636 - main - INFO - Epoch   6 | Train Loss: 1.4154 | Train Acc: 0.2833 | Val Loss: 1.0162 | Val Acc: 0.0500 | Val Balanced Acc: 0.2500 | LR: 0.001000
2025-05-24 15:30:00,281 - main - INFO - Epoch   7 | Train Loss: 1.0429 | Train Acc: 0.2500 | Val Loss: 0.9687 | Val Acc: 0.3000 | Val Balanced Acc: 0.2500 | LR: 0.001000
2025-05-24 15:30:00,931 - main - INFO - Epoch   8 | Train Loss: 1.1720 | Train Acc: 0.3333 | Val Loss: 0.7469 | Val Acc: 0.3000 | Val Balanced Acc: 0.2500 | LR: 0.001000
2025-05-24 15:30:01,601 - main - INFO - Epoch   9 | Train Loss: 1.3560 | Train Acc: 0.1667 | Val Loss: 0.7915 | Val Acc: 0.3000 | Val Balanced Acc: 0.2500 | LR: 0.001000
2025-05-24 15:30:02,225 - main - INFO - Epoch  10 | Train Loss: 1.0276 | Train Acc: 0.2333 | Val Loss: 1.0365 | Val Acc: 0.3000 | Val Balanced Acc: 0.2500 | LR: 0.001000
2025-05-24 15:30:08,622 - main - INFO - Epoch  20 | Train Loss: 0.9865 | Train Acc: 0.4167 | Val Loss: 0.7561 | Val Acc: 0.2500 | Val Balanced Acc: 0.2083 | LR: 0.000500
2025-05-24 15:30:15,113 - main - INFO - Epoch  30 | Train Loss: 0.7604 | Train Acc: 0.4167 | Val Loss: 0.8404 | Val Acc: 0.4500 | Val Balanced Acc: 0.3512 | LR: 0.000500
2025-05-24 15:30:21,592 - main - INFO - Epoch  40 | Train Loss: 0.6225 | Train Acc: 0.5833 | Val Loss: 1.5407 | Val Acc: 0.5000 | Val Balanced Acc: 0.6071 | LR: 0.000250
2025-05-24 15:30:28,411 - main - INFO - Epoch  50 | Train Loss: 1.0976 | Train Acc: 0.5500 | Val Loss: 1.9946 | Val Acc: 0.4000 | Val Balanced Acc: 0.5238 | LR: 0.000250
2025-05-24 15:30:35,046 - main - INFO - Epoch  60 | Train Loss: 0.3215 | Train Acc: 0.8167 | Val Loss: 2.5347 | Val Acc: 0.3500 | Val Balanced Acc: 0.2738 | LR: 0.000125
2025-05-24 15:30:41,344 - main - INFO - Epoch  70 | Train Loss: 0.2860 | Train Acc: 0.8667 | Val Loss: 2.5767 | Val Acc: 0.3500 | Val Balanced Acc: 0.2798 | LR: 0.000125
2025-05-24 15:30:43,257 - main - INFO - 早停触发，停止训练。最佳验证准确率: 0.5000
2025-05-24 15:30:43,258 - main - INFO - 恢复最佳模型，验证准确率: 0.5000
2025-05-24 15:30:43,258 - main - INFO - 🔍 测试最终性能...
2025-05-24 15:30:43,357 - main - INFO - ============================================================
2025-05-24 15:30:43,357 - main - INFO - 📊 最终结果:
2025-05-24 15:30:43,358 - main - INFO - 测试准确率: 0.3500
2025-05-24 15:30:43,358 - main - INFO - 平衡准确率: 0.3500
2025-05-24 15:30:43,358 - main - INFO - 测试损失: 2.5159
2025-05-24 15:30:43,358 - main - INFO - ============================================================
2025-05-24 15:30:43,368 - main - INFO - ✅ 模型和结果已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results\advanced_brain_classifier.pth
2025-05-24 15:30:43,368 - main - INFO - 📁 结果目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results
2025-05-24 15:30:43,368 - __main__ - INFO - ✓ 模型训练完成
2025-05-24 15:30:43,369 - __main__ - INFO - 最终测试准确率: 0.3500
2025-05-24 15:30:43,369 - __main__ - INFO - 操作成功完成
2025-05-24 15:38:22,343 - __main__ - INFO - ============================================================
2025-05-24 15:38:22,343 - __main__ - INFO - 开始数据处理流程
2025-05-24 15:38:22,344 - __main__ - INFO - ============================================================
2025-05-24 15:38:23,432 - scn_phase_space_process - INFO - ============================================================
2025-05-24 15:38:23,433 - scn_phase_space_process - INFO - 3D SCN数据处理流程 - Python版本
2025-05-24 15:38:23,433 - scn_phase_space_process - INFO - 增强版本：支持Excel和MAT格式
2025-05-24 15:38:23,433 - scn_phase_space_process - INFO - ============================================================
2025-05-24 15:38:23,433 - scn_phase_space_process - INFO - 输出目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets
2025-05-24 15:38:23,434 - scn_phase_space_process - INFO - 
步骤1: 智能数据加载
2025-05-24 15:38:23,434 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 15:38:23,434 - scn_phase_space_process - INFO - 正在检测和加载数据文件: datasets/EMtrace01.xlsx
2025-05-24 15:38:23,434 - scn_phase_space_process - INFO - 检测到文件格式: excel
2025-05-24 15:38:23,434 - scn_phase_space_process - INFO - 使用Excel数据处理器加载钙离子数据...
2025-05-24 15:38:23,435 - excel_data_processor - INFO - 正在加载Excel数据文件: datasets\EMtrace01.xlsx
2025-05-24 15:38:24,360 - excel_data_processor - INFO - ✓ 成功加载数据: 2999 个时间点, 43 个神经元
2025-05-24 15:38:24,360 - excel_data_processor - INFO - 神经元列: ['n1', 'n2', 'n3', 'n4', 'n5', 'n6', 'n7', 'n8', 'n9', 'n10']...
2025-05-24 15:38:24,360 - excel_data_processor - INFO - 开始预处理钙离子数据...
2025-05-24 15:38:24,365 - excel_data_processor - WARNING - 检测并处理了 247 个异常值
2025-05-24 15:38:24,365 - excel_data_processor - INFO - 执行Z-score标准化...
2025-05-24 15:38:24,369 - excel_data_processor - INFO - ✓ 数据预处理完成: (2999, 43) -> (2999, 43)
2025-05-24 15:38:24,369 - excel_data_processor - INFO - 转换数据为SCN处理格式...
2025-05-24 15:38:24,369 - excel_data_processor - INFO - 分段参数: 段长度=340, 步长=170
2025-05-24 15:38:24,370 - excel_data_processor - INFO - ✓ 转换完成: 10 个神经元, 平均每个神经元 10.0 个时间段
2025-05-24 15:38:24,372 - scn_phase_space_process - INFO - 数据加载信息:
2025-05-24 15:38:24,372 - scn_phase_space_process - INFO -   文件路径: datasets\EMtrace01.xlsx
2025-05-24 15:38:24,372 - scn_phase_space_process - INFO -   时间点数量: 2999
2025-05-24 15:38:24,372 - scn_phase_space_process - INFO -   神经元数量: 43
2025-05-24 15:38:24,372 - scn_phase_space_process - INFO -   数据形状: (2999, 43)
2025-05-24 15:38:24,372 - scn_phase_space_process - INFO -   时间戳范围: 1 - 2999
2025-05-24 15:38:24,373 - scn_phase_space_process - INFO -   神经元ID: ['n1', 'n2', 'n3', 'n4', 'n5', '...']
2025-05-24 15:38:24,373 - scn_phase_space_process - INFO -   缺失值数量: 0
2025-05-24 15:38:24,373 - scn_phase_space_process - INFO -   数据范围: -1.358 - 4.895
2025-05-24 15:38:24,374 - scn_phase_space_process - INFO -   数据均值: -0.000
2025-05-24 15:38:24,374 - scn_phase_space_process - INFO -   数据标准差: 0.578
2025-05-24 15:38:24,374 - scn_phase_space_process - INFO -   数据格式: Excel
2025-05-24 15:38:24,374 - scn_phase_space_process - INFO -   处理器: ExcelCalciumDataProcessor
2025-05-24 15:38:24,374 - scn_phase_space_process - INFO - 
步骤2: 相空间重构
2025-05-24 15:38:24,374 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 15:38:24,375 - scn_phase_space_process - INFO - 数据维度: 10 个细胞, 10 个时间线
2025-05-24 15:38:24,375 - scn_phase_space_process - INFO - 开始处理钙信号数据...
2025-05-24 15:38:28,947 - scn_phase_space_process - INFO - ✓ 相空间重构完成
2025-05-24 15:38:28,947 - scn_phase_space_process - INFO - 
步骤3: 数据裁剪
2025-05-24 15:38:28,948 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 15:38:28,948 - scn_phase_space_process - INFO - 开始裁剪数据到统一长度: 170
2025-05-24 15:38:28,948 - scn_phase_space_process - INFO - ✓ 数据裁剪完成
2025-05-24 15:38:28,948 - scn_phase_space_process - INFO - 
步骤4: 构建图数据集
2025-05-24 15:38:28,948 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 15:38:28,949 - scn_phase_space_process - INFO - 有效样本数量: 100
2025-05-24 15:38:28,949 - scn_phase_space_process - INFO - 生成 nodes.csv 文件...
2025-05-24 15:38:28,949 - scn_phase_space_process - INFO - 转换节点特征格式...
2025-05-24 15:38:29,026 - scn_phase_space_process - INFO - ✓ nodes.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\nodes.csv
2025-05-24 15:38:29,027 - scn_phase_space_process - INFO - 生成 edges.csv 文件...
2025-05-24 15:38:29,039 - scn_phase_space_process - INFO - ✓ edges.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\edges.csv
2025-05-24 15:38:29,040 - scn_phase_space_process - INFO - 生成 graphs.csv 文件...
2025-05-24 15:38:29,040 - scn_phase_space_process - INFO - 使用内置的改进标签生成方法...
2025-05-24 15:38:29,235 - scn_phase_space_process - INFO - 使用内置的改进标签生成方法...
2025-05-24 15:38:29,235 - scn_phase_space_process - INFO - 处理 100 个有效样本
2025-05-24 15:38:29,289 - scn_phase_space_process - INFO - 特征矩阵形状: (100, 14)
2025-05-24 15:38:29,291 - scn_phase_space_process - INFO - PCA降维: 14 -> 8
2025-05-24 15:38:29,559 - scn_phase_space_process - INFO - 聚类质量 - 轮廓系数: 0.237
2025-05-24 15:38:29,559 - scn_phase_space_process - INFO - 改进标签分布: {np.int32(0): np.int64(18), np.int32(1): np.int64(24), np.int32(2): np.int64(32), np.int32(3): np.int64(26)}
2025-05-24 15:38:29,560 - scn_phase_space_process - INFO - 最终标签分布: {np.int32(0): np.int64(18), np.int32(1): np.int64(24), np.int32(2): np.int64(32), np.int32(3): np.int64(26)}
2025-05-24 15:38:29,562 - scn_phase_space_process - INFO - ✓ graphs.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\graphs.csv
2025-05-24 15:38:29,563 - scn_phase_space_process - INFO - 
============================================================
2025-05-24 15:38:29,563 - scn_phase_space_process - INFO - 数据处理流程全部完成!
2025-05-24 15:38:29,563 - scn_phase_space_process - INFO - ============================================================
2025-05-24 15:38:29,564 - scn_phase_space_process - INFO - 数据源信息:
2025-05-24 15:38:29,564 - scn_phase_space_process - INFO -   - 文件: datasets/EMtrace01.xlsx
2025-05-24 15:38:29,564 - scn_phase_space_process - INFO -   - 格式: Excel
2025-05-24 15:38:29,564 - scn_phase_space_process - INFO -   - 处理器: ExcelCalciumDataProcessor
2025-05-24 15:38:29,565 - scn_phase_space_process - INFO - 
生成的文件:
2025-05-24 15:38:29,565 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/nodes.csv
2025-05-24 15:38:29,565 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/edges.csv
2025-05-24 15:38:29,565 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/graphs.csv
2025-05-24 15:38:29,566 - scn_phase_space_process - INFO - 
处理结果:
2025-05-24 15:38:29,568 - scn_phase_space_process - INFO -   - 总样本数量: 100
2025-05-24 15:38:29,569 - scn_phase_space_process - INFO -   - 轨迹长度: 170
2025-05-24 15:38:29,569 - scn_phase_space_process - INFO -   - 嵌入维度: 3
2025-05-24 15:38:29,570 - scn_phase_space_process - INFO - 
下一步操作:
2025-05-24 15:38:29,570 - scn_phase_space_process - INFO -   1. 检查生成的CSV文件质量
2025-05-24 15:38:29,570 - scn_phase_space_process - INFO -   2. 运行训练: python main.py 或 python run.py --train
2025-05-24 15:38:29,571 - scn_phase_space_process - INFO -   3. 查看训练结果: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results
2025-05-24 15:38:29,571 - __main__ - INFO - ✓ 数据处理完成
2025-05-24 15:38:29,571 - __main__ - INFO - 操作成功完成
2025-05-24 15:38:32,680 - __main__ - INFO - ============================================================
2025-05-24 15:38:32,680 - __main__ - INFO - 开始模型训练流程
2025-05-24 15:38:32,680 - __main__ - INFO - ============================================================
2025-05-24 15:38:36,796 - main - INFO - ================================================================================
2025-05-24 15:38:36,797 - main - INFO - 🧠 脑网络状态分类器 - 先进版本
2025-05-24 15:38:36,797 - main - INFO - ================================================================================
2025-05-24 15:38:36,797 - main - INFO - 使用设备: cuda
2025-05-24 15:38:36,797 - main - INFO - 📊 加载数据集...
2025-05-24 15:38:36,850 - main - INFO - 数据集加载完成 - 训练集: 60, 验证集: 20, 测试集: 20
2025-05-24 15:38:36,851 - main - INFO - 🏗️  创建先进模型...
2025-05-24 15:38:36,893 - main - INFO - 创建改进模型，参数总数: 790468
2025-05-24 15:38:36,893 - main - INFO - 使用MultiLayerGCN + 先进训练技术的组合
2025-05-24 15:38:37,021 - main - INFO - ✓ 早停机制已启用 - 耐心值: 50, 最小改进: 0.001
2025-05-24 15:38:37,021 - main - INFO - 🚀 开始训练...
2025-05-24 15:38:37,021 - main - INFO - 🚀 开始先进训练流程...
2025-05-24 15:38:37,965 - main - INFO - Epoch   0 | Train Loss: 2.4864 | Train Acc: 0.2333 | Val Loss: 1.6070 | Val Acc: 0.3500 | Val Balanced Acc: 0.2500 | LR: 0.005000
2025-05-24 15:38:38,610 - main - INFO - Epoch   1 | Train Loss: 1.5703 | Train Acc: 0.3000 | Val Loss: 1.2012 | Val Acc: 0.3000 | Val Balanced Acc: 0.2500 | LR: 0.005000
2025-05-24 15:38:39,245 - main - INFO - Epoch   2 | Train Loss: 1.4043 | Train Acc: 0.3500 | Val Loss: 1.1261 | Val Acc: 0.3500 | Val Balanced Acc: 0.2500 | LR: 0.005000
2025-05-24 15:38:39,859 - main - INFO - Epoch   3 | Train Loss: 1.2897 | Train Acc: 0.2333 | Val Loss: 1.1683 | Val Acc: 0.3000 | Val Balanced Acc: 0.2500 | LR: 0.005000
2025-05-24 15:38:40,513 - main - INFO - Epoch   4 | Train Loss: 1.1108 | Train Acc: 0.2667 | Val Loss: 1.6842 | Val Acc: 0.3000 | Val Balanced Acc: 0.2500 | LR: 0.005000
2025-05-24 15:38:41,152 - main - INFO - Epoch   5 | Train Loss: 0.9431 | Train Acc: 0.2500 | Val Loss: 0.7889 | Val Acc: 0.3000 | Val Balanced Acc: 0.2500 | LR: 0.005000
2025-05-24 15:38:41,815 - main - INFO - Epoch   6 | Train Loss: 1.0214 | Train Acc: 0.2833 | Val Loss: 1.1985 | Val Acc: 0.3000 | Val Balanced Acc: 0.2500 | LR: 0.005000
2025-05-24 15:38:42,415 - main - INFO - Epoch   7 | Train Loss: 1.0667 | Train Acc: 0.2833 | Val Loss: 0.8329 | Val Acc: 0.3000 | Val Balanced Acc: 0.2500 | LR: 0.005000
2025-05-24 15:38:43,042 - main - INFO - Epoch   8 | Train Loss: 1.0173 | Train Acc: 0.2833 | Val Loss: 1.6668 | Val Acc: 0.3000 | Val Balanced Acc: 0.2500 | LR: 0.005000
2025-05-24 15:38:43,681 - main - INFO - Epoch   9 | Train Loss: 1.0795 | Train Acc: 0.3000 | Val Loss: 0.9326 | Val Acc: 0.3000 | Val Balanced Acc: 0.2500 | LR: 0.005000
2025-05-24 15:38:44,311 - main - INFO - Epoch  10 | Train Loss: 0.9617 | Train Acc: 0.3333 | Val Loss: 1.2752 | Val Acc: 0.3000 | Val Balanced Acc: 0.2500 | LR: 0.005000
2025-05-24 15:38:50,372 - main - INFO - Epoch  20 | Train Loss: 0.9588 | Train Acc: 0.3500 | Val Loss: 0.8903 | Val Acc: 0.3000 | Val Balanced Acc: 0.2500 | LR: 0.005000
2025-05-24 15:38:56,557 - main - INFO - Epoch  30 | Train Loss: 0.8635 | Train Acc: 0.3500 | Val Loss: 0.7797 | Val Acc: 0.3000 | Val Balanced Acc: 0.2500 | LR: 0.002500
2025-05-24 15:39:02,359 - main - INFO - Epoch  40 | Train Loss: 0.8414 | Train Acc: 0.3500 | Val Loss: 0.7940 | Val Acc: 0.3000 | Val Balanced Acc: 0.2500 | LR: 0.002500
2025-05-24 15:39:08,488 - main - INFO - Epoch  50 | Train Loss: 0.8251 | Train Acc: 0.3500 | Val Loss: 0.7662 | Val Acc: 0.3000 | Val Balanced Acc: 0.2500 | LR: 0.001250
2025-05-24 15:39:13,978 - main - INFO - Epoch  60 | Train Loss: 0.8339 | Train Acc: 0.3000 | Val Loss: 0.9476 | Val Acc: 0.3000 | Val Balanced Acc: 0.2500 | LR: 0.001250
2025-05-24 15:39:15,603 - main - INFO - 早停触发，停止训练。最佳验证准确率: 0.3500
2025-05-24 15:39:15,604 - main - INFO - 恢复最佳模型，验证准确率: 0.3500
2025-05-24 15:39:15,605 - main - INFO - 🔍 测试最终性能...
2025-05-24 15:39:15,690 - main - INFO - ============================================================
2025-05-24 15:39:15,690 - main - INFO - 📊 最终结果:
2025-05-24 15:39:15,691 - main - INFO - 测试准确率: 0.2500
2025-05-24 15:39:15,691 - main - INFO - 平衡准确率: 0.2500
2025-05-24 15:39:15,691 - main - INFO - 测试损失: 0.8964
2025-05-24 15:39:15,691 - main - INFO - ============================================================
2025-05-24 15:39:15,699 - main - INFO - ✅ 模型和结果已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results\advanced_brain_classifier.pth
2025-05-24 15:39:15,699 - main - INFO - 📁 结果目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results
2025-05-24 15:39:15,700 - __main__ - INFO - ✓ 模型训练完成
2025-05-24 15:39:15,700 - __main__ - INFO - 最终测试准确率: 0.2500
2025-05-24 15:39:15,700 - __main__ - INFO - 操作成功完成
2025-05-24 15:43:34,475 - __main__ - INFO - ============================================================
2025-05-24 15:43:34,475 - __main__ - INFO - 开始数据处理流程
2025-05-24 15:43:34,475 - __main__ - INFO - ============================================================
2025-05-24 15:43:35,605 - scn_phase_space_process - INFO - ============================================================
2025-05-24 15:43:35,605 - scn_phase_space_process - INFO - 3D SCN数据处理流程 - Python版本
2025-05-24 15:43:35,605 - scn_phase_space_process - INFO - 增强版本：支持Excel和MAT格式
2025-05-24 15:43:35,606 - scn_phase_space_process - INFO - ============================================================
2025-05-24 15:43:35,606 - scn_phase_space_process - INFO - 输出目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets
2025-05-24 15:43:35,606 - scn_phase_space_process - INFO - 
步骤1: 智能数据加载
2025-05-24 15:43:35,606 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 15:43:35,607 - scn_phase_space_process - INFO - 正在检测和加载数据文件: datasets/EMtrace01.xlsx
2025-05-24 15:43:35,607 - scn_phase_space_process - INFO - 检测到文件格式: excel
2025-05-24 15:43:35,607 - scn_phase_space_process - INFO - 使用Excel数据处理器加载钙离子数据...
2025-05-24 15:43:35,607 - excel_data_processor - INFO - 正在加载Excel数据文件: datasets\EMtrace01.xlsx
2025-05-24 15:43:36,522 - excel_data_processor - INFO - ✓ 成功加载数据: 2999 个时间点, 43 个神经元
2025-05-24 15:43:36,523 - excel_data_processor - INFO - 神经元列: ['n1', 'n2', 'n3', 'n4', 'n5', 'n6', 'n7', 'n8', 'n9', 'n10']...
2025-05-24 15:43:36,523 - excel_data_processor - INFO - 开始预处理钙离子数据...
2025-05-24 15:43:36,528 - excel_data_processor - WARNING - 检测并处理了 247 个异常值
2025-05-24 15:43:36,528 - excel_data_processor - INFO - 执行Z-score标准化...
2025-05-24 15:43:36,533 - excel_data_processor - INFO - ✓ 数据预处理完成: (2999, 43) -> (2999, 43)
2025-05-24 15:43:36,533 - excel_data_processor - INFO - 转换数据为SCN处理格式...
2025-05-24 15:43:36,534 - excel_data_processor - INFO - 分段参数: 段长度=340, 步长=170
2025-05-24 15:43:36,534 - excel_data_processor - INFO - ✓ 转换完成: 10 个神经元, 平均每个神经元 10.0 个时间段
2025-05-24 15:43:36,536 - scn_phase_space_process - INFO - 数据加载信息:
2025-05-24 15:43:36,536 - scn_phase_space_process - INFO -   文件路径: datasets\EMtrace01.xlsx
2025-05-24 15:43:36,536 - scn_phase_space_process - INFO -   时间点数量: 2999
2025-05-24 15:43:36,536 - scn_phase_space_process - INFO -   神经元数量: 43
2025-05-24 15:43:36,538 - scn_phase_space_process - INFO -   数据形状: (2999, 43)
2025-05-24 15:43:36,538 - scn_phase_space_process - INFO -   时间戳范围: 1 - 2999
2025-05-24 15:43:36,538 - scn_phase_space_process - INFO -   神经元ID: ['n1', 'n2', 'n3', 'n4', 'n5', '...']
2025-05-24 15:43:36,538 - scn_phase_space_process - INFO -   缺失值数量: 0
2025-05-24 15:43:36,538 - scn_phase_space_process - INFO -   数据范围: -1.358 - 4.895
2025-05-24 15:43:36,538 - scn_phase_space_process - INFO -   数据均值: -0.000
2025-05-24 15:43:36,538 - scn_phase_space_process - INFO -   数据标准差: 0.578
2025-05-24 15:43:36,539 - scn_phase_space_process - INFO -   数据格式: Excel
2025-05-24 15:43:36,539 - scn_phase_space_process - INFO -   处理器: ExcelCalciumDataProcessor
2025-05-24 15:43:36,540 - scn_phase_space_process - INFO - 
步骤2: 相空间重构
2025-05-24 15:43:36,540 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 15:43:36,540 - scn_phase_space_process - INFO - 数据维度: 10 个细胞, 10 个时间线
2025-05-24 15:43:36,540 - scn_phase_space_process - INFO - 开始处理钙信号数据...
2025-05-24 15:43:41,155 - scn_phase_space_process - INFO - ✓ 相空间重构完成
2025-05-24 15:43:41,155 - scn_phase_space_process - INFO - 
步骤3: 数据裁剪
2025-05-24 15:43:41,155 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 15:43:41,156 - scn_phase_space_process - INFO - 开始裁剪数据到统一长度: 170
2025-05-24 15:43:41,156 - scn_phase_space_process - INFO - ✓ 数据裁剪完成
2025-05-24 15:43:41,156 - scn_phase_space_process - INFO - 
步骤4: 构建图数据集
2025-05-24 15:43:41,156 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 15:43:41,157 - scn_phase_space_process - INFO - 有效样本数量: 100
2025-05-24 15:43:41,157 - scn_phase_space_process - INFO - 生成 nodes.csv 文件...
2025-05-24 15:43:41,157 - scn_phase_space_process - INFO - 转换节点特征格式...
2025-05-24 15:43:41,232 - scn_phase_space_process - INFO - ✓ nodes.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\nodes.csv
2025-05-24 15:43:41,232 - scn_phase_space_process - INFO - 生成 edges.csv 文件...
2025-05-24 15:43:41,243 - scn_phase_space_process - INFO - ✓ edges.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\edges.csv
2025-05-24 15:43:41,243 - scn_phase_space_process - INFO - 生成 graphs.csv 文件...
2025-05-24 15:43:41,243 - scn_phase_space_process - INFO - 使用内置的改进标签生成方法...
2025-05-24 15:43:41,443 - scn_phase_space_process - INFO - 使用内置的改进标签生成方法...
2025-05-24 15:43:41,443 - scn_phase_space_process - INFO - 处理 100 个有效样本
2025-05-24 15:43:41,496 - scn_phase_space_process - INFO - 特征矩阵形状: (100, 14)
2025-05-24 15:43:41,498 - scn_phase_space_process - INFO - PCA降维: 14 -> 8
2025-05-24 15:43:42,404 - scn_phase_space_process - INFO - 聚类质量 - 轮廓系数: 0.261
2025-05-24 15:43:42,405 - scn_phase_space_process - INFO - 改进标签分布: {np.int32(0): np.int64(28), np.int32(1): np.int64(34), np.int32(2): np.int64(38)}
2025-05-24 15:43:42,405 - scn_phase_space_process - INFO - 最终标签分布: {np.int32(0): np.int64(28), np.int32(1): np.int64(34), np.int32(2): np.int64(38)}
2025-05-24 15:43:42,407 - scn_phase_space_process - INFO - ✓ graphs.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\graphs.csv
2025-05-24 15:43:42,408 - scn_phase_space_process - INFO - 
============================================================
2025-05-24 15:43:42,408 - scn_phase_space_process - INFO - 数据处理流程全部完成!
2025-05-24 15:43:42,408 - scn_phase_space_process - INFO - ============================================================
2025-05-24 15:43:42,409 - scn_phase_space_process - INFO - 数据源信息:
2025-05-24 15:43:42,409 - scn_phase_space_process - INFO -   - 文件: datasets/EMtrace01.xlsx
2025-05-24 15:43:42,409 - scn_phase_space_process - INFO -   - 格式: Excel
2025-05-24 15:43:42,410 - scn_phase_space_process - INFO -   - 处理器: ExcelCalciumDataProcessor
2025-05-24 15:43:42,410 - scn_phase_space_process - INFO - 
生成的文件:
2025-05-24 15:43:42,411 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/nodes.csv
2025-05-24 15:43:42,411 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/edges.csv
2025-05-24 15:43:42,411 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/graphs.csv
2025-05-24 15:43:42,411 - scn_phase_space_process - INFO - 
处理结果:
2025-05-24 15:43:42,412 - scn_phase_space_process - INFO -   - 总样本数量: 100
2025-05-24 15:43:42,412 - scn_phase_space_process - INFO -   - 轨迹长度: 170
2025-05-24 15:43:42,413 - scn_phase_space_process - INFO -   - 嵌入维度: 3
2025-05-24 15:43:42,413 - scn_phase_space_process - INFO - 
下一步操作:
2025-05-24 15:43:42,413 - scn_phase_space_process - INFO -   1. 检查生成的CSV文件质量
2025-05-24 15:43:42,414 - scn_phase_space_process - INFO -   2. 运行训练: python main.py 或 python run.py --train
2025-05-24 15:43:42,414 - scn_phase_space_process - INFO -   3. 查看训练结果: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results
2025-05-24 15:43:42,414 - __main__ - INFO - ✓ 数据处理完成
2025-05-24 15:43:42,415 - __main__ - INFO - 操作成功完成
2025-05-24 15:44:07,835 - __main__ - INFO - ============================================================
2025-05-24 15:44:07,836 - __main__ - INFO - 开始模型训练流程
2025-05-24 15:44:07,836 - __main__ - INFO - ============================================================
2025-05-24 15:44:12,024 - main - INFO - ================================================================================
2025-05-24 15:44:12,024 - main - INFO - 🧠 脑网络状态分类器 - 先进版本
2025-05-24 15:44:12,024 - main - INFO - ================================================================================
2025-05-24 15:44:12,025 - main - INFO - 使用设备: cuda
2025-05-24 15:44:12,025 - main - INFO - 📊 加载数据集...
2025-05-24 15:44:12,077 - main - INFO - 数据集加载完成 - 训练集: 60, 验证集: 20, 测试集: 20
2025-05-24 15:44:12,077 - main - INFO - 🏗️  创建先进模型...
2025-05-24 15:44:12,118 - main - INFO - 创建改进模型，参数总数: 790339
2025-05-24 15:44:12,118 - main - INFO - 使用MultiLayerGCN + 先进训练技术的组合
2025-05-24 15:44:12,205 - main - INFO - ✓ 早停机制已启用 - 耐心值: 50, 最小改进: 0.001
2025-05-24 15:44:12,205 - main - INFO - 🚀 开始训练...
2025-05-24 15:44:12,205 - main - INFO - 🚀 开始先进训练流程...
2025-05-24 15:44:13,033 - main - INFO - Epoch   0 | Train Loss: 1.6694 | Train Acc: 0.2667 | Val Loss: 0.5087 | Val Acc: 0.3500 | Val Balanced Acc: 0.3333 | LR: 0.005000
2025-05-24 15:44:13,593 - main - INFO - Epoch   1 | Train Loss: 0.8562 | Train Acc: 0.2500 | Val Loss: 0.5333 | Val Acc: 0.3500 | Val Balanced Acc: 0.3333 | LR: 0.005000
2025-05-24 15:44:14,208 - main - INFO - Epoch   2 | Train Loss: 1.0730 | Train Acc: 0.4833 | Val Loss: 1.8376 | Val Acc: 0.3000 | Val Balanced Acc: 0.3333 | LR: 0.005000
2025-05-24 15:44:14,800 - main - INFO - Epoch   3 | Train Loss: 1.0817 | Train Acc: 0.4000 | Val Loss: 1.1522 | Val Acc: 0.3500 | Val Balanced Acc: 0.3333 | LR: 0.005000
2025-05-24 15:44:15,360 - main - INFO - Epoch   4 | Train Loss: 1.0139 | Train Acc: 0.1833 | Val Loss: 0.5108 | Val Acc: 0.3000 | Val Balanced Acc: 0.3333 | LR: 0.005000
2025-05-24 15:44:15,913 - main - INFO - Epoch   5 | Train Loss: 0.9734 | Train Acc: 0.3333 | Val Loss: 0.5775 | Val Acc: 0.3000 | Val Balanced Acc: 0.3333 | LR: 0.005000
2025-05-24 15:44:16,488 - main - INFO - Epoch   6 | Train Loss: 0.7404 | Train Acc: 0.2167 | Val Loss: 0.5921 | Val Acc: 0.3500 | Val Balanced Acc: 0.3333 | LR: 0.005000
2025-05-24 15:44:17,058 - main - INFO - Epoch   7 | Train Loss: 0.6823 | Train Acc: 0.3667 | Val Loss: 0.5230 | Val Acc: 0.3500 | Val Balanced Acc: 0.3333 | LR: 0.005000
2025-05-24 15:44:17,643 - main - INFO - Epoch   8 | Train Loss: 0.6615 | Train Acc: 0.3333 | Val Loss: 1.1150 | Val Acc: 0.3500 | Val Balanced Acc: 0.3333 | LR: 0.005000
2025-05-24 15:44:18,182 - main - INFO - Epoch   9 | Train Loss: 0.7140 | Train Acc: 0.3167 | Val Loss: 0.7367 | Val Acc: 0.3500 | Val Balanced Acc: 0.3333 | LR: 0.005000
2025-05-24 15:44:18,762 - main - INFO - Epoch  10 | Train Loss: 0.6474 | Train Acc: 0.3000 | Val Loss: 0.6293 | Val Acc: 0.3500 | Val Balanced Acc: 0.3333 | LR: 0.005000
2025-05-24 15:44:24,090 - main - INFO - Epoch  20 | Train Loss: 0.5223 | Train Acc: 0.3500 | Val Loss: 0.5676 | Val Acc: 0.3500 | Val Balanced Acc: 0.3333 | LR: 0.002500
2025-05-24 15:44:29,787 - main - INFO - Epoch  30 | Train Loss: 0.5627 | Train Acc: 0.3833 | Val Loss: 0.5707 | Val Acc: 0.3500 | Val Balanced Acc: 0.3333 | LR: 0.002500
2025-05-24 15:44:35,713 - main - INFO - Epoch  40 | Train Loss: 0.5690 | Train Acc: 0.3667 | Val Loss: 0.5324 | Val Acc: 0.3500 | Val Balanced Acc: 0.3333 | LR: 0.001250
2025-05-24 15:44:41,175 - main - INFO - Epoch  50 | Train Loss: 0.4473 | Train Acc: 0.4333 | Val Loss: 0.8765 | Val Acc: 0.3500 | Val Balanced Acc: 0.3333 | LR: 0.001250
2025-05-24 15:44:46,768 - main - INFO - Epoch  60 | Train Loss: 0.5236 | Train Acc: 0.5333 | Val Loss: 0.9869 | Val Acc: 0.4500 | Val Balanced Acc: 0.4365 | LR: 0.001250
2025-05-24 15:44:52,288 - main - INFO - Epoch  70 | Train Loss: 0.4645 | Train Acc: 0.6000 | Val Loss: 1.2540 | Val Acc: 0.4000 | Val Balanced Acc: 0.3968 | LR: 0.000625
2025-05-24 15:44:57,735 - main - INFO - Epoch  80 | Train Loss: 0.2898 | Train Acc: 0.7167 | Val Loss: 1.7440 | Val Acc: 0.3500 | Val Balanced Acc: 0.3333 | LR: 0.000313
2025-05-24 15:45:03,095 - main - INFO - Epoch  90 | Train Loss: 0.3011 | Train Acc: 0.6833 | Val Loss: 2.0290 | Val Acc: 0.3500 | Val Balanced Acc: 0.3333 | LR: 0.000313
2025-05-24 15:45:06,805 - main - INFO - 早停触发，停止训练。最佳验证准确率: 0.5500
2025-05-24 15:45:06,806 - main - INFO - 恢复最佳模型，验证准确率: 0.5500
2025-05-24 15:45:06,806 - main - INFO - 🔍 测试最终性能...
2025-05-24 15:45:06,900 - main - INFO - ============================================================
2025-05-24 15:45:06,900 - main - INFO - 📊 最终结果:
2025-05-24 15:45:06,900 - main - INFO - 测试准确率: 0.2500
2025-05-24 15:45:06,900 - main - INFO - 平衡准确率: 0.2833
2025-05-24 15:45:06,900 - main - INFO - 测试损失: 1.7429
2025-05-24 15:45:06,900 - main - INFO - ============================================================
2025-05-24 15:45:06,909 - main - INFO - ✅ 模型和结果已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results\advanced_brain_classifier.pth
2025-05-24 15:45:06,909 - main - INFO - 📁 结果目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results
2025-05-24 15:45:06,909 - __main__ - INFO - ✓ 模型训练完成
2025-05-24 15:45:06,909 - __main__ - INFO - 最终测试准确率: 0.2500
2025-05-24 15:45:06,910 - __main__ - INFO - 操作成功完成
2025-05-24 15:51:05,119 - __main__ - INFO - ============================================================
2025-05-24 15:51:05,120 - __main__ - INFO - 开始数据处理流程
2025-05-24 15:51:05,120 - __main__ - INFO - ============================================================
2025-05-24 15:51:06,142 - scn_phase_space_process - INFO - ============================================================
2025-05-24 15:51:06,143 - scn_phase_space_process - INFO - 3D SCN数据处理流程 - Python版本
2025-05-24 15:51:06,143 - scn_phase_space_process - INFO - 增强版本：支持Excel和MAT格式
2025-05-24 15:51:06,143 - scn_phase_space_process - INFO - ============================================================
2025-05-24 15:51:06,144 - scn_phase_space_process - INFO - 输出目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets
2025-05-24 15:51:06,144 - scn_phase_space_process - INFO - 
步骤1: 智能数据加载
2025-05-24 15:51:06,144 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 15:51:06,145 - scn_phase_space_process - INFO - 正在检测和加载数据文件: datasets/EMtrace01.xlsx
2025-05-24 15:51:06,145 - scn_phase_space_process - INFO - 检测到文件格式: excel
2025-05-24 15:51:06,145 - scn_phase_space_process - INFO - 使用Excel数据处理器加载钙离子数据...
2025-05-24 15:51:06,146 - excel_data_processor - INFO - 正在加载Excel数据文件: datasets\EMtrace01.xlsx
2025-05-24 15:51:07,109 - excel_data_processor - INFO - ✓ 成功加载数据: 2999 个时间点, 43 个神经元
2025-05-24 15:51:07,109 - excel_data_processor - INFO - 神经元列: ['n1', 'n2', 'n3', 'n4', 'n5', 'n6', 'n7', 'n8', 'n9', 'n10']...
2025-05-24 15:51:07,109 - excel_data_processor - INFO - 开始预处理钙离子数据...
2025-05-24 15:51:07,116 - excel_data_processor - WARNING - 检测并处理了 247 个异常值
2025-05-24 15:51:07,116 - excel_data_processor - INFO - 执行Z-score标准化...
2025-05-24 15:51:07,119 - excel_data_processor - INFO - ✓ 数据预处理完成: (2999, 43) -> (2999, 43)
2025-05-24 15:51:07,119 - excel_data_processor - INFO - 转换数据为SCN处理格式...
2025-05-24 15:51:07,119 - excel_data_processor - INFO - 分段参数: 段长度=340, 步长=170
2025-05-24 15:51:07,120 - excel_data_processor - INFO - ✓ 转换完成: 10 个神经元, 平均每个神经元 10.0 个时间段
2025-05-24 15:51:07,122 - scn_phase_space_process - INFO - 数据加载信息:
2025-05-24 15:51:07,122 - scn_phase_space_process - INFO -   文件路径: datasets\EMtrace01.xlsx
2025-05-24 15:51:07,122 - scn_phase_space_process - INFO -   时间点数量: 2999
2025-05-24 15:51:07,122 - scn_phase_space_process - INFO -   神经元数量: 43
2025-05-24 15:51:07,122 - scn_phase_space_process - INFO -   数据形状: (2999, 43)
2025-05-24 15:51:07,123 - scn_phase_space_process - INFO -   时间戳范围: 1 - 2999
2025-05-24 15:51:07,124 - scn_phase_space_process - INFO -   神经元ID: ['n1', 'n2', 'n3', 'n4', 'n5', '...']
2025-05-24 15:51:07,124 - scn_phase_space_process - INFO -   缺失值数量: 0
2025-05-24 15:51:07,124 - scn_phase_space_process - INFO -   数据范围: -1.358 - 4.895
2025-05-24 15:51:07,124 - scn_phase_space_process - INFO -   数据均值: -0.000
2025-05-24 15:51:07,125 - scn_phase_space_process - INFO -   数据标准差: 0.578
2025-05-24 15:51:07,125 - scn_phase_space_process - INFO -   数据格式: Excel
2025-05-24 15:51:07,125 - scn_phase_space_process - INFO -   处理器: ExcelCalciumDataProcessor
2025-05-24 15:51:07,125 - scn_phase_space_process - INFO - 
步骤2: 相空间重构
2025-05-24 15:51:07,125 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 15:51:07,126 - scn_phase_space_process - INFO - 数据维度: 10 个细胞, 10 个时间线
2025-05-24 15:51:07,126 - scn_phase_space_process - INFO - 开始处理钙信号数据...
2025-05-24 15:51:11,754 - scn_phase_space_process - INFO - ✓ 相空间重构完成
2025-05-24 15:51:11,755 - scn_phase_space_process - INFO - 
步骤3: 数据裁剪
2025-05-24 15:51:11,755 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 15:51:11,755 - scn_phase_space_process - INFO - 开始裁剪数据到统一长度: 170
2025-05-24 15:51:11,755 - scn_phase_space_process - INFO - ✓ 数据裁剪完成
2025-05-24 15:51:11,756 - scn_phase_space_process - INFO - 
步骤4: 构建图数据集
2025-05-24 15:51:11,756 - scn_phase_space_process - INFO - ------------------------------
2025-05-24 15:51:11,756 - scn_phase_space_process - INFO - 有效样本数量: 100
2025-05-24 15:51:11,756 - scn_phase_space_process - INFO - 生成 nodes.csv 文件...
2025-05-24 15:51:11,757 - scn_phase_space_process - INFO - 转换节点特征格式...
2025-05-24 15:51:11,831 - scn_phase_space_process - INFO - ✓ nodes.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\nodes.csv
2025-05-24 15:51:11,832 - scn_phase_space_process - INFO - 生成 edges.csv 文件...
2025-05-24 15:51:11,844 - scn_phase_space_process - INFO - ✓ edges.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\edges.csv
2025-05-24 15:51:11,844 - scn_phase_space_process - INFO - 生成 graphs.csv 文件...
2025-05-24 15:51:11,845 - scn_phase_space_process - INFO - 使用内置的改进标签生成方法...
2025-05-24 15:51:12,046 - scn_phase_space_process - INFO - 使用内置的改进标签生成方法...
2025-05-24 15:51:12,047 - scn_phase_space_process - INFO - 处理 100 个有效样本
2025-05-24 15:51:12,097 - scn_phase_space_process - INFO - 特征矩阵形状: (100, 14)
2025-05-24 15:51:12,099 - scn_phase_space_process - INFO - PCA降维: 14 -> 8
2025-05-24 15:51:12,265 - scn_phase_space_process - INFO - 聚类质量 - 轮廓系数: 0.261
2025-05-24 15:51:12,265 - scn_phase_space_process - INFO - 改进标签分布: {np.int32(0): np.int64(28), np.int32(1): np.int64(34), np.int32(2): np.int64(38)}
2025-05-24 15:51:12,265 - scn_phase_space_process - INFO - 最终标签分布: {np.int32(0): np.int64(28), np.int32(1): np.int64(34), np.int32(2): np.int64(38)}
2025-05-24 15:51:12,267 - scn_phase_space_process - INFO - ✓ graphs.csv 已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets\graphs.csv
2025-05-24 15:51:12,268 - scn_phase_space_process - INFO - 
============================================================
2025-05-24 15:51:12,268 - scn_phase_space_process - INFO - 数据处理流程全部完成!
2025-05-24 15:51:12,269 - scn_phase_space_process - INFO - ============================================================
2025-05-24 15:51:12,269 - scn_phase_space_process - INFO - 数据源信息:
2025-05-24 15:51:12,270 - scn_phase_space_process - INFO -   - 文件: datasets/EMtrace01.xlsx
2025-05-24 15:51:12,270 - scn_phase_space_process - INFO -   - 格式: Excel
2025-05-24 15:51:12,270 - scn_phase_space_process - INFO -   - 处理器: ExcelCalciumDataProcessor
2025-05-24 15:51:12,271 - scn_phase_space_process - INFO - 
生成的文件:
2025-05-24 15:51:12,271 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/nodes.csv
2025-05-24 15:51:12,271 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/edges.csv
2025-05-24 15:51:12,272 - scn_phase_space_process - INFO -   - D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\datasets/graphs.csv
2025-05-24 15:51:12,272 - scn_phase_space_process - INFO - 
处理结果:
2025-05-24 15:51:12,272 - scn_phase_space_process - INFO -   - 总样本数量: 100
2025-05-24 15:51:12,272 - scn_phase_space_process - INFO -   - 轨迹长度: 170
2025-05-24 15:51:12,273 - scn_phase_space_process - INFO -   - 嵌入维度: 3
2025-05-24 15:51:12,273 - scn_phase_space_process - INFO - 
下一步操作:
2025-05-24 15:51:12,274 - scn_phase_space_process - INFO -   1. 检查生成的CSV文件质量
2025-05-24 15:51:12,274 - scn_phase_space_process - INFO -   2. 运行训练: python main.py 或 python run.py --train
2025-05-24 15:51:12,274 - scn_phase_space_process - INFO -   3. 查看训练结果: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results
2025-05-24 15:51:12,275 - __main__ - INFO - ✓ 数据处理完成
2025-05-24 15:51:12,275 - __main__ - INFO - 操作成功完成
2025-05-24 15:51:22,872 - __main__ - INFO - ============================================================
2025-05-24 15:51:22,872 - __main__ - INFO - 开始模型训练流程
2025-05-24 15:51:22,872 - __main__ - INFO - ============================================================
2025-05-24 15:51:27,486 - main - INFO - ================================================================================
2025-05-24 15:51:27,487 - main - INFO - 🧠 脑网络状态分类器 - 先进版本
2025-05-24 15:51:27,487 - main - INFO - ================================================================================
2025-05-24 15:51:27,487 - main - INFO - 使用设备: cuda
2025-05-24 15:51:27,487 - main - INFO - 📊 加载数据集...
2025-05-24 15:51:27,546 - main - INFO - 数据集加载完成 - 训练集: 60, 验证集: 20, 测试集: 20
2025-05-24 15:51:27,546 - main - INFO - 🏗️  创建先进模型...
2025-05-24 15:51:27,581 - main - INFO - 创建高度正则化轻量级模型，参数总数: 195
2025-05-24 15:51:27,582 - main - INFO - 使用RegularizedLightweightGCN + 先进正则化技术
2025-05-24 15:51:27,694 - main - INFO - ✓ 早停机制已启用 - 耐心值: 25, 最小改进: 0.005
2025-05-24 15:51:27,694 - main - INFO - 🚀 开始训练...
2025-05-24 15:51:27,694 - main - INFO - 🚀 开始先进训练流程...
2025-05-24 15:51:28,391 - main - INFO - Epoch   0 | Train Loss: 0.6539 | Train Acc: 0.2333 | Val Loss: 0.4944 | Val Acc: 0.3500 | Val Balanced Acc: 0.3333 | LR: 0.001000
2025-05-24 15:51:28,725 - main - INFO - Epoch   1 | Train Loss: 0.5811 | Train Acc: 0.3333 | Val Loss: 0.4848 | Val Acc: 0.4000 | Val Balanced Acc: 0.3889 | LR: 0.001000
2025-05-24 15:51:29,043 - main - INFO - Epoch   2 | Train Loss: 0.5065 | Train Acc: 0.2833 | Val Loss: 0.4799 | Val Acc: 0.5500 | Val Balanced Acc: 0.5635 | LR: 0.001000
2025-05-24 15:51:29,374 - main - INFO - Epoch   3 | Train Loss: 0.5120 | Train Acc: 0.3000 | Val Loss: 0.4823 | Val Acc: 0.6000 | Val Balanced Acc: 0.6190 | LR: 0.001000
2025-05-24 15:51:29,702 - main - INFO - Epoch   4 | Train Loss: 0.5310 | Train Acc: 0.1833 | Val Loss: 0.4866 | Val Acc: 0.3000 | Val Balanced Acc: 0.3333 | LR: 0.001000
2025-05-24 15:51:30,049 - main - INFO - Epoch   5 | Train Loss: 0.4933 | Train Acc: 0.3500 | Val Loss: 0.4910 | Val Acc: 0.4000 | Val Balanced Acc: 0.4286 | LR: 0.001000
2025-05-24 15:51:30,537 - main - INFO - Epoch   6 | Train Loss: 0.4813 | Train Acc: 0.3667 | Val Loss: 0.4926 | Val Acc: 0.4000 | Val Balanced Acc: 0.4286 | LR: 0.001000
2025-05-24 15:51:30,885 - main - INFO - Epoch   7 | Train Loss: 0.4710 | Train Acc: 0.4667 | Val Loss: 0.4927 | Val Acc: 0.5500 | Val Balanced Acc: 0.5714 | LR: 0.001000
2025-05-24 15:51:31,225 - main - INFO - Epoch   8 | Train Loss: 0.4684 | Train Acc: 0.4167 | Val Loss: 0.4935 | Val Acc: 0.4000 | Val Balanced Acc: 0.4286 | LR: 0.001000
2025-05-24 15:51:31,576 - main - INFO - Epoch   9 | Train Loss: 0.4622 | Train Acc: 0.4167 | Val Loss: 0.4920 | Val Acc: 0.5500 | Val Balanced Acc: 0.5714 | LR: 0.001000
2025-05-24 15:51:31,901 - main - INFO - Epoch  10 | Train Loss: 0.4697 | Train Acc: 0.4833 | Val Loss: 0.4936 | Val Acc: 0.4000 | Val Balanced Acc: 0.4286 | LR: 0.001000
2025-05-24 15:51:35,128 - main - INFO - Epoch  20 | Train Loss: 0.4860 | Train Acc: 0.4667 | Val Loss: 0.4903 | Val Acc: 0.4000 | Val Balanced Acc: 0.3889 | LR: 0.000500
2025-05-24 15:51:37,051 - main - INFO - 早停触发，停止训练。最佳验证准确率: 0.6000
2025-05-24 15:51:37,052 - main - INFO - 恢复最佳模型，验证准确率: 0.6000
2025-05-24 15:51:37,052 - main - INFO - 🔍 测试最终性能...
2025-05-24 15:51:37,104 - main - INFO - ============================================================
2025-05-24 15:51:37,105 - main - INFO - 📊 最终结果:
2025-05-24 15:51:37,105 - main - INFO - 测试准确率: 0.3000
2025-05-24 15:51:37,105 - main - INFO - 平衡准确率: 0.2500
2025-05-24 15:51:37,105 - main - INFO - 测试损失: 0.4810
2025-05-24 15:51:37,106 - main - INFO - ============================================================
2025-05-24 15:51:37,109 - main - INFO - ✅ 模型和结果已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results\advanced_brain_classifier.pth
2025-05-24 15:51:37,109 - main - INFO - 📁 结果目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results
2025-05-24 15:51:37,110 - __main__ - INFO - ✓ 模型训练完成
2025-05-24 15:51:37,110 - __main__ - INFO - 最终测试准确率: 0.3000
2025-05-24 15:51:37,110 - __main__ - INFO - 操作成功完成
2025-05-24 15:53:07,602 - __main__ - INFO - ============================================================
2025-05-24 15:53:07,602 - __main__ - INFO - 开始模型训练流程
2025-05-24 15:53:07,602 - __main__ - INFO - ============================================================
2025-05-24 15:53:11,994 - main - INFO - ================================================================================
2025-05-24 15:53:11,994 - main - INFO - 🧠 脑网络状态分类器 - 先进版本
2025-05-24 15:53:11,995 - main - INFO - ================================================================================
2025-05-24 15:53:11,995 - main - INFO - 使用设备: cuda
2025-05-24 15:53:11,995 - main - INFO - 📊 加载数据集...
2025-05-24 15:53:12,050 - main - INFO - 数据集加载完成 - 训练集: 60, 验证集: 20, 测试集: 20
2025-05-24 15:53:12,050 - main - INFO - 🏗️  创建先进模型...
2025-05-24 15:53:12,086 - main - INFO - 创建高度正则化轻量级模型，参数总数: 195
2025-05-24 15:53:12,086 - main - INFO - 使用RegularizedLightweightGCN + 先进正则化技术
2025-05-24 15:53:12,155 - main - INFO - ✓ 早停机制已禁用
2025-05-24 15:53:12,155 - main - INFO - 🚀 开始训练...
2025-05-24 15:53:12,155 - main - INFO - 🚀 开始先进训练流程...
2025-05-24 15:53:12,888 - main - INFO - Epoch   0 | Train Loss: 0.5553 | Train Acc: 0.2833 | Val Loss: 0.4868 | Val Acc: 0.3500 | Val Balanced Acc: 0.3333 | LR: 0.001000
2025-05-24 15:53:13,251 - main - INFO - Epoch   1 | Train Loss: 0.5441 | Train Acc: 0.2667 | Val Loss: 0.4829 | Val Acc: 0.4000 | Val Balanced Acc: 0.3810 | LR: 0.001000
2025-05-24 15:53:13,607 - main - INFO - Epoch   2 | Train Loss: 0.4837 | Train Acc: 0.3167 | Val Loss: 0.4832 | Val Acc: 0.3500 | Val Balanced Acc: 0.3333 | LR: 0.001000
2025-05-24 15:53:13,959 - main - INFO - Epoch   3 | Train Loss: 0.4823 | Train Acc: 0.3833 | Val Loss: 0.4795 | Val Acc: 0.3500 | Val Balanced Acc: 0.3333 | LR: 0.001000
2025-05-24 15:53:14,302 - main - INFO - Epoch   4 | Train Loss: 0.4690 | Train Acc: 0.4333 | Val Loss: 0.4789 | Val Acc: 0.3500 | Val Balanced Acc: 0.3333 | LR: 0.001000
2025-05-24 15:53:14,662 - main - INFO - Epoch   5 | Train Loss: 0.4925 | Train Acc: 0.4167 | Val Loss: 0.4827 | Val Acc: 0.3500 | Val Balanced Acc: 0.3333 | LR: 0.001000
2025-05-24 15:53:15,033 - main - INFO - Epoch   6 | Train Loss: 0.4706 | Train Acc: 0.4333 | Val Loss: 0.4831 | Val Acc: 0.3500 | Val Balanced Acc: 0.3333 | LR: 0.001000
2025-05-24 15:53:15,382 - main - INFO - Epoch   7 | Train Loss: 0.5052 | Train Acc: 0.3667 | Val Loss: 0.4862 | Val Acc: 0.3500 | Val Balanced Acc: 0.3333 | LR: 0.001000
2025-05-24 15:53:15,794 - main - INFO - Epoch   8 | Train Loss: 0.4573 | Train Acc: 0.4500 | Val Loss: 0.4842 | Val Acc: 0.3500 | Val Balanced Acc: 0.3333 | LR: 0.001000
2025-05-24 15:53:16,231 - main - INFO - Epoch   9 | Train Loss: 0.5009 | Train Acc: 0.3833 | Val Loss: 0.4887 | Val Acc: 0.3500 | Val Balanced Acc: 0.3333 | LR: 0.001000
2025-05-24 15:53:16,721 - main - INFO - Epoch  10 | Train Loss: 0.5083 | Train Acc: 0.4000 | Val Loss: 0.4889 | Val Acc: 0.3500 | Val Balanced Acc: 0.3333 | LR: 0.001000
2025-05-24 15:53:20,948 - main - INFO - Epoch  20 | Train Loss: 0.4782 | Train Acc: 0.4500 | Val Loss: 0.4917 | Val Acc: 0.4500 | Val Balanced Acc: 0.4444 | LR: 0.000500
2025-05-24 15:53:25,086 - main - INFO - Epoch  30 | Train Loss: 0.4200 | Train Acc: 0.5333 | Val Loss: 0.4846 | Val Acc: 0.4500 | Val Balanced Acc: 0.4524 | LR: 0.000500
2025-05-24 15:53:29,583 - main - INFO - Epoch  40 | Train Loss: 0.4177 | Train Acc: 0.5500 | Val Loss: 0.4718 | Val Acc: 0.5000 | Val Balanced Acc: 0.5079 | LR: 0.000500
2025-05-24 15:53:33,844 - main - INFO - Epoch  50 | Train Loss: 0.4790 | Train Acc: 0.4667 | Val Loss: 0.4495 | Val Acc: 0.6000 | Val Balanced Acc: 0.6190 | LR: 0.000500
2025-05-24 15:53:38,321 - main - INFO - Epoch  60 | Train Loss: 0.4115 | Train Acc: 0.5667 | Val Loss: 0.4257 | Val Acc: 0.6000 | Val Balanced Acc: 0.6190 | LR: 0.000500
2025-05-24 15:53:42,963 - main - INFO - Epoch  70 | Train Loss: 0.3467 | Train Acc: 0.6167 | Val Loss: 0.4263 | Val Acc: 0.6000 | Val Balanced Acc: 0.6190 | LR: 0.000500
2025-05-24 15:53:46,983 - main - INFO - Epoch  80 | Train Loss: 0.4530 | Train Acc: 0.5500 | Val Loss: 0.4058 | Val Acc: 0.6000 | Val Balanced Acc: 0.6190 | LR: 0.000500
2025-05-24 15:53:50,589 - main - INFO - Epoch  90 | Train Loss: 0.4263 | Train Acc: 0.5667 | Val Loss: 0.4003 | Val Acc: 0.6000 | Val Balanced Acc: 0.6190 | LR: 0.000500
2025-05-24 15:53:54,372 - main - INFO - Epoch 100 | Train Loss: 0.4887 | Train Acc: 0.5833 | Val Loss: 0.3963 | Val Acc: 0.6000 | Val Balanced Acc: 0.6190 | LR: 0.000500
2025-05-24 15:53:57,591 - main - INFO - Epoch 110 | Train Loss: 0.5492 | Train Acc: 0.5667 | Val Loss: 0.3948 | Val Acc: 0.6000 | Val Balanced Acc: 0.6190 | LR: 0.000500
2025-05-24 15:54:00,483 - main - INFO - Epoch 120 | Train Loss: 0.4089 | Train Acc: 0.6000 | Val Loss: 0.3838 | Val Acc: 0.5500 | Val Balanced Acc: 0.5635 | LR: 0.000500
2025-05-24 15:54:03,718 - main - INFO - Epoch 130 | Train Loss: 0.4557 | Train Acc: 0.5833 | Val Loss: 0.3821 | Val Acc: 0.5000 | Val Balanced Acc: 0.5079 | LR: 0.000500
2025-05-24 15:54:06,831 - main - INFO - Epoch 140 | Train Loss: 0.5902 | Train Acc: 0.4333 | Val Loss: 0.3812 | Val Acc: 0.5000 | Val Balanced Acc: 0.5079 | LR: 0.000500
2025-05-24 15:54:09,916 - main - INFO - Epoch 150 | Train Loss: 0.3976 | Train Acc: 0.5333 | Val Loss: 0.3709 | Val Acc: 0.5000 | Val Balanced Acc: 0.5079 | LR: 0.000500
2025-05-24 15:54:13,104 - main - INFO - Epoch 160 | Train Loss: 0.5173 | Train Acc: 0.6333 | Val Loss: 0.4951 | Val Acc: 0.6000 | Val Balanced Acc: 0.6190 | LR: 0.000500
2025-05-24 15:54:16,154 - main - INFO - Epoch 170 | Train Loss: 0.5722 | Train Acc: 0.6167 | Val Loss: 0.3819 | Val Acc: 0.4500 | Val Balanced Acc: 0.4524 | LR: 0.000250
2025-05-24 15:54:19,212 - main - INFO - Epoch 180 | Train Loss: 0.4477 | Train Acc: 0.5333 | Val Loss: 0.4972 | Val Acc: 0.6000 | Val Balanced Acc: 0.6190 | LR: 0.000250
2025-05-24 15:54:22,254 - main - INFO - Epoch 190 | Train Loss: 0.4435 | Train Acc: 0.5500 | Val Loss: 0.4118 | Val Acc: 0.3500 | Val Balanced Acc: 0.3651 | LR: 0.000125
2025-05-24 15:54:25,044 - main - INFO - 恢复最佳模型，验证准确率: 0.6000
2025-05-24 15:54:25,044 - main - INFO - 🔍 测试最终性能...
2025-05-24 15:54:25,091 - main - INFO - ============================================================
2025-05-24 15:54:25,091 - main - INFO - 📊 最终结果:
2025-05-24 15:54:25,091 - main - INFO - 测试准确率: 0.4500
2025-05-24 15:54:25,091 - main - INFO - 平衡准确率: 0.4238
2025-05-24 15:54:25,091 - main - INFO - 测试损失: 0.3259
2025-05-24 15:54:25,092 - main - INFO - ============================================================
2025-05-24 15:54:25,094 - main - INFO - ✅ 模型和结果已保存到: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results\advanced_brain_classifier.pth
2025-05-24 15:54:25,094 - main - INFO - 📁 结果目录: D:\GitHub_local\Brain_Neuroimage_Processing\StateClassifier\results
2025-05-24 15:54:25,095 - __main__ - INFO - ✓ 模型训练完成
2025-05-24 15:54:25,095 - __main__ - INFO - 最终测试准确率: 0.4500
2025-05-24 15:54:25,095 - __main__ - INFO - 操作成功完成
